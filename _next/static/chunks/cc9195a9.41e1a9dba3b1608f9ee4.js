(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[6],{EZz0:function(t,e,n){var r;r=function(t,e){return(()=>{var n={757:(t,e,n)=>{t.exports=n(666)},211:(t,e,n)=>{"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e),n.d(e,{CodePoint:()=>fe,Data:()=>Rt,DataEvent:()=>Lt,DataEventCompiler:()=>re,DataEventProducer:()=>pe,DataEventType:()=>It,DataPath:()=>xt,ListenableUnidocProducer:()=>Wt,RxJSUnidocInput:()=>Ai,StaticUnidocProducer:()=>Yt,TrackedUnidocEventProducer:()=>lr,TrackedUnidocTokenProducer:()=>qo,UnidocAnyPredicate:()=>p,UnidocAnythingPredicate:()=>v,UnidocBlueprint:()=>ut,UnidocBlueprintType:()=>D,UnidocBlueprintVisitor:()=>yt,UnidocBuffer:()=>kt,UnidocBufferOrigin:()=>be,UnidocBufferizer:()=>St,UnidocDisjunctionBlueprint:()=>M,UnidocEndBlueprint:()=>G,UnidocEvent:()=>Ke,UnidocEventBlueprint:()=>B,UnidocEventProducer:()=>sr,UnidocEventType:()=>S,UnidocFragmentResolver:()=>eo,UnidocGroupBlueprint:()=>K,UnidocImportation:()=>Vi,UnidocImportationFilter:()=>_o,UnidocImportationProducer:()=>lo,UnidocImportationResolver:()=>Bi,UnidocKissValidator:()=>yu,UnidocKissValidatorOutput:()=>za,UnidocKissValidatorOutputBuilder:()=>vu,UnidocKissValidatorOutputType:()=>Wa,UnidocKissValidatorResolver:()=>ku,UnidocLenientSequenceBlueprint:()=>$,UnidocLexer:()=>jr,UnidocLexerState:()=>Or,UnidocLocation:()=>we,UnidocLocationTracker:()=>tr,UnidocLocationTrackerState:()=>Zn,UnidocManyBlueprint:()=>Q,UnidocMatchPredicate:()=>b,UnidocNetworkOrigin:()=>Ee,UnidocNullReader:()=>xi,UnidocNullResolver:()=>Co,UnidocOnlyPredicate:()=>c,UnidocOrigin:()=>Pe,UnidocOriginElement:()=>Re,UnidocOriginElementType:()=>he,UnidocParser:()=>ei,UnidocParserState:()=>Gr,UnidocPath:()=>di,UnidocPathElement:()=>ai,UnidocPathElementType:()=>Jr,UnidocPredicate:()=>P,UnidocProducerEvent:()=>pt,UnidocRangeOrigin:()=>Me,UnidocRangeOriginBuilder:()=>Ue,UnidocReducer:()=>Xn,UnidocReductionExecutor:()=>sn,UnidocReductionInput:()=>$e,UnidocReductionInputProducer:()=>dn,UnidocReductionInputType:()=>Ve,UnidocReductionRequest:()=>Ze,UnidocRegexpBlueprint:()=>nt,UnidocResource:()=>Yi,UnidocResourceOrigin:()=>_e,UnidocRuntimeOrigin:()=>ke,UnidocSequenceBlueprint:()=>q,UnidocSetBlueprint:()=>ot,UnidocStream:()=>Bo,UnidocStringReader:()=>Ni,UnidocSymbol:()=>Oi,UnidocSymbolBuffer:()=>pr,UnidocSymbolReader:()=>Mi,UnidocTagBlueprint:()=>ct,UnidocTextOrigin:()=>Ne,UnidocToken:()=>Er,UnidocTokenBuffer:()=>ra,UnidocTokenProducer:()=>Ir,UnidocTokenType:()=>hr,UnidocValidationEvent:()=>ha,UnidocValidationEventBuilder:()=>ya,UnidocValidationEventProducer:()=>Ta,UnidocValidationEventType:()=>un,UnidocValidationMessage:()=>la,UnidocValidationMessageBuilder:()=>Oa,UnidocValidationMessageType:()=>na,UnidocValidationToReductionTranslator:()=>kn,UnidocValidator:()=>$u,bufferize:()=>At,fullyParse:()=>fs,parse:()=>hs,tokenize:()=>ps,validate:()=>ls});var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"select",value:function(t){return t.tag}},{key:"toString",value:function(){return"tag name"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&r(e.prototype,n),i&&r(e,i),t}();function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(i||(i={}));var a,u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"select",value:function(t){return t.text}},{key:"toString",value:function(){return"content"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&o(e.prototype,n),r&&o(e,r),t}();function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(u||(u={})),function(t){t.tagName=function(){return i.INSTANCE},t.content=function(){return u.INSTANCE}}(a||(a={}));var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return t===this.value}},{key:"toString",value:function(){return"only("+this.value+")"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.value===this.value)}}])&&s(e.prototype,n),r&&s(e,r),t}();function l(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._values=new Set;var n,r=l(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this._values.add(i)}}catch(o){r.e(o)}finally{r.f()}}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return this._values.has(t)}},{key:"toString",value:function(){var t="$any(",e=this._values.values(),n=e.next();for(n.done||(t+=n.value);!(n=e.next()).done;)t+=", ",t+=n.value;return t+=")"}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e._values.size!==this._values.size)return!1;var n,r=l(this._values);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!e._values.has(i))return!1}}catch(o){r.e(o)}finally{r.f()}return!0}return!1}}])&&h(e.prototype,n),r&&h(e,r),t}();function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return!0}},{key:"toString",value:function(){return"$anything"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&y(e.prototype,n),r&&y(e,r),t}();function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t}(v||(v={}));var b=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.regexp=e}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return this.regexp.test(t)}},{key:"toString",value:function(){return"$match("+this.regexp.toString()+")"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.regexp===this.regexp)}}])&&d(e.prototype,n),r&&d(e,r),t}();function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var E=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.selector=e,this.predicate=n}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return this.predicate.test(this.selector.select(t))}},{key:"toString",value:function(){return this.selector.toString()+" is "+this.predicate.toString()}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.selector.equals(e.selector)&&this.predicate.equals(e.predicate))}}])&&m(e.prototype,n),r&&m(e,r),t}();function g(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){if(t){if("string"===typeof t)return T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(t,e):void 0}}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var S,A=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.predicates=g(e)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){var e,n=function(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=_(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}(this.predicates);try{for(n.s();!(e=n.n()).done;)if(!e.value.test(t))return!1}catch(r){n.e(r)}finally{n.f()}return!0}},{key:"toString",value:function(){if(0===this.predicates.length)return"true";var t="(",e=this.predicates.values(),n=e.next();for(n.done||(t+=n.value.toString());!(n=e.next()).done;)t+=" and ",t+=n.value.toString();return t+=")"}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.predicates.length!==this.predicates.length)return!1;for(var n=0;n<this.predicates.length;++n)if(!e.predicates[n].equals(this.predicates[n]))return!1;return!0}return!1}}])&&k(e.prototype,n),r&&k(e,r),t}();function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(e){switch(e){case t.START_TAG:return"START_TAG";case t.END_TAG:return"END_TAG";case t.WHITESPACE:return"WHITESPACE";case t.WORD:return"WORD";default:return}}t.TAG=0,t.WHITESPACE=4,t.WORD=6,t.START=0,t.END=1,t.DEFAULT_TYPE=0,t.START_TAG=t.START|t.TAG,t.END_TAG=t.END|t.TAG,t.ALL=[t.START_TAG,t.END_TAG,t.WHITESPACE,t.WORD],t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(S||(S={}));var O=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return t.type===S.START_TAG}},{key:"toString",value:function(){return"is start of tag"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&w(e.prototype,n),r&&w(e,r),t}();function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(O||(O={}));var R=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return t.type===S.END_TAG}},{key:"toString",value:function(){return"is end of tag"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&I(e.prototype,n),r&&I(e,r),t}();function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(R||(R={}));var C=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return t.type===S.WORD}},{key:"toString",value:function(){return"is word"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&N(e.prototype,n),r&&N(e,r),t}();function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(C||(C={}));var P,L=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return t.type===S.WHITESPACE}},{key:"toString",value:function(){return"is whitespace"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&x(e.prototype,n),r&&x(e,r),t}();!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(L||(L={})),function(t){t.is=function(t,e){return new E(t,e)},t.isWhitespace=function(){return L.create()},t.isWord=function(){return C.create()},t.isTagStart=function(){return O.create()},t.isTagEnd=function(){return R.create()},t.and=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new A(e)},t.only=function(t){return new c(t)},t.any=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new p(e)},t.anything=function(){return v.INSTANCE},t.match=function(t){return new b(t)}}(P||(P={}));var D,U=n(332);function j(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(e){switch(e){case t.EVENT:return"EVENT";case t.MANY:return"MANY";case t.DISJUNCTION:return"DISJUNCTION";case t.SET:return"SET";case t.SEQUENCE:return"SEQUENCE";case t.LENIENT_SEQUENCE:return"LENIENT_SEQUENCE";case t.END:return"END";case t.TAG:return"TAG";case t.GROUP:return"GROUP";case t.REGEXP:return"REGEXP";default:return}}t.EVENT=1,t.MANY=2,t.DISJUNCTION=3,t.SET=4,t.SEQUENCE=5,t.LENIENT_SEQUENCE=6,t.END=7,t.TAG=8,t.GROUP=9,t.REGEXP=10,t.DEFAULT=t.EVENT,t.ALL=[t.EVENT,t.MANY,t.DISJUNCTION,t.SET,t.SEQUENCE,t.LENIENT_SEQUENCE,t.END,t.TAG,t.GROUP,t.REGEXP],t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(D||(D={}));var M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;j(this,t),this.type=D.DISJUNCTION,this.operands=U.Pack.any(e)}var e,n,r;return e=t,(n=[{key:"or",value:function(t){return this.operands.push(t),this}},{key:"clear",value:function(){this.operands.clear()}},{key:"copy",value:function(t){this.operands.copy(t.operands)}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.operands.size!==this.operands.size)return!1;var r=n||new Set;if(!r.has(this)){r.add(this);for(var i=0;i<this.operands.size;++i)if(!this.operands.get(i).equals(e.operands.get(i),r))return!1}return!0}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"> @"+n.get(this);n.set(this,n.size.toString());var r="+ ";if(r+=n.get(this),r+=": ",r+=this.constructor.name,t>0||0===this.operands.size)for(var i=0;i<this.operands.size;++i)r+="\r\n\t",r+=this.operands.get(i).toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t");else r+="\r\n\t...";return r+="\r\n",r+="- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&W(e.prototype,n),r&&W(e,r),t}();function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(M||(M={}));var G=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.END}var e,n,r;return e=t,(n=[{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}},{key:"toString",value:function(){return"| "+this.constructor.name}}])&&F(e.prototype,n),r&&F(e,r),t}();function z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(G||(G={}));var B=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.EVENT,this.predicate=P.anything()}var e,n,r;return e=t,(n=[{key:"thatMatch",value:function(t){return this.predicate=t,this}},{key:"copy",value:function(t){this.predicate=t.predicate}},{key:"clear",value:function(){this.predicate=P.anything()}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.predicate.equals(e.predicate))}},{key:"toString",value:function(){return"| "+this.constructor.name+" "+this.predicate.toString()}}])&&z(e.prototype,n),r&&z(e,r),t}();function H(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(B||(B={}));var q=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;H(this,t),this.type=D.SEQUENCE,this.operands=U.Pack.any(e)}var e,n,r;return e=t,(n=[{key:"then",value:function(t){return this.operands.push(t),this}},{key:"copy",value:function(t){this.operands.copy(t.operands)}},{key:"clear",value:function(){this.operands.clear()}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.operands.size!==this.operands.size)return!1;var r=n||new Set;if(!r.has(this)){r.add(this);for(var i=0;i<this.operands.size;++i)if(!this.operands.get(i).equals(e.operands.get(i),r))return!1}return!0}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";if(r+=n.get(this),r+=": ",r+=this.constructor.name,t>0||0===this.operands.size)for(var i=0;i<this.operands.size;++i)r+="\r\n\t",r+=this.operands.get(i).toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t");else r+="\r\n\t...";return r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&V(e.prototype,n),r&&V(e,r),t}();function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.EMPTY_SEQUENCE=new t(0),t.empty=function(){return t.EMPTY_SEQUENCE},t.create=function(){return new t}}(q||(q={}));var K=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.GROUP,this.group=0,this.operand=q.empty()}var e,n,r;return e=t,(n=[{key:"of",value:function(t){return this.operand=t,this}},{key:"as",value:function(t){return this.group=t,this}},{key:"copy",value:function(t){this.group=t.group,this.operand=t.operand}},{key:"clear",value:function(){this.group=0,this.operand=q.empty()}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(this.group!==e.group)return!1;var r=n||new Set;return!(!r.has(this)&&(r.add(this),!this.operand.equals(e.operand,r)))}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";return r+=n.get(this),r+=": ",r+=this.constructor.name,r+=" as ",r+=this.group,t>0?(r+="\r\n\t",r+=this.operand.toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t")):r+="\r\n\t...",r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&Y(e.prototype,n),r&&Y(e,r),t}();function X(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(K||(K={}));var $=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;X(this,t),this.type=D.LENIENT_SEQUENCE,this.operands=U.Pack.any(e)}var e,n,r;return e=t,(n=[{key:"then",value:function(t){return this.operands.push(t),this}},{key:"clear",value:function(){this.operands.clear()}},{key:"copy",value:function(t){this.operands.copy(t.operands)}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.operands.size!==this.operands.size)return!1;var r=n||new Set;if(!r.has(this)){r.add(this);for(var i=0;i<this.operands.size;++i)if(!this.operands.get(i).equals(e.operands.get(i),r))return!1}return!0}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";if(r+=n.get(this),r+=": ",r+=this.constructor.name,t>0||0===this.operands.size)for(var i=0;i<this.operands.size;++i)r+="\r\n\t",r+=this.operands.get(i).toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t");else r+="\r\n\t...";return r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&Z(e.prototype,n),r&&Z(e,r),t}();function J(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}($||($={}));var Q=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.MANY,this.minimum=0,this.maximum=Number.POSITIVE_INFINITY,this.operand=q.empty()}var e,n,r;return e=t,(n=[{key:"between",value:function(t,e){return this.minimum=t,this.maximum=e,this}},{key:"optional",value:function(){return this.minimum=0,this.maximum=1,this}},{key:"atLeast",value:function(t){return this.minimum=t,this}},{key:"upTo",value:function(t){return this.maximum=t,this}},{key:"of",value:function(t){return this.operand=t,this}},{key:"copy",value:function(t){this.minimum=t.minimum,this.maximum=t.maximum,this.operand=t.operand}},{key:"clear",value:function(){this.minimum=0,this.maximum=Number.POSITIVE_INFINITY,this.operand=q.empty()}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(this.minimum!==e.minimum||this.maximum!==e.maximum)return!1;var r=n||new Set;return!(!r.has(this)&&(r.add(this),!this.operand.equals(e.operand,r)))}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";return r+=n.get(this),r+=": ",r+=this.constructor.name,r+=" between ",r+=this.minimum,r+=" and ",r+=this.maximum,t>0?(r+="\r\n\t",r+=this.operand.toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t")):r+="\r\n\t...",r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&J(e.prototype,n),r&&J(e,r),t}();function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(Q||(Q={}));var et=/.*/,nt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.REGEXP,this.regexp=et}var e,n,r;return e=t,(n=[{key:"thatMatch",value:function(t){return this.regexp=t,this}},{key:"copy",value:function(t){this.regexp=t.regexp}},{key:"clear",value:function(){this.regexp=et}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.regexp===e.regexp)}},{key:"toString",value:function(){return"| "+this.constructor.name+" "+this.regexp.toString()}}])&&tt(e.prototype,n),r&&tt(e,r),t}();function rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(nt||(nt={}));var ot=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;rt(this,t),this.type=D.SET,this.operands=U.Pack.any(e)}var e,n,r;return e=t,(n=[{key:"with",value:function(t){return this.operands.push(t),this}},{key:"copy",value:function(t){this.operands.copy(t.operands)}},{key:"clear",value:function(){this.operands.clear()}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.operands.size!==this.operands.size)return!1;var r=n||new Set;if(!r.has(this)){r.add(this);for(var i=0;i<this.operands.size;++i)if(!this.operands.get(i).equals(e.operands.get(i),r))return!1}return!0}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";if(r+=n.get(this),r+=": ",r+=this.constructor.name,t>0||0===this.operands.size)for(var i=0;i<this.operands.size;++i)r+="\r\n\t",r+=this.operands.get(i).toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t");else r+="\r\n\t...";return r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&it(e.prototype,n),r&&it(e,r),t}();function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(ot||(ot={}));var ut,st,ct=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.TAG,this.predicate=P.anything(),this.operand=q.empty()}var e,n,r;return e=t,(n=[{key:"thatMatch",value:function(t){return this.predicate=t,this}},{key:"withContent",value:function(t){return this.operand=t,this}},{key:"copy",value:function(t){this.predicate=t.predicate,this.operand=t.operand}},{key:"clear",value:function(){this.predicate=P.anything(),this.operand=q.empty()}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(!e.predicate.equals(e.predicate))return!1;var r=n||new Set;return!(!r.has(this)&&(r.add(this),this.operand.equals(e.operand,r)))}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";return r+=n.get(this),r+=": ",r+=this.constructor.name,r+=" ",r+=this.predicate.toString(),t>0?(r+="\r\n\t",r+=this.operand.toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t")):r+="\r\n\t...",r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&at(e.prototype,n),r&&at(e,r),t}();function lt(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return ft(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ft(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(ct||(ct={})),function(t){function e(t){var e=B.create();return t&&e.thatMatch(t),e}function n(){for(var t=q.create(),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(n){var i,o=lt(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.then(a)}}catch(u){o.e(u)}finally{o.f()}}return t}t.disjunction=function(){for(var t=M.create(),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(n){var i,o=lt(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.or(a)}}catch(u){o.e(u)}finally{o.f()}}return t},t.end=G.create,t.event=e,t.many=function(t){var e=Q.create();return t&&e.of(t),e},t.group=function(t,e){var n=K.create();return n.as(t),e&&n.of(e),n},t.optional=function(t){var e=Q.create();return e.optional(),t&&e.of(t),e},t.sequence=n,function(t){t.lenient=function(){for(var t=$.create(),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(n){var i,o=lt(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.then(a)}}catch(u){o.e(u)}finally{o.f()}}return t}}(n=t.sequence||(t.sequence={})),t.set=function(){for(var t=ot.create(),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(n){var i,o=lt(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.with(a)}}catch(u){o.e(u)}finally{o.f()}}return t},t.tag=ct.create,t.tagStart=function(t){return e(P.and(P.isTagStart(),P.is(a.tagName(),"string"===typeof t?P.only(t):t)))},t.tagEnd=function(t){return e(P.and(P.isTagEnd(),P.is(a.tagName(),"string"===typeof t?P.only(t):t)))};var r=e(P.isWord()),i=e(P.isWhitespace()),o=t.many(i);function u(e){return t.sequence(o,e,o)}t.word=function(){return r},t.whitespace=function(){return i},t.whitespaces=function(){return o},t.whitespaced=u,function(e){function n(){for(var e=q.create(),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(r){var a,u=lt(r);try{for(u.s();!(a=u.n()).done;){var s=a.value;e.then(t.sequence(o,s))}}catch(c){u.e(c)}finally{u.f()}}return e}e.head=function(e){return t.sequence(o,e)},e.tail=function(e){return t.sequence(e,o)},e.disjunction=function(){for(var e=M.create(),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(r){var a,u=lt(r);try{for(u.s();!(a=u.n()).done;){var s=a.value;e.or(s)}}catch(c){u.e(c)}finally{u.f()}}return t.sequence(o,e)},e.many=function(e){var n=Q.create();return e&&n.of(t.sequence(o,e)),n},e.optional=function(e){var n=Q.create();return n.optional(),e&&n.of(t.sequence(o,e)),n},e.sequence=n,function(e){e.lenient=function(){for(var e=$.create(),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(r){var a,u=lt(r);try{for(u.s();!(a=u.n()).done;){var s=a.value;e.then(t.sequence(o,s))}}catch(c){u.e(c)}finally{u.f()}}return e}}(n=e.sequence||(e.sequence={})),e.set=function(){for(var e=ot.create(),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(r){var a,u=lt(r);try{for(u.s();!(a=u.n()).done;){var s=a.value;e.with(t.sequence(o,s))}}catch(c){u.e(c)}finally{u.f()}}return e}}(u=t.whitespaced||(t.whitespaced={})),t.regexp=function(t){return nt.create().thatMatch(t)}}(ut||(ut={})),function(t){t.UNVISITED=0,t.VISITING=1,t.VISITED=2,t.ALL=[t.UNVISITED,t.VISITING,t.VISITED],t.toString=function(e){switch(e){case t.UNVISITED:return"UNVISITED";case t.VISITING:return"VISITING";case t.VISITED:return"VISITED";default:return}}}(st||(st={}));var pt,yt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._states=new Map}var e,n,r;return e=t,(n=[{key:"visiting",value:function(t){this._states.set(t,st.VISITING)}},{key:"visited",value:function(t){this._states.set(t,st.VISITED)}},{key:"state",value:function(t){return this._states.get(t)||st.UNVISITED}},{key:"isVisiting",value:function(t){return this._states.get(t)===st.VISITING}},{key:"wasVisited",value:function(t){return this._states.get(t)===st.VISITED}},{key:"isUnvisited",value:function(t){return null==this._states.get(t)||this._states.get(t)===st.UNVISITED}},{key:"clear",value:function(){this._states.clear()}}])&&ht(e.prototype,n),r&&ht(e,r),t}();function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.State=st,t.create=function(){return new t}}(yt||(yt={})),function(t){t.INITIALIZATION=0,t.PRODUCTION=1,t.COMPLETION=2,t.FAILURE=3,t.ALL=[t.INITIALIZATION,t.PRODUCTION,t.COMPLETION,t.FAILURE],t.toString=function(e){switch(e){case t.INITIALIZATION:return"INITIALIZATION";case t.PRODUCTION:return"PRODUCTION";case t.COMPLETION:return"COMPLETION";case t.FAILURE:return"FAILURE";default:return}}}(pt||(pt={}));var dt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handleInitialization=this.handleInitialization.bind(this),this.handleProduction=this.handleProduction.bind(this),this.handleCompletion=this.handleCompletion.bind(this),this.handleFailure=this.handleFailure.bind(this)}var e,n,r;return e=t,(n=[{key:"subscribe",value:function(t){return t.addEventListener(pt.INITIALIZATION,this.handleInitialization),t.addEventListener(pt.PRODUCTION,this.handleProduction),t.addEventListener(pt.COMPLETION,this.handleCompletion),t.addEventListener(pt.FAILURE,this.handleFailure),t}},{key:"unsubscribe",value:function(t){t.removeEventListener(pt.INITIALIZATION,this.handleInitialization),t.removeEventListener(pt.PRODUCTION,this.handleProduction),t.removeEventListener(pt.COMPLETION,this.handleCompletion),t.removeEventListener(pt.FAILURE,this.handleFailure)}}])&&vt(e.prototype,n),r&&vt(e,r),t}();function bt(t){return(bt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Et(t,e){return(Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Tt(t);if(e){var i=Tt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _t(this,n)}}function _t(t,e){return!e||"object"!==bt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tt(t){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kt,St=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Et(t,e)}(o,t);var e,n,r,i=gt(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).buffer=t,e}return e=o,(n=[{key:"handleInitialization",value:function(){this.buffer.clear()}},{key:"handleProduction",value:function(t){this.buffer.push(t)}},{key:"handleCompletion",value:function(){this.buffer.fit()}},{key:"handleFailure",value:function(t){console.error(t)}}])&&mt(e.prototype,n),r&&mt(e,r),o}(dt);function At(t,e){var n;return(n=new St(null==e?U.Pack.any(32):kt.create(e,32))).subscribe(t),n.buffer}function wt(t){return(wt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(t){for(var e="[",n=0;n<t.size;++n){var r=t.get(n);e+=n>0?",":"",e+="\r\n\t",null==r||null==r.toString?e+=JSON.stringify(r):e+=r.toString()}return e+=t.size>0?"\r\n":"",e+="]"}function n(t){return null==t||null==t.toString?JSON.stringify(t):t.toString()}t.bufferize=At,t.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;return U.Pack.instance(t,e)},t.toString=e,t.stringify=n,t.expect=function(t,r){if(null==t||null==r){if(r===t)throw new Error("Received different values, received "+n(t)+" but expected "+n(r)+".")}else if(t!=r){if(t.size!==r.size)throw new Error("Received a buffer of size "+t.size+" instead of a buffer of size "+r.size+", received "+e(t)+" but expected "+e(r)+".");for(var i=0,o=r.size;i<o;++i){var a=t.get(i),u=r.get(i);if(null==a||null==u||null==u.equals){if(a!==u)throw new Error("Difference between buffers at index "+i+" : "+n(a)+" != "+n(u)+", received "+e(t)+" but expected "+e(r)+".")}else if(!a.equals(u))throw new Error("Difference between buffers at index "+i+" : "+n(a)+" != "+n(u)+", received "+e(t)+" but expected "+e(r)+".")}}}}(kt||(kt={}));var It,Rt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=void 0}var e,n,r;return e=t,(n=[{key:"isMap",value:function(){return t.isMap(this.value)}},{key:"isArray",value:function(){return t.isArray(this.value)}},{key:"isObject",value:function(){return t.isObject(this.value)}},{key:"isPrimitive",value:function(){return t.isPrimitive(this.value)}},{key:"move",value:function(e){this.value=t.move(this.value,e)}},{key:"follow",value:function(e){this.value=t.follow(this.value,e)}},{key:"set",value:function(e,n){t.set(this.value,e,n)}},{key:"setIn",value:function(e,n){t.setIn(this.value,e,n)}},{key:"push",value:function(e){t.push(this.value,e)}},{key:"pushIn",value:function(e,n){t.pushIn(this.value,e,n)}}])&&Ot(e.prototype,n),r&&Ot(e,r),t}();function Nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(t,e){if(null==t||"object"!==wt(t))throw null==t?new Error("Illegal call to move, a data object can't move throughout a null or undefined value."):new Error("Illegal call to move, a data object can't move throughout a primitive value.");if(t instanceof Array){if("number"===typeof t)return t[e];throw new Error("Illegal call to move, a data object can't move throughout an array by using a string key.")}return t instanceof Map?t.get(e):t[e]}function n(t,e,n){if(null==t||"object"!==wt(t))throw null==t?new Error("Illegal call to set, a data object can't assign a field to a null or undefined value."):new Error("Illegal call to set, a data object can't assign a field to a primitive value.");if(t instanceof Array){if("number"!==typeof e)throw new Error("Illegal call to set, a data object can't assign a string field to an array.");t[e]=n}else t instanceof Map?t.set(e,n):t[e]=n}function r(t,e){if(null==t||"object"!==wt(t))throw null==t?new Error("Illegal call to push, a data object can't push into a null or undefined value."):new Error("Illegal call to push, a data object can't push into a primitive value.");if(!(t instanceof Array))throw new Error("Illegal call to push, a data object can't push into an object or a map.");t.push(e)}t.isMap=function(t){return null!=t&&"object"===wt(t)&&t instanceof Map},t.isArray=function(t){return null!=t&&"object"===wt(t)&&t instanceof Array},t.isObject=function(t){return null!=t&&"object"===wt(t)&&!(t instanceof Array)},t.isPrimitive=function(t){return null==t&&"object"!==wt(t)},t.move=e,t.follow=function(t,n){for(var r=n.elements,i=t,o=0,a=r.size;o<a;++o)i=e(i,r.get(o));return i},t.set=n,t.setIn=function(t,r,i){for(var o=r.elements,a=t,u=0,s=o.size-1;u<s;++u)a=e(a,o.get(u));n(a,o.last,i)},t.push=r,t.pushIn=function(t,n,i){for(var o=n.elements,a=t,u=0,s=o.size;u<s;++u)a=e(a,o.get(u));r(a,i)}}(Rt||(Rt={})),function(t){function e(e){switch(e){case t.MOVE:return"MOVE";case t.BACK:return"BACK";case t.OBJECT:return"OBJECT";case t.ARRAY:return"ARRAY";case t.MAP:return"MAP";case t.SWAP:return"SWAP";case t.SET:return"SET";case t.PUSH:return"PUSH";case t.PUBLISH:return"PUBLISH";default:return}}t.MOVE=0,t.BACK=1,t.OBJECT=2,t.ARRAY=3,t.MAP=4,t.SWAP=5,t.SET=6,t.PUSH=7,t.PUBLISH=8,t.DEFAULT=t.MOVE,t.ALL=[t.MOVE,t.BACK,t.OBJECT,t.ARRAY,t.MAP,t.SWAP,t.SET,t.PUSH,t.PUBLISH],t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(It||(It={}));var xt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;Nt(this,t),this._elements=U.Pack.any(e),this.elements=this._elements.view()}var e,n,r;return e=t,(n=[{key:"reallocate",value:function(t){this._elements.reallocate(t)}},{key:"fit",value:function(){this._elements.fit()}},{key:"push",value:function(t){this._elements.push(t)}},{key:"pop",value:function(){return this._elements.pop()}},{key:"concat",value:function(t){this._elements.concat(t._elements)}},{key:"copy",value:function(t){this._elements.copy(t._elements)}},{key:"clear",value:function(){this._elements.clear()}},{key:"clone",value:function(){var e=new t(this._elements.capacity);return e.copy(this),e}},{key:"toString",value:function(){if(this._elements.size>0){var t=".",e=this._elements.get(0);"string"===typeof e?t+=e:(t+="[",t+=e,t+="]");for(var n=1;n<this._elements.size;++n){var r=this._elements.get(1);"string"===typeof r?(t+=".",t+=r):(t+="[",t+=r,t+="]")}return t}return"."}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e._elements.equals(this._elements))}},{key:Symbol.iterator,value:function(){return this._elements[Symbol.iterator]()}},{key:"size",get:function(){return this._elements.size}},{key:"capacity",get:function(){return this._elements.capacity}}])&&Ct(e.prototype,n),r&&Ct(e,r),t}();function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.copy=function(t){return null==t?t:t.clone()}}(xt||(xt={}));var Lt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=0,this.type=It.DEFAULT,this.value=void 0,this.path=new xt(8)}var e,n,r;return e=t,(n=[{key:"publish",value:function(){this.type=It.PUBLISH,this.value=void 0,this.path.clear()}},{key:"object",value:function(){this.type=It.OBJECT,this.value=void 0,this.path.clear()}},{key:"array",value:function(){this.type=It.ARRAY,this.value=void 0,this.path.clear()}},{key:"map",value:function(){this.type=It.MAP,this.value=void 0,this.path.clear()}},{key:"swap",value:function(t){this.type=It.SWAP,this.value=t,this.path.clear()}},{key:"move",value:function(){this.type=It.MOVE,this.value=void 0,this.path.clear();for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];this.path.push(o)}}},{key:"back",value:function(){this.type=It.BACK,this.value=void 0,this.path.clear()}},{key:"set",value:function(){var t;this.type=It.SET,this.value=(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t],this.path.clear();for(var e=0,n=arguments.length-1;e<n;++e)this.path.push(e<0||arguments.length<=e?void 0:arguments[e])}},{key:"push",value:function(){var t;this.type=It.PUSH,this.value=(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t],this.path.clear();for(var e=0,n=arguments.length-1;e<n;++e)this.path.push(e<0||arguments.length<=e?void 0:arguments[e])}},{key:"clear",value:function(){this.index=0,this.type=It.DEFAULT,this.value=void 0}},{key:"copy",value:function(t){this.index=t.index,this.type=t.type,this.value=t.value}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"toString",value:function(){var t="#"+this.index;switch(this.type){case It.MOVE:return t+" move "+this.path.toString();case It.BACK:return t+" back";case It.OBJECT:return t+" object";case It.ARRAY:return t+" array";case It.MAP:return t+" map";case It.SWAP:return t+" swap to "+this.value;case It.SET:return t+" set "+this.path.toString()+" "+this.value;case It.PUSH:return t+" push "+this.path.toString()+" "+this.value;default:throw new Error("Unable to map a data event of type "+It.toDebugString(this.type)+" to a string because no procedure was defined for that.")}}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.index===this.index&&e.type===this.type&&e.value===this.value)}}])&&Pt(e.prototype,n),r&&Pt(e,r),t}();function Dt(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Ut(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ut(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.copy=function(t){return null==t?t:t.clone()},t.create=e,t.ALLOCATOR=U.Allocator.fromFactory(e)}(Lt||(Lt={}));var Wt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._completionListeners=new Set,this._productionListeners=new Set,this._initializationListeners=new Set,this._failureListeners=new Set}var e,n,r;return e=t,(n=[{key:"initialize",value:function(){var t,e=Dt(this._initializationListeners);try{for(e.s();!(t=e.n()).done;)(0,t.value)()}catch(n){e.e(n)}finally{e.f()}}},{key:"fail",value:function(t){var e,n=Dt(this._failureListeners);try{for(n.s();!(e=n.n()).done;)(0,e.value)(t)}catch(r){n.e(r)}finally{n.f()}}},{key:"produce",value:function(t){var e,n=Dt(this._productionListeners);try{for(n.s();!(e=n.n()).done;)(0,e.value)(t)}catch(r){n.e(r)}finally{n.f()}}},{key:"complete",value:function(){var t,e=Dt(this._completionListeners);try{for(e.s();!(t=e.n()).done;)(0,t.value)()}catch(n){e.e(n)}finally{e.f()}}},{key:"addEventListener",value:function(t,e){switch(t){case pt.COMPLETION:return void this._completionListeners.add(e);case pt.PRODUCTION:return void this._productionListeners.add(e);case pt.FAILURE:return void this._failureListeners.add(e);case pt.INITIALIZATION:return void this._initializationListeners.add(e);default:throw new Error("Unable to register the given listener for event type #"+t+' "'+pt.toString(t)+'" because the given event type does not exists or is not supported.')}}},{key:"removeEventListener",value:function(t,e){switch(t){case pt.COMPLETION:return void this._completionListeners.delete(e);case pt.PRODUCTION:return void this._productionListeners.delete(e);case pt.FAILURE:return void this._failureListeners.delete(e);case pt.INITIALIZATION:return void this._initializationListeners.delete(e);default:throw new Error("Unable to remove the given listener for event type #"+t+' "'+pt.toString(t)+'" because the given event type does not exists or is not supported.')}}},{key:"removeAllEventListener",value:function(t){if(null==t)this._completionListeners.clear(),this._productionListeners.clear(),this._initializationListeners.clear(),this._failureListeners.clear();else switch(t){case pt.COMPLETION:return void this._completionListeners.clear();case pt.PRODUCTION:return void this._productionListeners.clear();case pt.FAILURE:return void this._failureListeners.clear();case pt.INITIALIZATION:return void this._initializationListeners.clear();default:throw new Error("Unable to remove all event listener of event type #"+t+' "'+pt.toString(t)+'" because the given event type does not exists or is not supported.')}}}])&&jt(e.prototype,n),r&&jt(e,r),t}();function Mt(t){return(Mt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zt(t,e,n){return(zt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ht(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=qt(t);if(e){var i=qt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Vt(this,n)}}function Vt(t,e){return!e||"object"!==Mt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Yt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bt(t,e)}(o,t);var e,n,r,i=Ht(o);function o(){return Ft(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"initialize",value:function(){zt(qt(o.prototype),"initialize",this).call(this)}},{key:"fail",value:function(t){zt(qt(o.prototype),"fail",this).call(this,t)}},{key:"produce",value:function(t){zt(qt(o.prototype),"produce",this).call(this,t)}},{key:"complete",value:function(){zt(qt(o.prototype),"complete",this).call(this)}}])&&Gt(e.prototype,n),r&&Gt(e,r),o}(Wt);function Kt(t){return(Kt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xt(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Zt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zt(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qt(t,e){return(Qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function te(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ne(t);if(e){var i=ne(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ee(this,n)}}function ee(t,e){return!e||"object"!==Kt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ne(t){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var re=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qt(t,e)}(o,t);var e,n,r,i=te(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;return $t(this,o),(t=i.call(this))._stack=U.Pack.any(e),t._path=new xt(e),t._output=new Yt,t}return e=o,(n=[{key:"handleInitialization",value:function(){this._output.initialize(),this._stack.push(void 0)}},{key:"handleProduction",value:function(t){switch(t.type){case It.MOVE:this.move(t.path);break;case It.BACK:this.back();break;case It.OBJECT:this.object();break;case It.ARRAY:this.array();break;case It.MAP:this.map();break;case It.SWAP:this.swap(t.value);break;case It.SET:this.set(t.path,t.value);break;case It.PUSH:this.push(t.path,t.value);break;case It.PUBLISH:this.publish();break;default:throw new Error("Unable to handle production of event of type "+It.toDebugString(t.type)+" because no procedure was defined for that.")}}},{key:"move",value:function(t){var e,n=this._stack.last,r=Xt(t.elements);try{for(r.s();!(e=r.n()).done;){var i=e.value;n=Rt.move(n,i),this._stack.push(n),this._path.push(i)}}catch(o){r.e(o)}finally{r.f()}}},{key:"back",value:function(){if(!(this._path.size>0))throw new Error("Unable to move back from the root of the declaration.");this._stack.pop(),this._path.pop()}},{key:"object",value:function(){var t=this._stack.last;if(null!=t){if("object"===Kt(t)){if(t instanceof Array)throw new Error("Unable to define the current value as an object as the current value is an array.");if(t instanceof Map)throw new Error("Unable to define the current value as an object as the current value is a map.");return}throw new Error("Unable to define the current value as an object as the current value is a primitive value.")}this._stack.set(this._stack.lastIndex,{})}},{key:"array",value:function(){var t=this._stack.last;if(null!=t){if("object"===Kt(t)){if(t instanceof Array)return;throw t instanceof Map?new Error("Unable to define the current value as an array as the current value is a map."):new Error("Unable to define the current value as an array as the current value is an object.")}throw new Error("Unable to define the current value as an array as the current value is a primitive value.")}this._stack.set(this._stack.lastIndex,[])}},{key:"map",value:function(){var t=this._stack.last;if(null!=t){if("object"===Kt(t)){if(t instanceof Array)throw new Error("Unable to define the current value as a map as the current value is an array.");if(t instanceof Map)return;throw new Error("Unable to define the current value as a map as the current value is an object.")}throw new Error("Unable to define the current value as a map as the current value is a primitive value.")}this._stack.set(this._stack.lastIndex,new Map)}},{key:"swap",value:function(t){this._stack.set(this._stack.lastIndex,t)}},{key:"set",value:function(t,e){Rt.setIn(this._stack.last,t,e)}},{key:"push",value:function(t,e){Rt.pushIn(this._stack.last,t,e)}},{key:"publish",value:function(){var t=this._stack.first;this._stack.clear(),this._path.clear(),this._stack.push(void 0),this._output.produce(t)}},{key:"handleCompletion",value:function(){var t=this._stack.first;this._stack.clear(),this._path.clear(),this._output.produce(t),this._output.complete()}},{key:"handleFailure",value:function(t){this._output.fail(t)}},{key:"addEventListener",value:function(t,e){this._output.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this._output.removeEventListener(t,e)}},{key:"removeAllEventListener",value:function(){var t;(t=this._output).removeAllEventListener.apply(t,arguments)}},{key:"clear",value:function(){this._stack.clear()}}])&&Jt(e.prototype,n),r&&Jt(e,r),o}(dt);function ie(t){return(ie="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ae(t,e,n){return(ae="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=le(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function ue(t,e){return(ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function se(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=le(t);if(e){var i=le(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ce(this,n)}}function ce(t,e){return!e||"object"!==ie(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function le(t){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fe,he,pe=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ue(t,e)}(o,t);var e,n,r,i=se(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._index=0,t._event=new Lt,t}return e=o,(n=[{key:"publish",value:function(){return this._event.publish(),this.produce(),this}},{key:"object",value:function(){return this._event.object(),this.produce(),this}},{key:"array",value:function(){return this._event.array(),this.produce(),this}},{key:"map",value:function(){return this._event.map(),this.produce(),this}},{key:"swap",value:function(t){return this._event.swap(t),this.produce(),this}},{key:"move",value:function(){var t;return(t=this._event).move.apply(t,arguments),this.produce(),this}},{key:"back",value:function(){return this._event.back(),this.produce(),this}},{key:"set",value:function(){var t;return(t=this._event).set.apply(t,arguments),this.produce(),this}},{key:"push",value:function(){var t;return(t=this._event).push.apply(t,arguments),this.produce(),this}},{key:"initialize",value:function(){this.clear(),ae(le(o.prototype),"initialize",this).call(this)}},{key:"produce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._event;t.index=this._index,this._index+=1,ae(le(o.prototype),"produce",this).call(this,t)}},{key:"complete",value:function(){ae(le(o.prototype),"complete",this).call(this)}},{key:"clear",value:function(){this._index=0,this._event.clear()}}])&&oe(e.prototype,n),r&&oe(e,r),o}(Wt),ye=n(757),ve=n.n(ye);function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.MINUS="-".codePointAt(0),t.SHARP="#".codePointAt(0),t.DOT=".".codePointAt(0),t.DOUBLE_DOT=":".codePointAt(0),t.ANTISLASH="\\".codePointAt(0),t.OPENING_BRACE="{".codePointAt(0),t.CLOSING_BRACE="}".codePointAt(0),t.ZERO="0".codePointAt(0),t.ONE="1".codePointAt(0),t.TWO="2".codePointAt(0),t.THREE="3".codePointAt(0),t.FOUR="4".codePointAt(0),t.FIVE="5".codePointAt(0),t.SIX="6".codePointAt(0),t.SEVEN="7".codePointAt(0),t.EIGHT="8".codePointAt(0),t.NINE="9".codePointAt(0),t.NEW_LINE="\n".codePointAt(0),t.CARRIAGE_RETURN="\r".codePointAt(0),t.TABULATION="\t".codePointAt(0),t.FORM_FEED="\f".codePointAt(0),t.DOUBLE_QUOTE='"'.codePointAt(0),t.SPACE=" ".codePointAt(0),t.a="a".codePointAt(0),t.b="b".codePointAt(0),t.c="c".codePointAt(0),t.d="d".codePointAt(0),t.e="e".codePointAt(0),t.f="f".codePointAt(0),t.g="g".codePointAt(0),t.h="h".codePointAt(0),t.i="i".codePointAt(0),t.j="j".codePointAt(0),t.k="k".codePointAt(0),t.l="l".codePointAt(0),t.m="m".codePointAt(0),t.n="n".codePointAt(0),t.o="o".codePointAt(0),t.p="p".codePointAt(0),t.q="q".codePointAt(0),t.r="r".codePointAt(0),t.s="s".codePointAt(0),t.t="t".codePointAt(0),t.u="u".codePointAt(0),t.v="v".codePointAt(0),t.w="w".codePointAt(0),t.x="x".codePointAt(0),t.y="y".codePointAt(0),t.z="z".codePointAt(0),t.A="A".codePointAt(0),t.B="B".codePointAt(0),t.C="C".codePointAt(0),t.D="D".codePointAt(0),t.E="E".codePointAt(0),t.F="F".codePointAt(0),t.G="G".codePointAt(0),t.H="H".codePointAt(0),t.I="I".codePointAt(0),t.J="J".codePointAt(0),t.K="K".codePointAt(0),t.L="L".codePointAt(0),t.M="M".codePointAt(0),t.N="N".codePointAt(0),t.O="O".codePointAt(0),t.P="P".codePointAt(0),t.Q="Q".codePointAt(0),t.R="R".codePointAt(0),t.S="S".codePointAt(0),t.T="T".codePointAt(0),t.U="U".codePointAt(0),t.V="V".codePointAt(0),t.W="W".codePointAt(0),t.X="X".codePointAt(0),t.Y="Y".codePointAt(0),t.Z="Z".codePointAt(0),t.COLON=":".codePointAt(0),t.SEMICOLON=";".codePointAt(0),t.isDecimalDigit=function(e){return e>=t.ZERO&&e<=t.NINE},t.isBinaryDigit=function(e){return e===t.ZERO||e===t.ONE},t.isHexadecimalDigit=function(e){return e>=t.ZERO&&e<=t.NINE||e>=t.A&&e<=t.F||e>=t.a&&e<=t.f},t.isWhitespace=function(e){return e===t.CARRIAGE_RETURN||e===t.NEW_LINE||e===t.FORM_FEED||e===t.TABULATION||e===t.SPACE},t.toDebugString=function(e){switch(e){case t.CARRIAGE_RETURN:return":r";case t.NEW_LINE:return":n";case t.FORM_FEED:return":f";case t.TABULATION:return":t";case t.SPACE:return":s";default:return String.fromCodePoint(e)}}}(fe||(fe={})),function(t){t.RUNTIME=0,t.RESOURCE=1,t.BUFFER=2,t.TEXT=3,t.NETWORK=4,t.ALL=[t.RUNTIME,t.RESOURCE,t.BUFFER,t.TEXT,t.NETWORK],t.toString=function(e){switch(e){case t.RUNTIME:return"RUNTIME";case t.RESOURCE:return"RESOURCE";case t.BUFFER:return"BUFFER";case t.TEXT:return"TEXT";case t.NETWORK:return"NETWORK";default:return}}}(he||(he={}));var be=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=he.BUFFER,this.byte=e}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return"byte "+this.byte}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type&&this.byte===e.byte)}}])&&de(e.prototype,n),r&&de(e,r),t}();function me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(e){return new t(e)}}(be||(be={}));var Ee=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=he.NETWORK,this.address=e}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return this.address}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type&&this.address===e.address)}}])&&me(e.prototype,n),r&&me(e,r),t}();function ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(e){return new t(e)}}(Ee||(Ee={}));var _e=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=he.RESOURCE,this.unifiedResourceIdentifier=e}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return this.unifiedResourceIdentifier}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type&&this.unifiedResourceIdentifier===e.unifiedResourceIdentifier)}}])&&ge(e.prototype,n),r&&ge(e,r),t}();function Te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(e){return new t(e)}}(_e||(_e={}));var ke=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=he.RUNTIME}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return"runtime"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type)}}])&&Te(e.prototype,n),r&&Te(e,r),t}();function Se(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ae(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(ke||(ke={}));var we=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Se(this,t),this.column=n,this.line=e,this.index=r}var e,n,r;return e=t,(n=[{key:"asUnknown",value:function(){this.column=-1,this.line=-1,this.index=-1}},{key:"isUnknown",value:function(){return-1===this.index}},{key:"add",value:function(t,e,n){this.index<0||(this.column+=e,this.line+=t,this.index+=n)}},{key:"subtract",value:function(t,e,n){this.index<0||(this.column=Math.max(this.column-e,0),this.line=Math.max(this.line-t,0),this.index=Math.max(this.index-n,0))}},{key:"set",value:function(t,e,n){this.column=e,this.line=t,this.index=n}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"copy",value:function(t){this.column=t.column,this.line=t.line,this.index=t.index}},{key:"clear",value:function(){this.column=0,this.line=0,this.index=0}},{key:"toString",value:function(){return this.index<0?"unknown":"".concat(this.line,":").concat(this.column,"/").concat(this.index)}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&(-1===e.index&&-1===this.index||e.line===this.line&&e.column===this.column&&e.index===this.index))}}])&&Ae(e.prototype,n),r&&Ae(e,r),t}();function Oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}we.ZERO=new we(0,0,0),we.UNKNOWN=new we(-1,-1,-1),function(t){var e=/\(?\s*(\d+)\s*,?\s*(\d+)\s*,?\s*(\d+)\s*\)?/i;function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new t(e,n,r)}t.create=n,t.fromString=function(n){var r=e.exec(n);if(r)return new t(parseInt(r[1]),parseInt(r[2]),parseInt(r[3]));throw new Error('Unable to extract an unidoc location from "'+n+'".')},t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Duplicator.fromFactory(n)}(we||(we={}));var Re,Ne=function(){function t(){if(Oe(this,t),this.type=he.TEXT,(arguments.length<=0?void 0:arguments[0])instanceof we){var e=arguments.length<=0?void 0:arguments[0];this.line=e.line,this.column=e.column,this.index=e.index}else this.line=arguments.length<=0?void 0:arguments[0],this.column=arguments.length<=1?void 0:arguments[1],this.index=arguments.length<=2?void 0:arguments[2]}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return"index "+this.index+" at line "+this.line+" and column "+this.column}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type&&this.index===e.index&&this.line===e.line&&this.column===e.column)}}])&&Ie(e.prototype,n),r&&Ie(e,r),t}();function Ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(e,n,r){return new t(e,n,r)}}(Ne||(Ne={})),function(t){t.buffer=be.create,t.network=Ee.create,t.resource=_e.create,t.runtime=ke.create,t.text=Ne.create}(Re||(Re={}));var Pe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;Ce(this,t),this.elements=U.Pack.any(e)}var e,n,r;return e=t,(n=[{key:"reallocate",value:function(t){this.elements.reallocate(t)}},{key:"text",value:function(t,e,n){return this.elements.push(Re.text(t,e,n)),this}},{key:"buffer",value:function(t){return this.elements.push(Re.buffer(t)),this}},{key:"resource",value:function(t){return this.elements.push(Re.resource(t)),this}},{key:"network",value:function(t){return this.elements.push(Re.network(t)),this}},{key:"runtime",value:function(){return this.elements.push(Re.runtime()),this}},{key:"concat",value:function(t){this.elements.concat(t.elements)}},{key:"copy",value:function(t){this.elements.copy(t.elements)}},{key:"clone",value:function(){var e=new t(this.elements.capacity);return e.copy(this),e}},{key:"clear",value:function(){this.elements.clear()}},{key:"toString",value:function(){if(this.elements.size>0){for(var t=this.elements.first.toString(),e=1;e<this.elements.size;++e)t+=" at "+this.elements.get(e).toString();return t}return"undefined origin"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.elements.equals(this.elements))}}])&&xe(e.prototype,n),r&&xe(e,r),t}();function Le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function De(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.Element=Re,t.RUNTIME=new t(1).runtime(),t.runtime=function(){return t.RUNTIME}}(Pe||(Pe={}));var Ue=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;Le(this,t),this.state=new Me(e),this._builtOrigin=this.state.from}var e,n,r;return e=t,(n=[{key:"capacity",value:function(t){return this.state.reallocate(t),this}},{key:"from",value:function(t){return t?this.state.from.copy(t):this._builtOrigin=this.state.from,this}},{key:"to",value:function(t){return t?this.state.to.copy(t):this._builtOrigin=this.state.to,this}},{key:"runtime",value:function(){return this._builtOrigin.runtime(),this}},{key:"text",value:function(t,e,n){return this._builtOrigin.text(t,e,n),this}},{key:"buffer",value:function(t){return this._builtOrigin.buffer(t),this}},{key:"resource",value:function(t){return this._builtOrigin.resource(t),this}},{key:"network",value:function(t){return this._builtOrigin.network(t),this}},{key:"at",value:function(){return this}},{key:"copy",value:function(e){return e instanceof Me?this.state.copy(e):e instanceof t?this.state.copy(e.state):this._builtOrigin.copy(e),this}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){return this.state.clear(),this}},{key:"build",value:function(){var t=this.state.clone();return this.state.clear(),t}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.state.equals(e.state))}}])&&De(e.prototype,n),r&&De(e,r),t}();function je(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function We(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(Ue||(Ue={}));var Me=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;je(this,t),this.from=new Pe(e),this.to=new Pe(e)}var e,n,r;return e=t,(n=[{key:"reallocate",value:function(t){this.from.reallocate(t),this.to.reallocate(t)}},{key:"runtime",value:function(){return this.from.runtime(),this.to.runtime(),this}},{key:"at",value:function(t){return this.from.copy(t),this.to.copy(t),this}},{key:"copy",value:function(t){this.from.copy(t.from),this.to.copy(t.to)}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.from.clear(),this.to.clear()}},{key:"toString",value:function(){return this.from.equals(this.to)?this.from.toString():"from "+this.from.toString()+" to "+this.to.toString()}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.from.equals(e.from)&&this.to.equals(e.to))}}])&&We(e.prototype,n),r&&We(e,r),t}();function Fe(t){return function(t){if(Array.isArray(t))return Be(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||ze(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ge(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=ze(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function ze(t,e){if(t){if("string"===typeof t)return Be(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Be(t,e):void 0}}function Be(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function He(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t},t.RUNTIME=new t(1).runtime(),t.runtime=function(){return t.RUNTIME},t.builder=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return new Ue(t)}}(Me||(Me={}));var Ve,qe=/^([a-zA-Z0-9\-]+)(#[a-zA-Z0-9\-]+)?((?:\.[a-zA-Z0-9\-]+)+)?$/i,Ye="",Ke=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=0,this.type=S.START_TAG,this.tag=Ye,this.identifier=Ye,this.classes=new Set,this.symbols=U.Pack.uint32(128),this.origin=(new Me).runtime()}var e,n,r;return e=t,(n=[{key:"substring",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.symbols.size-t,n=[],r=t,i=t+e,o=r;o<i;++o)n.push(this.symbols.get(o));return String.fromCodePoint.apply(String,n)}},{key:"isStartOfAnyTag",value:function(){return this.type===S.START_TAG}},{key:"isStartOfTag",value:function(t){return this.type===S.START_TAG&&this.tag===t}},{key:"isEndOfAnyTag",value:function(){return this.type===S.END_TAG}},{key:"isEndOfTag",value:function(t){return this.type===S.END_TAG&&this.tag===t}},{key:"isWhitespace",value:function(){return this.type===S.WHITESPACE}},{key:"isWord",value:function(){return this.type===S.WORD}},{key:"ofIndex",value:function(t){return this.index=t,this}},{key:"asWord",value:function(t){this.identifier=Ye,this.tag=Ye,this.classes.clear(),this.type=S.WORD,this.text=t}},{key:"asWhitespace",value:function(t){this.identifier=Ye,this.tag=Ye,this.classes.clear(),this.type=S.WHITESPACE,this.text=t}},{key:"asTagStart",value:function(t){this.symbols.clear(),this.classes.clear(),this.type=S.START_TAG,this.tag=Ye,this.identifier=Ye;var e=qe.exec(t);if(null!=e&&(this.tag=e[1],this.identifier=null==e[2]?Ye:e[2].substring(1),null!=e[3])){var n,r=Ge(e[3].substring(1).split("."));try{for(r.s();!(n=r.n()).done;){var i=n.value;this.classes.add(i)}}catch(o){r.e(o)}finally{r.f()}}}},{key:"asTagEnd",value:function(t){this.symbols.clear(),this.classes.clear(),this.type=S.END_TAG,this.tag=Ye,this.identifier=Ye;var e=qe.exec(t);if(null!=e&&(this.tag=e[1],this.identifier=null==e[2]?Ye:e[2].substring(1),null!=e[3])){var n,r=Ge(e[3].substring(1).split("."));try{for(r.s();!(n=r.n()).done;){var i=n.value;this.classes.add(i)}}catch(o){r.e(o)}finally{r.f()}}}},{key:"addClasses",value:function(t){var e,n=Ge(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.classes.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"copy",value:function(t){this.index=t.index,this.type=t.type,this.tag=t.tag,this.identifier=t.identifier,this.symbols.copy(t.symbols),this.origin.copy(t.origin),this.classes.clear();var e,n=Ge(t.classes);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.classes.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.index=0,this.type=S.START_TAG,this.tag=Ye,this.identifier=Ye,this.origin.clear(),this.origin.runtime(),this.classes.clear(),this.symbols.clear()}},{key:"toString",value:function(){var t="";if(t+=this.index,t+=" ",t+=S.toString(this.type),t+=" ",t+=this.origin.toString(),this.tag.length>0&&(t+=" \\",t+=this.tag),this.identifier.length>0&&(t+=" #",t+=this.identifier),this.classes.size>0){t+=" ";var e,n=Ge(this.classes);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=".",t+=r}}catch(i){n.e(i)}finally{n.f()}}return this.symbols.size>0&&(t+=' "',t+=this.debugText,t+='"'),t}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.index!==this.index||e.type!==this.type||e.classes.size!==this.classes.size||e.identifier!==this.identifier||e.tag!==this.tag||!e.origin.equals(this.origin))return!1;var n,r=Ge(e.classes);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!this.classes.has(i))return!1}}catch(o){r.e(o)}finally{r.f()}return this.symbols.equals(e.symbols)}return!1}},{key:"text",get:function(){return String.fromCodePoint.apply(String,Fe(this.symbols))},set:function(t){this.symbols.clear(),this.symbols.size=t.length;for(var e=0;e<t.length;++e)this.symbols.set(e,t.codePointAt(e))}},{key:"debugText",get:function(){var t,e=[],n=Ge(this.symbols);try{for(n.s();!(t=n.n()).done;){var r=t.value;switch(r){case fe.NEW_LINE:e.push(fe.COLON),e.push(fe.n);break;case fe.CARRIAGE_RETURN:e.push(fe.COLON),e.push(fe.r);break;case fe.TABULATION:e.push(fe.COLON),e.push(fe.t);break;case fe.SPACE:e.push(fe.COLON),e.push(fe.s);break;case fe.FORM_FEED:e.push(fe.COLON),e.push(fe.f);break;default:e.push(r)}}}catch(i){n.e(i)}finally{n.f()}return String.fromCodePoint.apply(String,e)}}])&&He(e.prototype,n),r&&He(e,r),t}();function Xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.create=e,t.word=function(e){var n=new t;return n.asWord(e),n},t.whitespace=function(e){var n=new t;return n.asWhitespace(e),n},t.tagStart=function(e){var n=new t;return n.asTagStart(e),n},t.tagEnd=function(e){var n=new t;return n.asTagEnd(e),n},t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Duplicator.fromFactory(e),t.equals=function(t,e){return null==t?t==e:t.equals(e)}}(Ke||(Ke={})),function(t){function e(e){switch(e){case t.START:return"START";case t.EVENT:return"EVENT";case t.GROUP_START:return"GROUP_START";case t.GROUP_END:return"GROUP_END";case t.END:return"END";default:return}}t.START=0,t.EVENT=1,t.GROUP_START=2,t.GROUP_END=3,t.END=4,t.ALL=[t.START,t.EVENT,t.GROUP_START,t.GROUP_END,t.END],t.DEFAULT=t.START,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(Ve||(Ve={}));var Ze,$e=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=Ve.DEFAULT,this.event=new Ke,this.group=void 0}var e,n,r;return e=t,(n=[{key:"isStart",value:function(){return this.type===Ve.START}},{key:"isEnd",value:function(){return this.type===Ve.END}},{key:"isEvent",value:function(){return this.type===Ve.EVENT}},{key:"isWhitespace",value:function(){return this.type===Ve.EVENT&&this.event.type===S.WHITESPACE}},{key:"isWord",value:function(t){return this.type===Ve.EVENT&&this.event.type===S.WORD&&this.event.text===t}},{key:"isAnyWord",value:function(){return this.type===Ve.EVENT&&this.event.type===S.WORD}},{key:"isStartOfTag",value:function(t){return this.type===Ve.EVENT&&this.event.type===S.START_TAG&&this.event.tag===t}},{key:"isEndOfTag",value:function(t){return this.type===Ve.EVENT&&this.event.type===S.END_TAG&&this.event.tag===t}},{key:"isStartOfAnyTag",value:function(){return this.type===Ve.EVENT&&this.event.type===S.START_TAG}},{key:"isEndOfAnyTag",value:function(){return this.type===Ve.EVENT&&this.event.type===S.END_TAG}},{key:"isStartOfAnyGroup",value:function(){return this.type===Ve.GROUP_START}},{key:"isStartOfGroup",value:function(t){return this.type===Ve.GROUP_START&&this.group===t}},{key:"isEndOfAnyGroup",value:function(){return this.type===Ve.GROUP_END}},{key:"isEndOfGroup",value:function(t){return this.type===Ve.GROUP_END&&this.group===t}},{key:"asStart",value:function(){return this.type=Ve.START,this.event.clear(),this.group=void 0,this}},{key:"asEvent",value:function(t){return this.type=Ve.EVENT,this.event.copy(t),this.group=void 0,this}},{key:"asGroupStart",value:function(t){return this.type=Ve.GROUP_START,this.event.clear(),this.group=t,this}},{key:"asGroupEnd",value:function(t){return this.type=Ve.GROUP_END,this.event.clear(),this.group=t,this}},{key:"asEnd",value:function(){return this.type=Ve.END,this.event.clear(),this.group=void 0,this}},{key:"copy",value:function(t){this.type=t.type,this.event.copy(t.event),this.group=t.group}},{key:"clear",value:function(){this.type=Ve.DEFAULT,this.event.clear(),this.group=void 0}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"toString",value:function(){var t=this.constructor.name;switch(t+=" ",t+=Ve.toDebugString(this.type),this.type){case Ve.START:case Ve.END:return t;case Ve.EVENT:return t+" "+this.event.toString();case Ve.GROUP_START:case Ve.GROUP_END:return t+" "+this.group;default:throw new Error("Unable to stringify reduction event of type "+Ve.toDebugString(this.type)+" because no procedure was defined for that.")}}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.type===this.type&&e.event.equals(this.event)&&e.group===this.group)}}])&&Xe(e.prototype,n),r&&Xe(e,r),t}();!function(t){function e(){return new t}t.START=(new t).asStart(),t.END=(new t).asEnd(),t.create=e,t.event=function(e){return(new t).asEvent(e)},t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Allocator.fromFactory(e),t.equals=function(t,e){return null==t?t==e:t.equals(e)}}($e||($e={})),function(t){function e(e){switch(e){case t.CURRENT:return"CURRENT";case t.NEXT:return"NEXT";default:return}}t.CURRENT=0,t.NEXT=1,t.ALL=[t.CURRENT,t.NEXT],t.DEFAULT=t.CURRENT,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(Ze||(Ze={}));var Je=ve().mark(Qe);function Qe(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze.CURRENT;case 2:t=e.sent;case 3:e.t0=t.type,e.next=e.t0===Ve.END?7:e.t0===Ve.EVENT?8:10;break;case 7:return e.abrupt("return",t);case 8:if(t.event.type!==S.START_TAG){e.next=10;break}return e.abrupt("return",t);case 10:return e.next=12,Ze.NEXT;case 12:t=e.sent;case 13:e.next=3;break;case 15:case"end":return e.stop()}}),Je)}function tn(t){return(tn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function en(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nn(t,e){return(nn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=an(t);if(e){var i=an(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return on(this,n)}}function on(t,e){return!e||"object"!==tn(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var un,sn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nn(t,e)}(o,t);var e,n,r,i=rn(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).reducerFactory=t,e._reducer=void 0,e._output=new Yt,e}return e=o,(n=[{key:"handleInitialization",value:function(){this._reducer=this.reducerFactory(),this._output.initialize()}},{key:"handleProduction",value:function(t){if(this._reducer){var e=Xn.feed(this._reducer,t);e.done&&(this._output.produce(e.value),this._reducer=void 0)}}},{key:"handleCompletion",value:function(){this._reducer&&(this._output.produce(Xn.finish(this._reducer)),this._reducer=void 0),this._output.complete()}},{key:"handleFailure",value:function(t){this._output.fail(t)}},{key:"addEventListener",value:function(t,e){this._output.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this._output.removeEventListener(t,e)}},{key:"removeAllEventListener",value:function(){var t;(t=this._output).removeAllEventListener.apply(t,arguments)}}])&&en(e.prototype,n),r&&en(e,r),o}(dt);function cn(t){return(cn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fn(t,e,n){return(fn="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vn(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function hn(t,e){return(hn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=vn(t);if(e){var i=vn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return yn(this,n)}}function yn(t,e){return!e||"object"!==cn(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vn(t){return(vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){function e(e){switch(e){case t.VALIDATION:return"VALIDATION";case t.DOCUMENT_COMPLETION:return"DOCUMENT_COMPLETION";case t.MESSAGE:return"MESSAGE";case t.BEGIN_GROUP:return"BEGIN_GROUP";case t.END_GROUP:return"END_GROUP";default:return}}t.VALIDATION=0,t.DOCUMENT_COMPLETION=1,t.MESSAGE=2,t.BEGIN_GROUP=3,t.END_GROUP=4,t.DEFAULT=t.VALIDATION,t.ALL=[t.VALIDATION,t.DOCUMENT_COMPLETION,t.MESSAGE,t.BEGIN_GROUP,t.END_GROUP],t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(un||(un={}));var dn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hn(t,e)}(o,t);var e,n,r,i=pn(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._event=new $e,t}return e=o,(n=[{key:"fail",value:function(t){fn(vn(o.prototype),"fail",this).call(this,t)}},{key:"initialize",value:function(){fn(vn(o.prototype),"initialize",this).call(this)}},{key:"produceStart",value:function(){return this.produce($e.START),this}},{key:"produceEvent",value:function(t){return this.produce(this._event.asEvent(t)),this}},{key:"produceGroupStart",value:function(t){return this.produce(this._event.asGroupStart(t)),this}},{key:"produceGroupEnd",value:function(t){return this.produce(this._event.asGroupEnd(t)),this}},{key:"produceEnd",value:function(){return this.produce($e.END),this}},{key:"produce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._event;fn(vn(o.prototype),"produce",this).call(this,t)}},{key:"complete",value:function(){fn(vn(o.prototype),"complete",this).call(this)}},{key:"clear",value:function(){this._event.clear(),this.removeAllEventListener()}}])&&ln(e.prototype,n),r&&ln(e,r),o}(Wt);function bn(t){return(bn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function En(t,e){return(En=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Tn(t);if(e){var i=Tn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _n(this,n)}}function _n(t,e){return!e||"object"!==bn(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tn(t){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(){return new t}}(dn||(dn={}));var kn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&En(t,e)}(o,t);var e,n,r,i=gn(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._output=new dn,t}return e=o,(n=[{key:"handleInitialization",value:function(){this._output.initialize(),this._output.produceStart()}},{key:"handleProduction",value:function(t){switch(t.type){case un.VALIDATION:return void this._output.produceEvent(t.event);case un.DOCUMENT_COMPLETION:case un.MESSAGE:return;case un.BEGIN_GROUP:return void this._output.produceGroupStart(t.group);case un.END_GROUP:return void this._output.produceGroupEnd(t.group);default:throw new Error("Unable to map validation event of type "+un.toDebugString(t.type)+" because no procedure was defined for that.")}}},{key:"handleCompletion",value:function(){this._output.produceEnd(),this._output.complete()}},{key:"handleFailure",value:function(t){this._output.fail(t)}},{key:"addEventListener",value:function(t,e){this._output.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this._output.removeEventListener(t,e)}},{key:"removeAllEventListener",value:function(){var t;(t=this._output).removeAllEventListener.apply(t,arguments)}}])&&mn(e.prototype,n),r&&mn(e,r),o}(dt);function Sn(t,e){var n=new sn(e);return n.subscribe(t),n}!function(t){t.validation=function(t,e){var n=new sn(e),r=new kn;return r.subscribe(t),n.subscribe(r),n},t.iterator=function(t,e){for(var n=t.next();!n.done;){var r=Xn.feed(e,n.value);if(r.done)return r.value;n=t.next()}return Xn.finish(e)}}(Sn||(Sn={}));var An=ve().mark(wn);function wn(t){var e,n;return ve().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ze.CURRENT;case 2:e=r.sent;case 3:if(e.isEnd()){r.next=17;break}r.t0=e.type,r.next=r.t0===Ve.START||r.t0===Ve.EVENT?7:11;break;case 7:if(!(n=Xn.feed(t,e)).done){r.next=10;break}return r.abrupt("return",n.value);case 10:case 11:return r.abrupt("break",12);case 12:return r.next=14,Ze.NEXT;case 14:e=r.sent,r.next=3;break;case 17:return r.abrupt("return",Xn.finish(t));case 18:case"end":return r.stop()}}),An)}var On=ve().mark(In);function In(t){var e,n;return ve().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=[];case 1:return r.delegateYield(t(),"t0",3);case 3:if(void 0!==(n=r.t0)){r.next=8;break}return r.abrupt("return",e);case 8:e.push(n);case 9:r.next=1;break;case 11:case"end":return r.stop()}}),On)}var Rn=ve().mark(Nn);function Nn(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ze.CURRENT;case 2:if(!t.sent.isStart()){t.next=7;break}return t.next=6,Ze.NEXT;case 6:t.sent;case 7:case"end":return t.stop()}}),Rn)}var Cn=ve().mark(xn);function xn(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze.CURRENT;case 2:t=e.sent;case 3:if(!t.isWhitespace()){e.next=9;break}return e.next=6,Ze.NEXT;case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),Cn)}var Pn=ve().mark(Ln);function Ln(t){var e,n,r;return ve().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.delegateYield(Nn(),"t0",1);case 1:return i.delegateYield(xn(),"t1",2);case 2:return i.next=4,Ze.CURRENT;case 4:if(!(e=i.sent).isStartOfAnyTag()){i.next=37;break}n=0,r=Xn.feed(t,$e.START);case 8:i.t2=e.type,i.next=i.t2===Ve.END?11:i.t2===Ve.EVENT?16:24;break;case 11:if(!r.done){i.next=15;break}return i.abrupt("return",r.value);case 15:return i.abrupt("return",Xn.finish(t));case 16:i.t3=e.event.type,i.next=i.t3===S.START_TAG?19:i.t3===S.END_TAG?21:23;break;case 19:return n+=1,i.abrupt("break",24);case 21:return n-=1,i.abrupt("break",24);case 23:return i.abrupt("break",24);case 24:return r.done||(r=Xn.feed(t,e)),i.abrupt("break",26);case 26:return i.next=28,Ze.NEXT;case 28:e=i.sent;case 29:if(n>0){i.next=8;break}case 30:if(!r.done){i.next=34;break}return i.abrupt("return",r.value);case 34:return i.abrupt("return",Xn.finish(t));case 35:i.next=38;break;case 37:return i.abrupt("return",void 0);case 38:case"end":return i.stop()}}),Pn)}!function(t){var e=ve().mark(n);function n(t){var n,r,i;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Nn(),"t0",1);case 1:return e.delegateYield(xn(),"t1",2);case 2:return e.next=4,Ze.CURRENT;case 4:if(!(n=e.sent).isStartOfAnyTag()){e.next=65;break}return r=Xn.feed(t,$e.START),e.next=9,Ze.NEXT;case 9:n=e.sent,e.t2=n.type,e.next=e.t2===Ve.END?13:e.t2===Ve.EVENT?18:29;break;case 13:if(!r.done){e.next=17;break}return e.abrupt("return",r.value);case 17:return e.abrupt("return",Xn.finish(t));case 18:e.t3=n.event.type,e.next=e.t3===S.END_TAG?21:28;break;case 21:return e.next=23,Ze.NEXT;case 23:if(!r.done){e.next=27;break}return e.abrupt("return",r.value);case 27:return e.abrupt("return",Xn.finish(t));case 28:return e.abrupt("break",29);case 29:return e.abrupt("break",30);case 30:i=1;case 31:if(!(i>0)){e.next=55;break}return r.done||(r=Xn.feed(t,n)),e.next=35,Ze.NEXT;case 35:n=e.sent,e.t4=n.type,e.next=e.t4===Ve.END?39:e.t4===Ve.EVENT?44:52;break;case 39:if(!r.done){e.next=43;break}return e.abrupt("return",r.value);case 43:return e.abrupt("return",Xn.finish(t));case 44:e.t5=n.event.type,e.next=e.t5===S.START_TAG?47:e.t5===S.END_TAG?49:51;break;case 47:return i+=1,e.abrupt("break",52);case 49:return i-=1,e.abrupt("break",52);case 51:return e.abrupt("break",52);case 52:return e.abrupt("break",53);case 53:e.next=31;break;case 55:for(;i>0;);return e.next=58,Ze.NEXT;case 58:if(!r.done){e.next=62;break}return e.abrupt("return",r.value);case 62:return e.abrupt("return",Xn.finish(t));case 63:e.next=66;break;case 65:return e.abrupt("return",void 0);case 66:case"end":return e.stop()}}),e)}t.content=n}(Ln||(Ln={}));var Dn=ve().mark(Un);function Un(){var t,e;return ve().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ze.CURRENT;case 2:if(!(e=n.sent).isStart()){n.next=9;break}return n.next=6,Ze.NEXT;case 6:if(!(e=n.sent).isEnd()){n.next=9;break}return n.abrupt("return","");case 9:if(!e.isAnyWord()){n.next=13;break}t=e.event.text,n.next=14;break;case 13:return n.abrupt("return",void 0);case 14:return n.next=16,Ze.NEXT;case 16:e=n.sent;case 17:if(!e.isAnyWord()){n.next=24;break}return t+=e.event.text,n.next=21,Ze.NEXT;case 21:e=n.sent,n.next=17;break;case 24:return n.abrupt("return",t);case 25:case"end":return n.stop()}}),Dn)}var jn=ve().mark(Wn);function Wn(){var t,e;return ve().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ze.CURRENT;case 2:if(!(e=n.sent).isStart()){n.next=9;break}return n.next=6,Ze.NEXT;case 6:if(!(e=n.sent).isEnd()){n.next=9;break}return n.abrupt("return","");case 9:if(!e.isWhitespace()&&!e.isAnyWord()){n.next=38;break}return n.delegateYield(xn(),"t0",11);case 11:return n.delegateYield(Un(),"t2",12);case 12:if(n.t1=n.t2,n.t1){n.next=15;break}n.t1="";case 15:return t=n.t1,n.next=18,Ze.CURRENT;case 18:e=n.sent;case 19:if(!e.isWhitespace()){n.next=37;break}return n.delegateYield(xn(),"t3",21);case 21:return n.next=23,Ze.CURRENT;case 23:if(!(e=n.sent).isAnyWord()){n.next=31;break}return t+=" ",n.t4=t,n.delegateYield(Un(),"t5",28);case 28:t=n.t4+=n.t5,n.next=32;break;case 31:return n.abrupt("return",t);case 32:return n.next=34,Ze.CURRENT;case 34:e=n.sent,n.next=19;break;case 37:return n.abrupt("return",t);case 38:return n.abrupt("return",void 0);case 39:case"end":return n.stop()}}),jn)}function Mn(){return wn(Wn())}var Fn=ve().mark(Gn);function Gn(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze.CURRENT;case 2:if(!(t=e.sent).isStart()){e.next=9;break}return e.next=6,Ze.NEXT;case 6:if(!(t=e.sent).isEnd()){e.next=9;break}return e.abrupt("return","");case 9:if(!t.isWhitespace()&&!t.isAnyWord()){e.next=16;break}return e.delegateYield(xn(),"t0",11);case 11:return e.delegateYield(Un(),"t2",12);case 12:if(e.t1=e.t2,e.t1){e.next=15;break}e.t1="";case 15:return e.abrupt("return",e.t1);case 16:return e.abrupt("return",void 0);case 17:case"end":return e.stop()}}),Fn)}function zn(){return wn(Gn())}var Bn=ve().mark(Hn);function Hn(){var t,e;return ve().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ze.CURRENT;case 2:if(!(e=n.sent).isStart()){n.next=9;break}return n.next=6,Ze.NEXT;case 6:if(!(e=n.sent).isEnd()){n.next=9;break}return n.abrupt("return","");case 9:if(!e.isWhitespace()){n.next=13;break}t=e.event.text,n.next=14;break;case 13:return n.abrupt("return",void 0);case 14:return n.next=16,Ze.NEXT;case 16:e=n.sent;case 17:if(!e.isWhitespace()){n.next=24;break}return t+=e.event.text,n.next=21,Ze.NEXT;case 21:e=n.sent,n.next=17;break;case 24:return n.abrupt("return",t);case 25:case"end":return n.stop()}}),Bn)}var Vn=ve().mark(qn);function qn(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ze.CURRENT;case 2:if(!t.sent.isEndOfAnyTag()){t.next=7;break}return t.next=6,Ze.NEXT;case 6:t.sent;case 7:case"end":return t.stop()}}),Vn)}var Yn=ve().mark(Kn);function Kn(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ze.CURRENT;case 2:if(!t.sent.isStartOfAnyTag()){t.next=7;break}return t.next=6,Ze.NEXT;case 6:t.sent;case 7:case"end":return t.stop()}}),Yn)}var Xn,Zn,$n=ve().mark(Jn);function Jn(){var t,e;return ve().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Nn(),"t0",1);case 1:return n.delegateYield(xn(),"t1",2);case 2:return n.next=4,Ze.CURRENT;case 4:if(!(t=n.sent).isStartOfAnyTag()){n.next=30;break}e=1;case 7:if(!(e>0)){n.next=27;break}return n.next=10,Ze.NEXT;case 10:t=n.sent,n.t2=t.type,n.next=n.t2===Ve.END?14:n.t2===Ve.EVENT?15:24;break;case 14:return n.abrupt("return",t);case 15:n.t3=t.event.type,n.next=n.t3===S.START_TAG?18:n.t3===S.END_TAG?20:22;break;case 18:return e+=1,n.abrupt("break",23);case 20:return e-=1,n.abrupt("break",23);case 22:return n.abrupt("break",23);case 23:case 24:return n.abrupt("break",25);case 25:n.next=7;break;case 27:return n.next=29,Ze.NEXT;case 29:return n.abrupt("return",n.sent);case 30:return n.next=32,Ze.CURRENT;case 32:return n.abrupt("return",n.sent);case 33:case"end":return n.stop()}}),$n)}function Qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){var e=ve().mark(r);function n(t,e){for(var n=t.next(e);!n.done&&n.value===Ze.CURRENT;)n=t.next(e);return n}function r(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze.CURRENT;case 2:t=e.sent;case 3:if(t.isEnd()){e.next=10;break}return console.log(t.toString()),e.next=7,Ze.NEXT;case 7:t=e.sent,e.next=3;break;case 10:console.log(t.toString());case 11:case"end":return e.stop()}}),e)}t.feed=n,t.finish=function(t){var e=n(t,$e.END);if(e.done)return e.value;throw new Error("Illegal nested reducer behavior, the nested reducer continue to run despite the fact that it received the event that notify the end of the reduction process.")},t.log=r,t.nextTag=Qe,t.reduce=Sn,t.reduceEvents=wn,t.reduceMany=In,t.reduceTag=Ln,t.reduceToken=zn,t.reduceText=Mn,t.reduceWhitespaces=Hn,t.reduceWords=Un,t.skipEndOfAnyTag=qn,t.skipStart=Nn,t.skipStartOfAnyTag=Kn,t.skipTag=Jn,t.skipWhitespaces=xn}(Xn||(Xn={})),function(t){function e(e){switch(e){case t.SYMBOL:return"SYMBOL";case t.RETURN:return"RETURN";default:return}}t.SYMBOL=0,t.RETURN=1,t.DEFAULT=t.SYMBOL,t.ALL=[t.SYMBOL,t.RETURN],t.toString=e,t.throwUnhandledState=function(t){throw new Error("Unhandled or unknown unidoc source reader state "+t+' "'+e(t)+'".')}}(Zn||(Zn={}));var tr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.location=new we,this._state=Zn.DEFAULT}var e,n,r;return e=t,(n=[{key:"nextString",value:function(t){for(var e=0,n=t.length;e<n;++e)this.next(t.codePointAt(e))}},{key:"next",value:function(t){switch(t){case fe.CARRIAGE_RETURN:this.location.add(1,0,1),this.location.column=0,this._state=Zn.RETURN;break;case fe.NEW_LINE:this._state===Zn.RETURN?(this.location.add(0,0,1),this._state=Zn.SYMBOL):this.location.add(1,0,1),this.location.column=0;break;default:this.location.add(0,1,1),this._state=Zn.SYMBOL}}},{key:"clear",value:function(){this.location.clear(),this._state=Zn.DEFAULT}},{key:"copy",value:function(t){this.location.copy(t.location),this._state=t._state}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.location.equals(this.location)&&e._state===this._state)}}])&&Qn(e.prototype,n),r&&Qn(e,r),t}();function er(t){return(er="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rr(t,e,n){return(rr="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ur(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function ir(t,e){return(ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function or(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ur(t);if(e){var i=ur(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ar(this,n)}}function ar(t,e){return!e||"object"!==er(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ur(t){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sr=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ir(t,e)}(o,t);var e,n,r,i=or(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._event=new Ke,t._event.origin.from.runtime(),t._event.origin.to.runtime(),t._index=0,t}return e=o,(n=[{key:"fail",value:function(t){rr(ur(o.prototype),"fail",this).call(this,t)}},{key:"initialize",value:function(){rr(ur(o.prototype),"initialize",this).call(this)}},{key:"event",value:function(){return this._event.clear(),this}},{key:"withType",value:function(t){return this._event.type=t,this}},{key:"withSymbols",value:function(t){return this._event.symbols.copy(t),this}},{key:"withTag",value:function(t){return this._event.tag=t,this}},{key:"withIdentifier",value:function(t){return this._event.identifier=t,this}},{key:"withClasses",value:function(t){return this._event.classes.clear(),this._event.addClasses(t),this}},{key:"at",value:function(t){return this._event.origin.from.copy(t),this._event.origin.to.copy(t),this}},{key:"from",value:function(t){return t?(this._event.origin.from.copy(t),this):(this._event.origin.from.clear(),this._event.origin.from)}},{key:"to",value:function(t){return t?(this._event.origin.to.copy(t),this):(this._event.origin.to.clear(),this._event.origin.to)}},{key:"produceWord",value:function(t){return this._event.asWord(t),this.produce(this._event),this}},{key:"produceWhitespace",value:function(t){return this._event.asWhitespace(t),this.produce(this._event),this}},{key:"produceTagStart",value:function(t){return this._event.asTagStart(t),this.produce(this._event),this}},{key:"produceTagEnd",value:function(t){return this._event.asTagEnd(t),this.produce(this._event),this}},{key:"tag",value:function(t,e){return this.produceTagStart(t),e.call(this),this.produceTagEnd(t),this}},{key:"produce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._event;t.index=this._index,this._index+=1,rr(ur(o.prototype),"produce",this).call(this,t)}},{key:"complete",value:function(){rr(ur(o.prototype),"complete",this).call(this)}},{key:"clear",value:function(){this._event.clear(),this._index=0,this.removeAllEventListener()}}])&&nr(e.prototype,n),r&&nr(e,r),o}(Wt);function cr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(sr||(sr={}));var lr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._producer=new sr,this._tracker=new tr}var e,n,r;return e=t,(n=[{key:"initialize",value:function(){return this._producer.initialize(),this}},{key:"produceWord",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(e),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceWord(t),this}},{key:"produceText",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.produceString(e.join("\r\n"))}},{key:"produceString",value:function(t){if(t.length>0){for(var e=0,n=fe.isWhitespace(t.codePointAt(0)),r=1,i=t.length;r<i;++r)fe.isWhitespace(t.codePointAt(r))!==n&&(n?this.produceWhitespace(t.substring(e,r)):this.produceWord(t.substring(e,r)),e=r,n=!n);n?this.produceWhitespace(t.substring(e)):this.produceWord(t.substring(e))}return this}},{key:"produceWhitespace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(e),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceWhitespace(t),this}},{key:"produceTagStart",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\\"+t+"{";return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(e),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceTagStart(t),this}},{key:"produceTagEnd",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"}";return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(e),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceTagEnd(t),this}},{key:"tag",value:function(t,e){return this.produceTagStart(t),e.call(this),this.produceTagEnd(t),this}},{key:"complete",value:function(){this._producer.complete()}},{key:"addEventListener",value:function(t,e){this._producer.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this._producer.removeEventListener(t,e)}},{key:"removeAllEventListener",value:function(){var t;(t=this._producer).removeAllEventListener.apply(t,arguments)}}])&&cr(e.prototype,n),r&&cr(e,r),t}();function fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(lr||(lr={}));var hr,pr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.from=new Pe(16),this.to=new Pe(16),this._symbols=U.Pack.uint32(e),this.symbols=this._symbols.view()}var e,n,r;return e=t,(n=[{key:"bufferize",value:function(t){this._symbols.size<=0&&this.from.copy(t.origin.from),this.to.copy(t.origin.to),this._symbols.push(t.symbol)}},{key:"clear",value:function(){this.from.clear(),this.to.clear(),this._symbols.clear()}}])&&fr(e.prototype,n),r&&fr(e,r),t}();function yr(t){return function(t){if(Array.isArray(t))return dr(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||vr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vr(t,e){if(t){if("string"===typeof t)return dr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dr(t,e):void 0}}function dr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function br(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.DEFAULT_TYPE=0,t.IDENTIFIER=0,t.CLASS=1,t.TAG=2,t.BLOCK_START=3,t.BLOCK_END=4,t.NEW_LINE=5,t.SPACE=6,t.WORD=7,t.ALL=[t.IDENTIFIER,t.CLASS,t.TAG,t.BLOCK_START,t.BLOCK_END,t.NEW_LINE,t.SPACE,t.WORD],t.toString=function(e){switch(e){case t.IDENTIFIER:return"IDENTIFIER";case t.CLASS:return"CLASS";case t.TAG:return"TAG";case t.BLOCK_START:return"BLOCK_START";case t.BLOCK_END:return"BLOCK_END";case t.NEW_LINE:return"NEW_LINE";case t.SPACE:return"SPACE";case t.WORD:return"WORD";default:return}}}(hr||(hr={}));var Er=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;br(this,t),this.index=0,this.type=hr.DEFAULT_TYPE,this.symbols=U.Pack.uint32(e),this.origin=new Me}var e,n,r;return e=t,(n=[{key:"substring",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.symbols.size-t,n=[],r=t,i=t+e,o=r;o<i;++o)n.push(this.symbols.get(o));return String.fromCodePoint.apply(String,n)}},{key:"as",value:function(t,e){this.type=t,this.text=e}},{key:"asIdentifier",value:function(t){this.as(hr.IDENTIFIER,t)}},{key:"asClass",value:function(t){this.as(hr.CLASS,t)}},{key:"asTag",value:function(t){this.as(hr.TAG,t)}},{key:"asBlockStart",value:function(){this.as(hr.BLOCK_START,"{")}},{key:"asBlockEnd",value:function(){this.as(hr.BLOCK_END,"}")}},{key:"asSpace",value:function(t){this.as(hr.SPACE,t)}},{key:"asNewline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\r\n";this.as(hr.NEW_LINE,t)}},{key:"asWord",value:function(t){this.as(hr.WORD,t)}},{key:"isTag",value:function(t){if(this.type===hr.TAG){if(this.symbols.get(0)!==fe.ANTISLASH)return!1;for(var e=1;e<this.symbols.size;++e){var n=this.symbols.get(e),r=t.codePointAt(e-1);if(n>=65&&n<=90&&(n+=32),r>=65&&r<=90&&(r+=32),n!==r)return!1}return!0}return!1}},{key:"copy",value:function(t){this.index=t.index,this.type=t.type,this.origin.copy(t.origin),this.symbols.copy(t.symbols)}},{key:"clone",value:function(){var e=new t(this.symbols.capacity);return e.copy(this),e}},{key:"clear",value:function(){this.index=0,this.type=hr.DEFAULT_TYPE,this.symbols.clear(),this.origin.clear()}},{key:"toString",value:function(){var t="";return t+="unidoc token ",t+=this.index.toString().padEnd(5),t+=" #",t+=this.type.toString().padEnd(2),t+=" (",t+=(hr.toString(this.type)||"undefined").padEnd(10),t+=') "',t+=this.debugText,t+='" ',t+=this.origin.toString()}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.index===this.index&&e.type===this.type&&e.origin.equals(this.origin)&&e.symbols.equals(this.symbols))}},{key:"text",get:function(){return String.fromCodePoint.apply(String,yr(this.symbols))},set:function(t){this.symbols.clear();for(var e=0;e<t.length;++e)this.symbols.push(t.codePointAt(e))}},{key:"debugText",get:function(){var t,e=[],n=function(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=vr(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}(this.symbols);try{for(n.s();!(t=n.n()).done;){var r=t.value;switch(r){case fe.NEW_LINE:e.push(fe.COLON),e.push(fe.n);break;case fe.CARRIAGE_RETURN:e.push(fe.COLON),e.push(fe.r);break;case fe.TABULATION:e.push(fe.COLON),e.push(fe.t);break;case fe.SPACE:e.push(fe.COLON),e.push(fe.s);break;case fe.FORM_FEED:e.push(fe.COLON),e.push(fe.f);break;default:e.push(r)}}}catch(i){n.e(i)}finally{n.f()}return String.fromCodePoint.apply(String,e)}}])&&mr(e.prototype,n),r&&mr(e,r),t}();function gr(t){return(gr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tr(t,e,n){return(Tr="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wr(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function kr(t,e){return(kr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Sr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wr(t);if(e){var i=wr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ar(this,n)}}function Ar(t,e){return!e||"object"!==gr(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wr(t){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;return new t(e)}t.create=e,t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Duplicator.fromFactory(e)}(Er||(Er={}));var Or,Ir=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kr(t,e)}(o,t);var e,n,r,i=Sr(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._token=new Er,t._token.origin.from.runtime(),t._token.origin.to.runtime(),t._index=0,t}return e=o,(n=[{key:"initialize",value:function(){Tr(wr(o.prototype),"initialize",this).call(this)}},{key:"initializeIfFirst",value:function(){0===this._index&&this.initialize()}},{key:"fail",value:function(t){Tr(wr(o.prototype),"fail",this).call(this,t)}},{key:"at",value:function(t){return this._token.origin.from.copy(t),this._token.origin.to.copy(t),this}},{key:"from",value:function(t){return t?(this._token.origin.from.copy(t),this):(this._token.origin.from.clear(),this._token.origin.from)}},{key:"to",value:function(t){return t?(this._token.origin.to.copy(t),this):(this._token.origin.to.clear(),this._token.origin.to)}},{key:"withSymbols",value:function(t){return this._token.symbols.copy(t),this}},{key:"withType",value:function(t){return this._token.type=t,this}},{key:"produceIdentifier",value:function(t){return this._token.asIdentifier(t),this.produce(this._token),this}},{key:"produceClass",value:function(t){return this._token.asClass(t),this.produce(this._token),this}},{key:"produceTag",value:function(t){return this._token.asTag(t),this.produce(this._token),this}},{key:"produceBlockStart",value:function(){return this._token.asBlockStart(),this.produce(this._token),this}},{key:"produceBlockEnd",value:function(){return this._token.asBlockEnd(),this.produce(this._token),this}},{key:"produceSpace",value:function(t){return this._token.asSpace(t),this.produce(this._token),this}},{key:"produceNewline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\r\n";return this._token.asNewline(t),this.produce(this._token),this}},{key:"produceWord",value:function(t){return this._token.asWord(t),this.produce(this._token),this}},{key:"produce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._token;t.index=this._index,this._index+=1,Tr(wr(o.prototype),"produce",this).call(this,t)}},{key:"clear",value:function(){this._index=0,this._token.clear(),this.removeAllEventListener()}},{key:"complete",value:function(){Tr(wr(o.prototype),"complete",this).call(this)}}])&&_r(e.prototype,n),r&&_r(e,r),o}(Wt);function Rr(t){return(Rr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xr(t,e){return(xr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Dr(t);if(e){var i=Dr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Lr(this,n)}}function Lr(t,e){return!e||"object"!==Rr(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dr(t){return(Dr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(){return new t}}(Ir||(Ir={})),function(t){function e(e){switch(e){case t.START:return"START";case t.ANTISLASH:return"ANTISLASH";case t.SHARP:return"SHARP";case t.IDENTIFIER:return"IDENTIFIER";case t.DOT:return"DOT";case t.CLASS:return"CLASS";case t.TAG:return"TAG";case t.SPACE:return"SPACE";case t.CARRIAGE_RETURN:return"CARRIAGE_RETURN";case t.WORD:return"WORD";case t.END:return"END";default:return}}t.START=0,t.ANTISLASH=1,t.SHARP=2,t.IDENTIFIER=3,t.DOT=4,t.CLASS=5,t.TAG=6,t.SPACE=7,t.CARRIAGE_RETURN=8,t.WORD=9,t.END=10,t.ALL=[t.START,t.ANTISLASH,t.SHARP,t.IDENTIFIER,t.DOT,t.CLASS,t.TAG,t.SPACE,t.CARRIAGE_RETURN,t.WORD,t.END],t.DEFAULT=t.START,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(Or||(Or={}));var Ur,jr=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xr(t,e)}(o,t);var e,n,r,i=Pr(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64;return Nr(this,o),(t=i.call(this))._state=Or.START,t._symbols=new pr(e),t._producer=new Ir,t}return e=o,(n=[{key:"handleInitialization",value:function(){}},{key:"handleProduction",value:function(t){this.next(t)}},{key:"handleCompletion",value:function(){this.complete()}},{key:"handleFailure",value:function(t){this._producer.fail(t)}},{key:"next",value:function(t){switch(this._state){case Or.SPACE:this.handleAfterSpace(t);break;case Or.CARRIAGE_RETURN:this.handleAfterCarriageReturn(t);break;case Or.SHARP:this.handleAfterSharp(t);break;case Or.IDENTIFIER:this.handleAfterIdentifier(t);break;case Or.DOT:this.handleAfterDot(t);break;case Or.CLASS:this.handleAfterClass(t);break;case Or.ANTISLASH:this.handleAfterAntislash(t);break;case Or.TAG:this.handleAfterTag(t);break;case Or.WORD:this.handleAfterWord(t);break;default:this.handleAfterStart(t)}}},{key:"complete",value:function(){switch(this._state){case Or.END:break;case Or.SHARP:case Or.DOT:case Or.ANTISLASH:this.emitBuffer(hr.WORD);break;case Or.SPACE:this.emitBuffer(hr.SPACE);break;case Or.CARRIAGE_RETURN:this.emitBuffer(hr.NEW_LINE);break;case Or.TAG:this.emitBuffer(hr.TAG);break;case Or.WORD:this.emitBuffer(hr.WORD);break;case Or.IDENTIFIER:this.emitBuffer(hr.IDENTIFIER);break;case Or.CLASS:this.emitBuffer(hr.CLASS);break;case Or.START:}this._state=Or.END,this._producer.complete()}},{key:"handleAfterAntislash",value:function(t){var e=t.symbol;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS||e===fe.DOUBLE_DOT)this._symbols.bufferize(t),this._state=Or.TAG;else switch(e){case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:this.emitBuffer(hr.WORD),this._state=Or.START,this.handleAfterStart(t);break;default:this._symbols.bufferize(t),this._state=Or.WORD}}},{key:"handleAfterTag",value:function(t){var e=t.symbol;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS)this._symbols.bufferize(t);else switch(e){case fe.TABULATION:case fe.ANTISLASH:case fe.SPACE:case fe.FORM_FEED:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:case fe.DOT:case fe.SHARP:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emitBuffer(hr.TAG),this._state=Or.START,this.handleAfterStart(t);break;default:this._symbols.bufferize(t),this._state=Or.WORD}}},{key:"handleAfterWord",value:function(t){switch(t.symbol){case fe.TABULATION:case fe.SPACE:case fe.FORM_FEED:case fe.NEW_LINE:case fe.ANTISLASH:case fe.CARRIAGE_RETURN:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emitBuffer(hr.WORD),this._state=Or.START,this.handleAfterStart(t);break;default:this._symbols.bufferize(t)}}},{key:"handleAfterCarriageReturn",value:function(t){switch(t.symbol){case fe.NEW_LINE:this._symbols.bufferize(t),this.emitBuffer(hr.NEW_LINE),this._state=Or.START;break;default:this.emitBuffer(hr.NEW_LINE),this._state=Or.START,this.handleAfterStart(t)}}},{key:"handleAfterSpace",value:function(t){switch(t.symbol){case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:this._symbols.bufferize(t);break;default:this.emitBuffer(hr.SPACE),this._state=Or.START,this.handleAfterStart(t)}}},{key:"handleAfterDot",value:function(t){var e=t.symbol;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS)this._symbols.bufferize(t),this._state=Or.CLASS;else switch(e){case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emitBuffer(hr.WORD),this._state=Or.START,this.handleAfterStart(t);break;default:this._symbols.bufferize(t),this._state=Or.WORD}}},{key:"handleAfterClass",value:function(t){var e=t.symbol;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS)this._symbols.bufferize(t);else switch(e){case fe.TABULATION:case fe.ANTISLASH:case fe.SPACE:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:case fe.DOT:case fe.SHARP:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emitBuffer(hr.CLASS),this._state=Or.START,this.handleAfterStart(t);break;default:this._symbols.bufferize(t),this._state=Or.WORD}}},{key:"handleAfterSharp",value:function(t){var e=t.symbol;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS)this._symbols.bufferize(t),this._state=Or.IDENTIFIER;else switch(e){case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emitBuffer(hr.WORD),this._state=Or.START,this.handleAfterStart(t);break;default:this._symbols.bufferize(t),this._state=Or.WORD}}},{key:"handleAfterIdentifier",value:function(t){var e=t.symbol;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS)this._symbols.bufferize(t);else switch(e){case fe.TABULATION:case fe.ANTISLASH:case fe.SPACE:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:case fe.DOT:case fe.SHARP:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emitBuffer(hr.IDENTIFIER),this._state=Or.START,this.handleAfterStart(t);break;default:this._symbols.bufferize(t),this._state=Or.WORD}}},{key:"handleAfterStart",value:function(t){switch(t.symbol){case fe.OPENING_BRACE:this._symbols.bufferize(t),this.emitBuffer(hr.BLOCK_START);break;case fe.CLOSING_BRACE:this._symbols.bufferize(t),this.emitBuffer(hr.BLOCK_END);break;case fe.ANTISLASH:this._symbols.bufferize(t),this._state=Or.ANTISLASH;break;case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:this._state=Or.SPACE,this.next(t);break;case fe.NEW_LINE:this._symbols.bufferize(t),this.emitBuffer(hr.NEW_LINE);break;case fe.CARRIAGE_RETURN:this._symbols.bufferize(t),this._state=Or.CARRIAGE_RETURN;break;case fe.SHARP:this._symbols.bufferize(t),this._state=Or.SHARP;break;case fe.DOT:this._symbols.bufferize(t),this._state=Or.DOT;break;default:this._symbols.bufferize(t),this._state=Or.WORD}}},{key:"emitBuffer",value:function(t){this._producer.initializeIfFirst(),this._producer.from(this._symbols.from).to(this._symbols.to).withType(t).withSymbols(this._symbols.symbols),this._symbols.clear(),this._producer.produce()}},{key:"addEventListener",value:function(t,e){this._producer.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this._producer.removeEventListener(t,e)}},{key:"removeAllEventListener",value:function(){var t;(t=this._producer).removeAllEventListener.apply(t,arguments)}},{key:"clear",value:function(){this._producer.clear(),this._state=Or.START,this._symbols.clear(),this.removeAllEventListener()}},{key:"state",get:function(){return this._state}}])&&Cr(e.prototype,n),r&&Cr(e,r),o}(dt);function Wr(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Mr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mr(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.START=0,t.LEADING_WHITESPACE=1,t.CLASS_OF_STREAM_WITHOUT_IDENTIFIER=2,t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER=3,t.CLASS_OF_STREAM_WITH_IDENTIFIER=4,t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER=5,t.STREAM_CONTENT=6,t.BLOCK_CONTENT=7,t.ERROR=8,t.WHITESPACE=9,t.WORD=10,t.CLASS_OF_TAG_WITHOUT_IDENTIFIER=11,t.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER=12,t.CLASS_OF_TAG_WITH_IDENTIFIER=13,t.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER=14,t.TERMINATION=15,t.DEFAULT=t.START,t.ALL=[t.START,t.LEADING_WHITESPACE,t.CLASS_OF_STREAM_WITHOUT_IDENTIFIER,t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER,t.CLASS_OF_STREAM_WITH_IDENTIFIER,t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER,t.STREAM_CONTENT,t.BLOCK_CONTENT,t.ERROR,t.WHITESPACE,t.WORD,t.CLASS_OF_TAG_WITHOUT_IDENTIFIER,t.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER,t.CLASS_OF_TAG_WITH_IDENTIFIER,t.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER,t.TERMINATION],t.toString=function(e){switch(e){case t.START:return"START";case t.LEADING_WHITESPACE:return"LEADING_WHITESPACE";case t.CLASS_OF_STREAM_WITHOUT_IDENTIFIER:return"CLASS_OF_STREAM_WITHOUT_IDENTIFIER";case t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER:return"WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER";case t.CLASS_OF_STREAM_WITH_IDENTIFIER:return"CLASS_OF_STREAM_WITH_IDENTIFIER";case t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER:return"WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER";case t.STREAM_CONTENT:return"STREAM_CONTENT";case t.BLOCK_CONTENT:return"BLOCK_CONTENT";case t.ERROR:return"ERROR";case t.WHITESPACE:return"WHITESPACE";case t.WORD:return"WORD";case t.CLASS_OF_TAG_WITHOUT_IDENTIFIER:return"CLASS_OF_TAG_WITHOUT_IDENTIFIER";case t.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER:return"WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER";case t.CLASS_OF_TAG_WITH_IDENTIFIER:return"CLASS_OF_TAG_WITH_IDENTIFIER";case t.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER:return"WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER";case t.TERMINATION:return"TERMINATION";default:return}}}(Ur||(Ur={}));var Gr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=Ur.START,this.tag="",this.identifier="",this.content=U.Pack.uint32(128),this.classes=new Set,this.origin=new Me,this.origin.from.text(0,0,0).runtime(),this.origin.to.text(0,0,0).runtime()}var e,n,r;return e=t,(n=[{key:"begin",value:function(t,e){if(this.clear(),this.type=t,e instanceof Er){switch(e.type){case hr.CLASS:this.classes.add(e.substring(1));break;case hr.IDENTIFIER:this.identifier=e.substring(1);break;case hr.TAG:this.tag=e.substring(1);break;case hr.NEW_LINE:case hr.SPACE:case hr.WORD:this.content.concat(e.symbols)}this.origin.copy(e.origin)}else this.origin.at(e)}},{key:"append",value:function(t){switch(t.type){case hr.CLASS:this.classes.add(t.substring(1));break;case hr.IDENTIFIER:this.identifier=t.substring(1);break;case hr.TAG:this.tag=t.substring(1);break;case hr.NEW_LINE:case hr.SPACE:case hr.WORD:this.content.concat(t.symbols)}this.origin.to.copy(t.origin.to)}},{key:"clear",value:function(){this.type=Ur.START,this.tag="",this.identifier="",this.content.clear(),this.classes.clear(),this.origin.clear(),this.origin.from.text(0,0,0).runtime(),this.origin.to.text(0,0,0).runtime()}},{key:"copy",value:function(t){this.type=t.type,this.tag=t.tag,this.identifier=t.identifier,this.content.copy(t.content),this.origin.copy(t.origin),this.classes.clear();var e,n=Wr(t.classes);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.classes.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.type!==this.type||e.tag!==this.tag||e.identifier!==this.identifier||!e.content.equals(this.content)||!e.origin.equals(this.origin)||e.classes.size!==this.classes.size)return!1;var n,r=Wr(e.classes);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!this.classes.has(i))return!1}}catch(o){r.e(o)}finally{r.f()}return!0}return!1}}])&&Fr(e.prototype,n),r&&Fr(e,r),t}();function zr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Br(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.create=e,t.ALLOCATOR=U.Duplicator.fromFactory(e)}(Gr||(Gr={}));var Hr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;zr(this,t),this._states=U.Pack.instance(Gr.ALLOCATOR,e),this.states=this._states.view()}var e,n,r;return e=t,(n=[{key:"reallocate",value:function(t){this._states.reallocate(t)}},{key:"get",value:function(t){return this.states.get(t)}},{key:"push",value:function(t){this._states.size+=1,this._states.last.type=t}},{key:"delete",value:function(t){this._states.delete(t)}},{key:"pop",value:function(){this._states.pop()}},{key:"clear",value:function(){this._states.clear()}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e._states.size!==this._states.size)return!1;for(var n=0,r=this._states.size;n<r;++n)if(!e._states.get(n).equals(this._states.get(n)))return!1;return!0}return!1}},{key:"first",get:function(){return this._states.first}},{key:"last",get:function(){return this._states.last}},{key:"capacity",get:function(){return this._states.capacity}},{key:"size",get:function(){return this._states.size},set:function(t){this._states.size=t}}])&&Br(e.prototype,n),r&&Br(e,r),t}();function Vr(t){return(Vr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kr(t,e){return(Kr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Xr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=$r(t);if(e){var i=$r(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Zr(this,n)}}function Zr(t,e){return!e||"object"!==Vr(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $r(t){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Jr,Qr="document",ti="block",ei=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kr(t,e)}(o,t);var e,n,r,i=Xr(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;return qr(this,o),(t=i.call(this))._states=new Hr(e),t._producer=new sr,t._states.push(Ur.START),t}return e=o,(n=[{key:"handleInitialization",value:function(){}},{key:"handleProduction",value:function(t){this.next(t)}},{key:"handleCompletion",value:function(){this.complete()}},{key:"handleFailure",value:function(t){this._producer.fail(t)}},{key:"next",value:function(t){switch(this._states.last.type){case Ur.START:this.handleAfterStart(t);break;case Ur.STREAM_CONTENT:this.handleAfterStreamContent(t);break;case Ur.BLOCK_CONTENT:this.handleAfterBlockContent(t);break;case Ur.WHITESPACE:this.handleAfterWhitespace(t);break;case Ur.WORD:this.handleAfterWord(t);break;case Ur.CLASS_OF_TAG_WITHOUT_IDENTIFIER:this.handleAfterClassOfTagWithoutIdentifier(t);break;case Ur.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER:this.handleAfterWhitespaceAfterClassOfTagWithoutIdentifier(t);break;case Ur.CLASS_OF_TAG_WITH_IDENTIFIER:this.handleAfterClassOfTagWithIdentifier(t);break;case Ur.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER:this.handleAfterWhitespaceAfterClassOfTagWithIdentifier(t);break;case Ur.ERROR:this.handleAfterError(t);break;case Ur.LEADING_WHITESPACE:this.handleAfterLeadingWhitespace(t);break;case Ur.CLASS_OF_STREAM_WITHOUT_IDENTIFIER:this.handleAfterClassOfStreamWithoutIdentifier(t);break;case Ur.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER:this.handleAfterWhitespaceAfterClassOfStreamWithoutIdentifier(t);break;case Ur.CLASS_OF_STREAM_WITH_IDENTIFIER:this.handleAfterClassOfStreamWithIdentifier(t);break;case Ur.WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER:this.handleAfterWhitespaceAfterClassOfStreamWithIdentifier(t);break;default:this.throwUhandledParserState(t)}}},{key:"throwUhandledParserState",value:function(t){throw new Error("Unable to handle token of type #"+t.type+' "'+hr.toString(t.type)+'" because this parser does not define an execution process when it has to handle a token when it is in #'+this._states.last.type+' "'+Ur.toString(this._states.last.type)+'" state')}},{key:"complete",value:function(){switch(this._states.last.type){case Ur.START:this.emitVirtualDocumentStart(),this.emitVirtualDocumentEnd(),this._states.last.type=Ur.TERMINATION,this.complete();break;case Ur.STREAM_CONTENT:case Ur.BLOCK_CONTENT:this.emitTagEnd(),this._states.last.type=Ur.TERMINATION,this._states.last.origin.at(this._states.last.origin.to),this.complete();break;case Ur.WHITESPACE:this.emitWhitespaceEvent(),this._states.get(this._states.size-2).origin.at(this._states.last.origin.to),this._states.pop(),this.complete();break;case Ur.WORD:this.emitWordEvent(),this._states.get(this._states.size-2).origin.at(this._states.last.origin.to),this._states.pop(),this.complete();break;case Ur.CLASS_OF_TAG_WITHOUT_IDENTIFIER:case Ur.CLASS_OF_TAG_WITH_IDENTIFIER:this.emitTagStart(),this._states.last.origin.at(this._states.last.origin.to),this.emitTagEnd(),this._states.pop(),this.complete();break;case Ur.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER:case Ur.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER:this.emitTagStart(this._states.get(this._states.size-2)),this._states.get(this._states.size-2).origin.at(this._states.last.origin.from),this.emitTagEnd(this._states.get(this._states.size-2)),this.emitWhitespaceEvent(),this._states.pop(),this._states.pop(),this.complete();break;case Ur.ERROR:this.throwUnhandledCompletionParserState();break;case Ur.LEADING_WHITESPACE:this.emitVirtualDocumentStart(),this.emitWhitespaceEvent(),this.emitVirtualDocumentEnd(),this._states.last.type=Ur.TERMINATION,this._states.last.origin.at(this._states.last.origin.to),this.complete();break;case Ur.CLASS_OF_STREAM_WITHOUT_IDENTIFIER:case Ur.CLASS_OF_STREAM_WITH_IDENTIFIER:this.emitTagStart(),this.emitVirtualDocumentEnd(),this._states.last.type=Ur.TERMINATION,this._states.last.origin.at(this._states.last.origin.to),this.complete();break;case Ur.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER:this.emitTagStart(this._states.get(this._states.size-2)),this._states.get(this._states.size-2).origin.at(this._states.last.origin.from),this.emitWhitespaceEvent(),this._states.pop(),this.emitVirtualDocumentEnd(),this._states.last.type=Ur.TERMINATION,this._states.last.origin.at(this._states.last.origin.to),this.complete();break;case Ur.TERMINATION:return void this._producer.complete();default:this.throwUnhandledCompletionParserState()}}},{key:"throwUnhandledCompletionParserState",value:function(){throw new Error("Unable to handle stream completion because this parser does not define an execution process when it has to handle a completion when it is in #"+this._states.last.type+' "'+Ur.toString(this._states.last.type)+'" state')}},{key:"handleAfterStart",value:function(t){switch(this._states.last.origin.at(t.origin.from),this._states.last.tag=Qr,t.type){case hr.NEW_LINE:case hr.SPACE:return this._states.last.type=Ur.LEADING_WHITESPACE,void this._states.last.append(t);case hr.TAG:case hr.BLOCK_START:case hr.WORD:case hr.IDENTIFIER:case hr.CLASS:return void(t.isTag(Qr)?(this._states.last.type=Ur.CLASS_OF_STREAM_WITHOUT_IDENTIFIER,this._states.last.origin.to.copy(t.origin.to)):(this.emitVirtualDocumentStart(),this._states.last.type=Ur.STREAM_CONTENT,this.next(t)));case hr.BLOCK_END:return this.emitDocumentStartWithBlockEndingError(),void this.recoverFromDocumentStartWithBlockEndingError(t);default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterLeadingWhitespace",value:function(t){switch(t.type){case hr.NEW_LINE:case hr.SPACE:return void this._states.last.append(t);case hr.TAG:case hr.BLOCK_START:case hr.WORD:case hr.IDENTIFIER:case hr.CLASS:return void(t.isTag(Qr)?(this._states.last.type=Ur.CLASS_OF_STREAM_WITHOUT_IDENTIFIER,this._states.last.origin.to.copy(t.origin.to),this._states.last.content.clear()):(this.emitVirtualDocumentStart(),this.emitWhitespaceEvent(),this._states.last.type=Ur.STREAM_CONTENT,this._states.last.origin.at(t.origin.from),this.next(t)));case hr.BLOCK_END:return this.emitDocumentStartWithBlockEndingError(),void this.recoverFromDocumentStartWithBlockEndingError(t);default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterClassOfStreamWithoutIdentifier",value:function(t){switch(t.type){case hr.SPACE:case hr.NEW_LINE:return this._states.push(Ur.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER),this._states.last.origin.at(t.origin.from),void this._states.last.append(t);case hr.IDENTIFIER:return this._states.last.append(t),void(this._states.last.type=Ur.CLASS_OF_STREAM_WITH_IDENTIFIER);case hr.CLASS:return void this._states.last.append(t);case hr.TAG:case hr.WORD:case hr.BLOCK_START:case hr.BLOCK_END:return this.emitTagStart(),this._states.last.type=Ur.STREAM_CONTENT,this._states.last.origin.at(t.origin.from),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterWhitespaceAfterClassOfStreamWithoutIdentifier",value:function(t){switch(t.type){case hr.SPACE:case hr.NEW_LINE:return void this._states.last.append(t);case hr.IDENTIFIER:case hr.CLASS:return this._states.pop(),void this.next(t);case hr.TAG:case hr.WORD:case hr.BLOCK_START:case hr.BLOCK_END:return this.emitTagStart(this._states.get(this._states.size-2)),this.emitWhitespaceEvent(),this._states.pop(),this._states.last.type=Ur.STREAM_CONTENT,this._states.last.origin.at(t.origin.from),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterClassOfStreamWithIdentifier",value:function(t){switch(t.type){case hr.SPACE:case hr.NEW_LINE:return this._states.push(Ur.WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER),this._states.last.origin.at(t.origin.from),void this._states.last.append(t);case hr.CLASS:return void this._states.last.append(t);case hr.TAG:case hr.WORD:case hr.BLOCK_START:case hr.BLOCK_END:case hr.IDENTIFIER:return this.emitTagStart(),this._states.last.type=Ur.STREAM_CONTENT,this._states.last.origin.at(t.origin.from),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterWhitespaceAfterClassOfStreamWithIdentifier",value:function(t){switch(t.type){case hr.SPACE:case hr.NEW_LINE:return void this._states.last.append(t);case hr.CLASS:return this._states.pop(),void this.next(t);case hr.IDENTIFIER:case hr.TAG:case hr.WORD:case hr.BLOCK_START:case hr.BLOCK_END:return this.emitTagStart(this._states.get(0)),this.emitWhitespaceEvent(),this._states.pop(),this._states.last.type=Ur.STREAM_CONTENT,this._states.last.origin.at(t.origin.from),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterStreamContent",value:function(t){switch(t.type){case hr.TAG:case hr.NEW_LINE:case hr.SPACE:case hr.WORD:case hr.IDENTIFIER:case hr.CLASS:case hr.BLOCK_START:return void this.handleAfterContent(t);case hr.BLOCK_END:throw new Error("Trying to terminate a stream of content.");default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterBlockContent",value:function(t){switch(t.type){case hr.TAG:case hr.NEW_LINE:case hr.SPACE:case hr.WORD:case hr.IDENTIFIER:case hr.CLASS:case hr.BLOCK_START:return void this.handleAfterContent(t);case hr.BLOCK_END:this._states.last.append(t),this.emitTagEnd(),this._states.pop(),this._states.last.origin.at(t.origin.to);break;default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterContent",value:function(t){switch(t.type){case hr.TAG:this._states.push(Ur.CLASS_OF_TAG_WITHOUT_IDENTIFIER),this._states.last.origin.at(t.origin.from),this._states.last.append(t);break;case hr.NEW_LINE:case hr.SPACE:this._states.push(Ur.WHITESPACE),this._states.last.origin.at(t.origin.from),this._states.last.append(t);break;case hr.WORD:this._states.push(Ur.WORD),this._states.last.origin.at(t.origin.from),this._states.last.append(t);break;case hr.IDENTIFIER:this._states.push(Ur.CLASS_OF_TAG_WITH_IDENTIFIER),this._states.last.origin.at(t.origin.from),this._states.last.append(t),this._states.last.tag=ti;break;case hr.CLASS:this._states.push(Ur.CLASS_OF_TAG_WITHOUT_IDENTIFIER),this._states.last.origin.at(t.origin.from),this._states.last.append(t),this._states.last.tag=ti;break;case hr.BLOCK_START:this._states.push(Ur.BLOCK_CONTENT),this._states.last.origin.at(t.origin.from),this._states.last.append(t),this._states.last.tag=ti,this.emitTagStart(),this._states.last.origin.from.copy(t.origin.to);break;default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterWhitespace",value:function(t){switch(t.type){case hr.SPACE:case hr.NEW_LINE:return void this._states.last.append(t);default:return this.emitWhitespaceEvent(),this._states.pop(),this._states.last.origin.at(t.origin.from),void this.next(t)}}},{key:"handleAfterWord",value:function(t){switch(t.type){case hr.WORD:return void this._states.last.append(t);default:return this.emitWordEvent(),this._states.pop(),this._states.last.origin.at(t.origin.from),void this.next(t)}}},{key:"handleAfterClassOfTagWithoutIdentifier",value:function(t){switch(t.type){case hr.SPACE:case hr.NEW_LINE:return this._states.push(Ur.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER),this._states.last.origin.at(t.origin.from),void this._states.last.append(t);case hr.IDENTIFIER:return this._states.last.append(t),void(this._states.last.type=Ur.CLASS_OF_TAG_WITH_IDENTIFIER);case hr.CLASS:return void this._states.last.append(t);case hr.TAG:case hr.WORD:case hr.BLOCK_END:return this.emitTagStart(),this._states.last.origin.at(this._states.last.origin.to),this.emitTagEnd(),this._states.pop(),void this.next(t);case hr.BLOCK_START:return this._states.last.append(t),this.emitTagStart(),this._states.last.type=Ur.BLOCK_CONTENT,void this._states.last.origin.at(t.origin.to);default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterWhitespaceAfterClassOfTagWithoutIdentifier",value:function(t){switch(t.type){case hr.SPACE:case hr.NEW_LINE:return void this._states.last.append(t);case hr.IDENTIFIER:case hr.CLASS:case hr.BLOCK_START:return this._states.pop(),this._states.last.origin.to.copy(t.origin.from),void this.next(t);case hr.TAG:case hr.WORD:case hr.BLOCK_END:return this.emitTagStart(this._states.get(this._states.size-2)),this._states.get(this._states.size-2).origin.at(this._states.last.origin.from),this.emitTagEnd(this._states.get(this._states.size-2)),this.emitWhitespaceEvent(),this._states.pop(),this._states.pop(),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterClassOfTagWithIdentifier",value:function(t){switch(t.type){case hr.SPACE:case hr.NEW_LINE:return this._states.push(Ur.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER),this._states.last.origin.at(t.origin.from),void this._states.last.append(t);case hr.CLASS:return void this._states.last.append(t);case hr.TAG:case hr.WORD:case hr.BLOCK_END:case hr.IDENTIFIER:return this.emitTagStart(),this._states.last.origin.at(this._states.last.origin.to),this.emitTagEnd(),this._states.pop(),void this.next(t);case hr.BLOCK_START:return this._states.last.append(t),this.emitTagStart(),this._states.last.type=Ur.BLOCK_CONTENT,void this._states.last.origin.at(t.origin.to);default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterWhitespaceAfterClassOfTagWithIdentifier",value:function(t){switch(t.type){case hr.SPACE:case hr.NEW_LINE:return void this._states.last.append(t);case hr.CLASS:case hr.BLOCK_START:return this._states.pop(),this._states.last.origin.to.copy(t.origin.from),void this.next(t);case hr.IDENTIFIER:case hr.TAG:case hr.WORD:case hr.BLOCK_END:return this.emitTagStart(this._states.get(this._states.size-2)),this._states.get(this._states.size-2).origin.at(this._states.last.origin.from),this.emitTagEnd(this._states.get(this._states.size-2)),this.emitWhitespaceEvent(),this._states.pop(),this._states.pop(),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"handleAfterError",value:function(t){this.throwUnhandledTokenType(t)}},{key:"throwUnhandledTokenType",value:function(t){throw new Error("The token type #"+t.type+' "'+hr.toString(t.type)+'" is currently not handled by this parser when it is in state #'+this._states.last.type+' "'+Ur.toString(this._states.last.type)+'".')}},{key:"recoverFromDocumentStartWithBlockEndingError",value:function(t){this._states.last.origin.from.copy(t.origin.to)}},{key:"emitDocumentStartWithBlockEndingError",value:function(){}},{key:"emitVirtualDocumentStart",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._producer.initialize(),this._producer.event().at(t.origin.from).withType(S.START_TAG).withTag(Qr).produce()}},{key:"emitVirtualDocumentEnd",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._producer.event().at(t.origin.to).withType(S.END_TAG).withTag(Qr).produce()}},{key:"emitTagStart",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._producer.event().from(t.origin.from).to(t.origin.to).withType(S.START_TAG).withClasses(t.classes).withIdentifier(t.identifier).withTag(t.tag).produce()}},{key:"emitTagEnd",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._producer.event().from(t.origin.from).to(t.origin.to).withType(S.END_TAG).withClasses(t.classes).withIdentifier(t.identifier).withTag(t.tag).produce()}},{key:"emitWhitespaceEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._producer.event().from(t.origin.from).to(t.origin.to).withType(S.WHITESPACE).withSymbols(t.content).produce()}},{key:"emitWordEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._producer.event().from(t.origin.from).to(t.origin.to).withType(S.WORD).withSymbols(t.content).produce()}},{key:"clear",value:function(){this._states.clear(),this.removeAllEventListener(),this._states.push(Ur.START),this._producer.clear()}},{key:"addEventListener",value:function(t,e){this._producer.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this._producer.removeEventListener(t,e)}},{key:"removeAllEventListener",value:function(){var t;(t=this._producer).removeAllEventListener.apply(t,arguments)}}])&&Yr(e.prototype,n),r&&Yr(e,r),o}(dt);function ni(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return ri(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ri(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function ri(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ii(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.TAG=0,t.SYMBOL=1,t.STREAM=2,t.FILE=3,t.MEMORY=4,t.ALL=[t.TAG,t.SYMBOL,t.STREAM,t.FILE,t.MEMORY],t.toString=function(e){switch(e){case t.TAG:return"TAG";case t.SYMBOL:return"SYMBOL";case t.STREAM:return"STREAM";case t.FILE:return"FILE";case t.MEMORY:return"MEMORY";default:return}}}(Jr||(Jr={}));var oi=/^([a-zA-Z0-9\-]+)(#[a-zA-Z0-9\-]+)?(\.[a-zA-Z0-9\-]+)*$/i,ai=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=Jr.SYMBOL,this.from=new we,this.to=new we,this.name="",this.identifier="",this.classes=new Set}var e,n,r;return e=t,(n=[{key:"asFile",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.clear(),this.type=Jr.FILE,this.name=t,this.from.copy(e),this.to.copy(n)}},{key:"asStream",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this.clear(),this.type=Jr.STREAM,this.from.copy(t),this.to.copy(e)}},{key:"asMemory",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.clear(),this.type=Jr.MEMORY,this.name=t,this.from.copy(e),this.to.copy(n)}},{key:"asSymbol",value:function(t){this.clear(),this.type=Jr.SYMBOL,this.from.copy(t),this.to.copy(t)}},{key:"asTag",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.clear(),this.type=Jr.TAG,this.from.copy(t),this.to.copy(e);var r=oi.exec(n);if(null!=r)for(var i=1;i<r.length;++i){var o=r[i];o.startsWith("#")?this.identifier=o.substring(1):o.startsWith(".")?this.classes.add(o.substring(1)):this.name=o}}},{key:"addClasses",value:function(t){var e,n=ni(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.classes.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"copy",value:function(t){this.type=t.type,this.from.copy(t.from),this.to.copy(t.to),this.name=t.name,this.identifier=t.identifier,this.classes.clear();var e,n=ni(t.classes);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.classes.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.type=Jr.SYMBOL,this.from.clear(),this.to.clear(),this.name="",this.identifier="",this.classes.clear()}},{key:"toString",value:function(){var t="";this.type===Jr.SYMBOL&&(t+="symbol"),this.type===Jr.STREAM&&(t+="stream"),this.type===Jr.MEMORY&&(t+="memory:\\\\"),this.type===Jr.FILE&&(t+="file:\\\\"),this.name.length>0&&(this.type===Jr.TAG&&(t+="\\"),t+=this.name),this.identifier.length>0&&(t+="#",t+=this.identifier);var e,n=ni(this.classes);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=".",t+=r}}catch(i){n.e(i)}finally{n.f()}return this.from.isUnknown()||this.to.isUnknown()?this.from.isUnknown()?this.to.isUnknown()||(t+=" until "+this.to.toString()):t+=" from "+this.from.toString():this.from.equals(this.to)?t+=" at "+this.from.toString():t+=" between "+this.from.toString()+" and "+this.to.toString(),t}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.type!==this.type||e.classes.size!==this.classes.size||e.identifier!==this.identifier||e.name!==this.name||!e.from.equals(this.from)||!e.to.equals(this.to))return!1;var n,r=ni(e.classes);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!this.classes.has(i))return!1}}catch(o){r.e(o)}finally{r.f()}return!0}return!1}}])&&ii(e.prototype,n),r&&ii(e,r),t}();function ui(t,e,n){return(ui=si()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&ci(i,n.prototype),i}).apply(null,arguments)}function si(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ci(t,e){return(ci=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function li(t){return function(t){if(Array.isArray(t))return pi(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||hi(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fi(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=hi(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function hi(t,e){if(t){if("string"===typeof t)return pi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pi(t,e):void 0}}function pi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function yi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.create=e,t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Duplicator.fromFactory(e)}(ai||(ai={}));var di=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;yi(this,t),this._elements=U.Pack.instance(ai.ALLOCATOR,e),this.elements=this._elements.view()}var e,n,r;return e=t,(n=[{key:"push",value:function(t){return this._elements.push(t),this}},{key:"pushSymbol",value:function(t){return this._elements.size+=1,this._elements.last.asSymbol(t),this}},{key:"pushTag",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._elements.size+=1,this._elements.last.asTag(t,e,n),this}},{key:"pushStream",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._elements.size+=1,this._elements.last.asStream(t,e),this}},{key:"pushMemory",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return this._elements.size+=1,this._elements.last.asMemory(t,e,n),this}},{key:"pushFile",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return this._elements.size+=1,this._elements.last.asFile(t,e,n),this}},{key:"snapToEnd",value:function(){var t,e=fi(this._elements);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.from.copy(n.to)}}catch(r){e.e(r)}finally{e.f()}return this}},{key:"snapToStart",value:function(){var t,e=fi(this._elements);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.to.copy(n.from)}}catch(r){e.e(r)}finally{e.f()}return this}},{key:"set",value:function(t,e){this._elements.set(t,e)}},{key:"setSymbol",value:function(t,e){this._elements.get(t).asSymbol(e)}},{key:"setTag",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this._elements.get(t).asTag(e,n,r)}},{key:"concat",value:function(t){var e,n=fi(t._elements);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._elements.push(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._elements.deleteMany(t,e)}},{key:"pop",value:function(){this._elements.pop()}},{key:"keep",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._elements.size=t+e,this._elements.deleteMany(0,t)}},{key:"clone",value:function(){var e=new t(this.size);return e.copy(this),e}},{key:"copy",value:function(t){this._elements.size=0;var e,n=fi(t._elements);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._elements.push(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"clear",value:function(){this._elements.clear()}},{key:"toString",value:function(){var t,e="",n=fi(this.elements);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.length>0&&(e+=" > "),e+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return e}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e._elements.size!==this._elements.size)return!1;for(var n=0,r=e.size;n<r;++n)if(!this._elements.get(n).equals(e._elements.get(n)))return!1;return!0}return!1}},{key:Symbol.iterator,value:ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(this._elements,"t0",1);case 1:case"end":return t.stop()}}),t,this)}))},{key:"capacity",get:function(){return this._elements.capacity}},{key:"size",get:function(){return this._elements.size},set:function(t){this._elements.size=t}},{key:"last",get:function(){return this._elements.last}},{key:"first",get:function(){return this._elements.first}}])&&vi(e.prototype,n),r&&vi(e,r),t}();function bi(t){return(bi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ei(t,e,n){return(Ei="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Si(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function gi(t,e){return(gi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _i(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Si(t);if(e){var i=Si(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ti(this,n)}}function Ti(t,e){return!e||"object"!==bi(e)&&"function"!==typeof e?ki(t):e}function ki(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Si(t){return(Si=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.Element=ai,t.EMPTY=new t(0),t.create=function(e){return new t(e)},t.memory=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;return t.create(1).pushMemory(e,n instanceof we?n:ui(we,li(n)),r instanceof we?r:ui(we,li(r)))},t.copy=function(t){return null==t?t:t.clone()}}(di||(di={}));var Ai=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gi(t,e)}(o,t);var e,n,r,i=_i(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this))._observable=t,e._first=!0,e.produce=e.produce.bind(ki(e)),e.fail=e.fail.bind(ki(e)),e.complete=e.complete.bind(ki(e)),e._subscription=e._observable.subscribe(e.produce,e.fail,e.complete),e}return e=o,(n=[{key:"produce",value:function(t){this._first&&(this.initialize(),this._first=!1),Ei(Si(o.prototype),"produce",this).call(this,t)}},{key:"unsubscribe",value:function(){this._subscription&&(this._subscription.unsubscribe(),this._subscription=null)}},{key:"subscribe",value:function(){null==this._subscription&&(this._subscription=this._observable.subscribe(this.produce,this.fail,this.complete))}}])&&mi(e.prototype,n),r&&mi(e,r),o}(Wt);function wi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Oi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.symbol=0,this.origin=new Me(4).runtime()}var e,n,r;return e=t,(n=[{key:"setSymbol",value:function(t){return this.symbol=t,this}},{key:"setOrigin",value:function(t){return this.origin.copy(t),this}},{key:"copy",value:function(t){this.symbol=t.symbol,this.origin.copy(t.origin)}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.symbol=0,this.origin.clear(),this.origin.runtime()}},{key:"toString",value:function(){var t="symbol(";return t+=fe.toDebugString(this.symbol),t+=") ",t+=this.origin.toString()}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.symbol===this.symbol&&e.origin.equals(this.origin))}}])&&wi(e.prototype,n),r&&wi(e,r),t}();function Ii(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ri(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Me.runtime();return(new t).setSymbol(e).setOrigin(n)}t.equals=function(t,e){return null==t?t===e:t.equals(e)},t.create=e,t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Duplicator.fromFactory(e)}(Oi||(Oi={}));var Ni=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pe.runtime();Ii(this,t),this.source=e,this.origin=new Pe,this.origin.copy(n),this._location=new tr,this._symbol=new Oi}var e,n,r;return e=t,(n=[{key:"hasNext",value:function(){return this._location.location.index<this.source.length}},{key:"skip",value:function(t){for(;this.hasNext()&&t>0;)this.next(),t-=1;return this}},{key:"current",value:function(){if(0===this._location.location.index)throw new Error("No current symbol.");return this._symbol}},{key:"next",value:function(){var t=this.source.codePointAt(this._location.location.index);if(null==t)throw new Error("Unable to read the next available code point at "+this._location.toString()+' from the underlying source : "'+this.source+'" in memory.');return this._symbol.symbol=t,this._symbol.origin.clear(),this._symbol.origin.from.text(this._location.location).concat(this.origin),this._location.next(t),this._symbol.origin.to.text(this._location.location).concat(this.origin),this._symbol}},{key:"location",value:function(){return this._location.location}},{key:Symbol.iterator,value:ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.hasNext()){t.next=5;break}return t.next=3,this.next();case 3:t.next=0;break;case 5:case"end":return t.stop()}}),t,this)}))}])&&Ri(e.prototype,n),r&&Ri(e,r),t}();function Ci(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._location=new we(0,0,0)}var e,n,r;return e=t,(n=[{key:"hasNext",value:function(){return!1}},{key:"skip",value:function(t){return this}},{key:"current",value:function(){throw new Error("No current symbol.")}},{key:"next",value:function(){throw new Error("There is no code point to read in a null reader.")}},{key:"location",value:function(){return this._location}},{key:Symbol.iterator,value:ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))}])&&Ci(e.prototype,n),r&&Ci(e,r),t}();function Pi(t){return(Pi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Di(t,e){return(Di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ui(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Wi(t);if(e){var i=Wi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ji(this,n)}}function ji(t,e){return!e||"object"!==Pi(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wi(t){return(Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.INSTANCE=new t}(xi||(xi={}));var Mi,Fi=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Di(t,e)}(o,t);var e,n,r,i=Ui(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this))._reader=t,e}return e=o,(n=[{key:"read",value:function(t){if(null==t){for(;this._reader.hasNext();)this.produce(this._reader.next());this.complete()}else{for(;this._reader.hasNext()&&t>0;)this.produce(this._reader.next()),t-=1;this._reader.hasNext()||this.complete()}}},{key:"readWithoutCompletion",value:function(t){if(null==t)for(;this._reader.hasNext();)this.produce(this._reader.next());else for(;this._reader.hasNext()&&t>0;)this.produce(this._reader.next()),t-=1}}])&&Li(e.prototype,n),r&&Li(e,r),o}(Wt);function Gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.fromNothing=function(){return xi.INSTANCE},t.fromString=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pe.runtime();return new Ni(t,e)},t.produceString=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pe.runtime();return new Fi(new Ni(t,e))},t.asProducer=function(t){return new Fi(t)}}(Mi||(Mi={}));var zi=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{s(r.next(t))}catch(e){o(e)}}function u(t){try{s(r.throw(t))}catch(e){o(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Bi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"resolve",value:function(t){return zi(this,void 0,void 0,ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("UnidocImportationResolver#resolve was not implemented.");case 1:case"end":return t.stop()}}),t)})))}}])&&Gi(e.prototype,n),r&&Gi(e,r),t}();function Hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Vi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.origin=new Me(8),this.resource=""}var e,n,r;return e=t,(n=[{key:"copy",value:function(t){this.origin.copy(t.origin),this.resource=t.resource}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.origin.clear(),this.resource=""}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.origin.equals(this.origin)&&e.resource===this.resource)}}])&&Hi(e.prototype,n),r&&Hi(e,r),t}();function qi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.copy=function(t){return null==t?t:t.clone()},t.equals=function(t,e){return null==t?t==e:t.equals(e)},t.create=e,t.ALLOCATOR=U.Duplicator.fromFactory(e)}(Vi||(Vi={}));var Yi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.origin=new Vi,this.resource="",this.reader=Mi.fromNothing()}var e,n,r;return e=t,(n=[{key:"copy",value:function(t){this.origin.copy(t.origin),this.resource=t.resource,this.reader=t.reader}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.origin.clear(),this.resource="",this.reader=Mi.fromNothing()}}])&&qi(e.prototype,n),r&&qi(e,r),t}();function Ki(t){return(Ki="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zi(t,e){return(Zi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $i(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Qi(t);if(e){var i=Qi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ji(this,n)}}function Ji(t,e){return!e||"object"!==Ki(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qi(t){return(Qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var to=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{s(r.next(t))}catch(e){o(e)}}function u(t){try{s(r.throw(t))}catch(e){o(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},eo=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zi(t,e)}(o,t);var e,n,r,i=$i(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._fragments=new Map,t}return e=o,(n=[{key:"set",value:function(t,e){this._fragments.set(t,e)}},{key:"resolve",value:function(t){return to(this,void 0,void 0,ve().mark((function e(){var n,r;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this._fragments.get(t.resource))){e.next=5;break}throw new Error("Unable to resolve fragment : "+t.resource+" because there is no fragment registered with the given name.");case 5:return(r=new Yi).resource="fragment://"+t.resource,r.reader=Mi.fromString(n,(new Pe).resource("fragment://"+t.resource)),r.origin.copy(t),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})))}}])&&Xi(e.prototype,n),r&&Xi(e,r),o}(Bi);function no(t){return(no="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ro(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function io(t,e,n){return(io="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=so(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function oo(t,e){return(oo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ao(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=so(t);if(e){var i=so(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return uo(this,n)}}function uo(t,e){return!e||"object"!==no(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function so(t){return(so=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var co,lo=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oo(t,e)}(o,t);var e,n,r,i=ao(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._importation=new Vi,t}return e=o,(n=[{key:"fail",value:function(t){io(so(o.prototype),"fail",this).call(this,t)}},{key:"initialize",value:function(){io(so(o.prototype),"initialize",this).call(this)}},{key:"ofResource",value:function(t){return this._importation.resource=t,this}},{key:"at",value:function(t){return this._importation.origin.from.copy(t),this._importation.origin.to.copy(t),this}},{key:"from",value:function(t){return t?(this._importation.origin.from.copy(t),this):(this._importation.origin.from.clear(),this._importation.origin.from)}},{key:"to",value:function(t){return t?(this._importation.origin.to.copy(t),this):(this._importation.origin.to.clear(),this._importation.origin.to)}},{key:"produce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._importation;io(so(o.prototype),"produce",this).call(this,t)}},{key:"complete",value:function(){io(so(o.prototype),"complete",this).call(this)}},{key:"clear",value:function(){this._importation.clear(),this.removeAllEventListener()}}])&&ro(e.prototype,n),r&&ro(e,r),o}(Wt);function fo(t){return(fo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ho(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return po(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?po(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function po(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function yo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vo(t,e){return(vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Eo(t);if(e){var i=Eo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return mo(this,n)}}function mo(t,e){return!e||"object"!==fo(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Eo(t){return(Eo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(){return new t}}(lo||(lo={})),function(t){t.CONTENT=0,t.IMPORTATION_START=1,t.IMPORTATION_CONTENT=2,t.IMPORTATION_TRAILING_WHITESPACE=3,t.ALL=[t.CONTENT,t.IMPORTATION_START,t.IMPORTATION_CONTENT,t.IMPORTATION_TRAILING_WHITESPACE],t.toString=function(e){switch(e){case t.CONTENT:return"CONTENT";case t.IMPORTATION_START:return"IMPORTATION_START";case t.IMPORTATION_CONTENT:return"IMPORTATION_CONTENT";case t.IMPORTATION_TRAILING_WHITESPACE:return"IMPORTATION_TRAILING_WHITESPACE";default:return}}}(co||(co={}));var go="import",_o=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vo(t,e)}(o,t);var e,n,r,i=bo(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).importations=new lo,t._output=new sr,t._nextIdentifier="",t._buffer=kt.create(Ke.ALLOCATOR,16),t._state=co.CONTENT,t}return e=o,(n=[{key:"handleInitialization",value:function(){this._output.initialize(),this.importations.initialize(),this._buffer.clear(),this._nextIdentifier="",this._state=co.CONTENT}},{key:"handleProduction",value:function(t){switch(this._state){case co.CONTENT:return this.handleProductionAfterContent(t);case co.IMPORTATION_START:return this.handleProductionAfterImportationStart(t);case co.IMPORTATION_CONTENT:return this.handleProductionAfterImportationContent(t);case co.IMPORTATION_TRAILING_WHITESPACE:return this.handleProductionAfterTrailingWhitespace(t);default:throw new Error("Unable to handle production in state #"+this._state+"("+co.toString(this._state)+") because no procedure was defined for that.")}}},{key:"handleProductionAfterContent",value:function(t){t.type===S.START_TAG&&t.tag===go?(this._buffer.push(t),this.importations.from(t.origin.from),this._state=co.IMPORTATION_START):this._output.produce(t)}},{key:"handleProductionAfterImportationStart",value:function(t){t.type===S.WHITESPACE?this._buffer.push(t):t.type===S.WORD?(this._buffer.push(t),this._nextIdentifier+=t.text,this._state=co.IMPORTATION_CONTENT):this.handleInvalidImportationTag(t)}},{key:"handleProductionAfterImportationContent",value:function(t){t.type===S.WHITESPACE?(this._buffer.push(t),this._state=co.IMPORTATION_TRAILING_WHITESPACE):t.type===S.END_TAG?t.tag===go?(this.importations.to(t.origin.to),this.emitValidImportation()):this.handleInvalidImportationTag(t):t.type===S.WORD?(this._buffer.push(t),this._nextIdentifier+=t.text):this.handleInvalidImportationTag(t)}},{key:"handleProductionAfterTrailingWhitespace",value:function(t){t.type===S.WHITESPACE?(this._buffer.push(t),this._state=co.IMPORTATION_TRAILING_WHITESPACE):t.type===S.END_TAG&&t.tag===go?(this.importations.to(t.origin.to),this.emitValidImportation()):this.handleInvalidImportationTag(t)}},{key:"handleInvalidImportationTag",value:function(t){var e,n=ho(this._buffer);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._output.produce(r)}}catch(i){n.e(i)}finally{n.f()}this._output.produce(t),this._buffer.clear(),this._nextIdentifier="",this._state=co.CONTENT}},{key:"emitValidImportation",value:function(){this._buffer.clear(),this._state=co.CONTENT,this.importations.ofResource(this._nextIdentifier),this._nextIdentifier="",this.importations.produce()}},{key:"handleCompletion",value:function(){this.importations.complete(),this._output.complete(),this._buffer.clear(),this._nextIdentifier="",this._state=co.CONTENT}},{key:"handleFailure",value:function(t){console.error(t)}},{key:"addEventListener",value:function(t,e){this._output.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this._output.removeEventListener(t,e)}},{key:"removeAllEventListener",value:function(){var t;(t=this._output).removeAllEventListener.apply(t,arguments)}}])&&yo(e.prototype,n),r&&yo(e,r),o}(dt);function To(t){return(To="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ko(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function So(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ao(t,e){return(Ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Io(t);if(e){var i=Io(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Oo(this,n)}}function Oo(t,e){return!e||"object"!==To(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Io(t){return(Io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ro,No=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{s(r.next(t))}catch(e){o(e)}}function u(t){try{s(r.throw(t))}catch(e){o(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Co=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ao(t,e)}(o,t);var e,n,r,i=wo(o);function o(){return ko(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"resolve",value:function(t){return No(this,void 0,void 0,ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw"A null resolver can't resolve unidoc resources.";case 1:case"end":return t.stop()}}),t)})))}}])&&So(e.prototype,n),r&&So(e,r),o}(Bi);function xo(t){return(xo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Po(t){return function(t){if(Array.isArray(t))return Do(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Lo(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lo(t,e){if(t){if("string"===typeof t)return Do(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Do(t,e):void 0}}function Do(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Uo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jo(t,e,n){return(jo="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zo(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Wo(t,e){return(Wo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=zo(t);if(e){var i=zo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fo(this,n)}}function Fo(t,e){return!e||"object"!==xo(e)&&"function"!==typeof e?Go(t):e}function Go(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zo(t){return(zo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.INSTANCE=new t}(Co||(Co={})),function(t){t.CREATED=0,t.RUNNING=1,t.IMPORTING=2,t.COMPLETED=3,t.ALL=[t.CREATED,t.RUNNING,t.IMPORTING,t.COMPLETED],t.toString=function(e){switch(e){case t.CREATED:return"CREATED";case t.RUNNING:return"RUNNING";case t.IMPORTING:return"IMPORTING";case t.COMPLETED:return"COMPLETED";default:return}}}(Ro||(Ro={}));var Bo=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wo(t,e)}(o,t);var e,n,r,i=Mo(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this))._resources=U.Pack.any(16),e._import=new Vi,e._symbol=new Oi,e._resolver=t,e._state=Ro.CREATED,e._oldState=Ro.CREATED,e.executeImport=e.executeImport.bind(Go(e)),e.fail=e.fail.bind(Go(e)),e}return e=o,(n=[{key:"initializeIfNecessary",value:function(){this._state===Ro.CREATED&&(this.initialize(),this._state=Ro.RUNNING)}},{key:"import",value:function(t){"string"===typeof t?(this._import.resource=t,this._import.origin.at(Pe.runtime()),this.resolveImport(this._import)):this.resolveImport(t)}},{key:"resolveImport",value:function(t){this._oldState=this._state,this._state=Ro.IMPORTING,this._resolver.resolve(t).then(this.executeImport).catch(this.fail)}},{key:"executeImport",value:function(t){this._state=this._oldState,this.stream(t)}},{key:"stream",value:function(t){for(this.assertThatThereIsNoCircularDependency(t),this.initializeIfNecessary(),this._resources.push(t);this.hasNext()&&this._state===Ro.RUNNING;)this.next();this._state===Ro.RUNNING&&(this._state=Ro.COMPLETED,this.complete())}},{key:"assertThatThereIsNoCircularDependency",value:function(t){var e,n=function(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Lo(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}(this._resources);try{for(n.s();!(e=n.n()).done;)if(e.value.resource===t.resource)throw new Error("Unable to stream resource "+t.resource+" imported from "+t.origin.origin.toString()+" because there is a circular dependency : "+Po(this._resources).map((function(t){return t.resource})).join(" > ")+" > "+t.resource+".")}catch(r){n.e(r)}finally{n.f()}}},{key:"fail",value:function(t){jo(zo(o.prototype),"fail",this).call(this,t)}},{key:"hasNext",value:function(){return this._resources.size>0}},{key:"next",value:function(){var t=this._resources.last.reader.next();for(this._symbol.symbol=t.symbol;this._resources.size>0&&!this._resources.last.reader.hasNext();)this._resources.pop();this.produce(t)}}])&&Uo(e.prototype,n),r&&Uo(e,r),o}(Wt);function Ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vo(t){switch(t){case fe.NEW_LINE:return 3;case fe.CARRIAGE_RETURN:return 2;case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:return 1;default:return 0}}var qo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._producer=new Ir,this._tracker=new tr}var e,n,r;return e=t,(n=[{key:"produceIdentifier",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(e),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceIdentifier(t),this}},{key:"produceClass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(e),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceClass(t),this}},{key:"produceTag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(e),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceTag(t),this}},{key:"produceBlockStart",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"{";return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(t),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceBlockStart(),this}},{key:"produceBlockEnd",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"}";return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(t),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceBlockEnd(),this}},{key:"produceSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(e),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceSpace(t),this}},{key:"produceNewline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\r\n",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(e),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceNewline(t),this}},{key:"produceWord",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._producer.from().text(this._tracker.location).runtime(),this._tracker.nextString(e),this._producer.to().text(this._tracker.location).runtime(),this._producer.produceWord(t),this}},{key:"produceString",value:function(t){if(t.length>0){for(var e=0,n=1,r=Vo(t.codePointAt(0));n<t.length;){var i=Vo(t.codePointAt(n));switch(r){case 0:i!==r&&(this.produceWord(t.substring(e,n)),e=n);break;case 1:i!==r&&(this.produceSpace(t.substring(e,n)),e=n);break;case 2:3!==i&&(this.produceNewline(t.substring(e,n)),e=n);break;case 3:this.produceNewline(t.substring(e,n)),e=n}n+=1,r=i}switch(r){case 0:this.produceWord(t.substring(e,n));break;case 1:this.produceSpace(t.substring(e,n));break;case 2:case 3:this.produceNewline(t.substring(e,n))}}return this}},{key:"complete",value:function(){this._producer.complete()}},{key:"addEventListener",value:function(t,e){this._producer.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this._producer.removeEventListener(t,e)}},{key:"removeAllEventListener",value:function(){var t;(t=this._producer).removeAllEventListener.apply(t,arguments)}}])&&Ho(e.prototype,n),r&&Ho(e,r),t}();function Yo(t){return(Yo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ko(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Xo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xo(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Xo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Zo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jo(t,e){return(Jo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ea(t);if(e){var i=ea(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ta(this,n)}}function ta(t,e){return!e||"object"!==Yo(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ea(t){return(ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(){return new t},t.forBuffer=function(e){var n=new t;return n.addEventListener(pt.PRODUCTION,e.push.bind(e)),n.addEventListener(pt.COMPLETION,e.fit.bind(e)),n},t.forParser=function(e){var n=new t;return n.addEventListener(pt.PRODUCTION,e.next.bind(e)),n.addEventListener(pt.COMPLETION,e.complete.bind(e)),n}}(qo||(qo={}));var na,ra=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jo(t,e)}(o,t);var e,n,r,i=Qo(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;return Zo(this,o),(t=i.call(this))._tokens=U.Pack.instance(Er.ALLOCATOR,e),t.tokens=t._tokens.view(),t}return e=o,(n=[{key:"handleInitialization",value:function(){}},{key:"handleProduction",value:function(t){this.push(t)}},{key:"handleCompletion",value:function(){}},{key:"handleFailure",value:function(t){console.error(t)}},{key:"slice",value:function(t,e){for(var n=new o(e),r=Math.min(e,this.size-t),i=0;i<r;++i)n.push(this._tokens.get(i+t));return n}},{key:"reallocate",value:function(t){this._tokens.reallocate(t)}},{key:"fit",value:function(){this._tokens.fit()}},{key:"get",value:function(t){return this._tokens.get(t)}},{key:"push",value:function(t){this._tokens.push(t)}},{key:"delete",value:function(t){this._tokens.delete(t)}},{key:"deleteMany",value:function(t,e){this._tokens.deleteMany(t,e)}},{key:"concat",value:function(t){var e,n=Ko(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._tokens.push(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"copy",value:function(t){this._tokens.clear();var e,n=Ko(t.tokens);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._tokens.push(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"clear",value:function(){this._tokens.clear()}},{key:"toString",value:function(){for(var t="[",e=0;e<this._tokens.size;++e)e>0&&(t+=","),t+="\r\n"+this._tokens.get(e).toString();return this._tokens.size>0&&(t+="\r\n"),t+="]"}},{key:Symbol.iterator,value:ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(this._tokens,"t0",1);case 1:case"end":return t.stop()}}),t,this)}))},{key:"equals",value:function(t){if(null==t)return!1;if(t===this)return!0;if(t instanceof o){if(t.tokens.size!==this._tokens.size)return!1;for(var e=0,n=this._tokens.size;e<n;++e)if(!t.tokens.get(e).equals(this._tokens.get(e)))return!1;return!0}return!1}},{key:"capacity",get:function(){return this._tokens.capacity}},{key:"size",get:function(){return this._tokens.size},set:function(t){this._tokens.size=t}},{key:"last",get:function(){return this._tokens.last}},{key:"first",get:function(){return this._tokens.first}},{key:"from",get:function(){return 0===this._tokens.size?Pe.runtime():this._tokens.first.origin.from}},{key:"to",get:function(){return 0===this._tokens.size?Pe.runtime():this._tokens.last.origin.to}},{key:"text",get:function(){var t,e="",n=Ko(this._tokens);try{for(n.s();!(t=n.n()).done;)e+=t.value.text}catch(r){n.e(r)}finally{n.f()}return e}}])&&$o(e.prototype,n),r&&$o(e,r),o}(dt);function ia(t){return function(t){if(Array.isArray(t))return sa(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||ua(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oa(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(s){i=!0,o=s}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}}(t,e)||ua(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aa(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=ua(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function ua(t,e){if(t){if("string"===typeof t)return sa(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sa(t,e):void 0}}function sa(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ca(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.assert=function(t,e){if(t.tokens.size!==e.tokens.size)throw new Error("Buffers "+e.toString()+" and "+t.toString()+" are not equals because thay contains a different amount of tokens "+e.tokens.size+" !== "+t.tokens.size+".");for(var n=0,r=e.tokens.size;n<r;++n)if(!t.tokens.get(n).equals(e.tokens.get(n)))throw new Error("Buffers "+e.toString()+" and "+t.toString()+" are not equals because their #"+n+" token are not equal "+e.tokens.get(n).toString()+" !== "+t.tokens.get(n).toString()+".")}}(ra||(ra={})),function(t){function e(e){switch(e){case t.VERBOSE:return"VERBOSE";case t.INFORMATION:return"INFORMATION";case t.WARNING:return"WARNING";case t.ERROR:return"ERROR";case t.FAILURE:return"FAILURE";default:return}}t.VERBOSE=0,t.INFORMATION=1,t.WARNING=2,t.ERROR=3,t.FAILURE=4,t.ALL=[t.VERBOSE,t.INFORMATION,t.WARNING,t.ERROR,t.FAILURE],t.DEFAULT=0,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(na||(na={}));var la=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=na.DEFAULT,this.code="",this.data=new Map}var e,n,r;return e=t,(n=[{key:"setData",value:function(t,e){return this.data.set(t,e),this}},{key:"setCode",value:function(t){return this.code=t,this}},{key:"setType",value:function(t){return this.type=t,this}},{key:"asVerbose",value:function(){return this.type=na.VERBOSE,this}},{key:"asInformation",value:function(){return this.type=na.INFORMATION,this}},{key:"asWarning",value:function(){return this.type=na.WARNING,this}},{key:"asError",value:function(){return this.type=na.ERROR,this}},{key:"asFailure",value:function(){return this.type=na.FAILURE,this}},{key:"isVerbose",value:function(){return this.type===na.VERBOSE}},{key:"isInformation",value:function(){return this.type===na.INFORMATION}},{key:"isWarning",value:function(){return this.type===na.WARNING}},{key:"isError",value:function(){return this.type===na.ERROR}},{key:"isFailure",value:function(){return this.type===na.FAILURE}},{key:"clear",value:function(){this.type=na.DEFAULT,this.code="",this.data.clear()}},{key:"copy",value:function(t){this.type=t.type,this.code=t.code,this.data.clear();var e,n=aa(t.data);try{for(n.s();!(e=n.n()).done;){var r=oa(e.value,2),i=r[0],o=r[1];this.data.set(i,o)}}catch(a){n.e(a)}finally{n.f()}}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"toString",value:function(){return"".concat(na.toDebugString(this.type)," ").concat(this.code," : {").concat(ia(this.data.entries()).map((function(t){return t[0]+": "+t[1]})).join(", "),"}")}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.type!==this.type||e.code!==this.code||e.data.size!==this.data.size)return!1;var n,r=aa(this.data);try{for(r.s();!(n=r.n()).done;){var i=oa(n.value,2),o=i[0],a=i[1],u=e.data.get(o);if(u.equals){if(!u.equals(a))return!1}else if(u!==a)return!1}}catch(s){r.e(s)}finally{r.f()}return!0}return!1}}])&&ca(e.prototype,n),r&&ca(e,r),t}();function fa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.copy=function(t){return null==t?t:t.clone()},t.create=e,t.ALLOCATOR=U.Duplicator.fromFactory(e)}(la||(la={}));var ha=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=0,this.batch=0,this.type=un.DEFAULT,this.event=new Ke,this.message=new la,this.group=void 0}var e,n,r;return e=t,(n=[{key:"setIndex",value:function(t){return this.index=t,this}},{key:"setBatch",value:function(t){return this.batch=t,this}},{key:"isMessage",value:function(){return this.type===un.MESSAGE}},{key:"isValidation",value:function(){return this.type===un.VALIDATION}},{key:"isBeginGroup",value:function(){return this.type===un.BEGIN_GROUP}},{key:"isEndGroup",value:function(){return this.type===un.END_GROUP}},{key:"isDocumentCompletion",value:function(){return this.type===un.DOCUMENT_COMPLETION}},{key:"asValidation",value:function(t){return this.message.clear(),this.event.copy(t),this.type=un.VALIDATION,this.group=void 0,this}},{key:"asDocumentCompletion",value:function(){return this.message.clear(),this.event.clear(),this.type=un.DOCUMENT_COMPLETION,this.group=void 0,this}},{key:"asBeginGroup",value:function(t){return this.message.clear(),this.event.clear(),this.type=un.BEGIN_GROUP,this.group=t,this}},{key:"asEndGroup",value:function(t){return this.message.clear(),this.event.clear(),this.type=un.END_GROUP,this.group=t,this}},{key:"asMessage",value:function(t){return this.event.clear(),t?this.message.copy(t):this.message.clear(),this.type=un.MESSAGE,this.group=void 0,this}},{key:"clear",value:function(){this.index=0,this.batch=0,this.type=un.DEFAULT,this.message.clear(),this.event.clear(),this.group=void 0}},{key:"copy",value:function(t){this.index=t.index,this.batch=t.batch,this.type=t.type,this.message.copy(t.message),this.event.copy(t.event),this.group=t.group}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"toString",value:function(){var t=this.index.toString().padEnd(5);switch(t+=" batch #",t+=this.batch.toString().padEnd(5),t+=" of type ",t+=un.toDebugString(this.type),this.type){case un.MESSAGE:t+=" ",t+=this.message.toString();break;case un.VALIDATION:t+=" validating ",t+=this.event;break;case un.DOCUMENT_COMPLETION:t+=" document completion";break;case un.BEGIN_GROUP:t+=" start of group ",t+=this.group?this.group.toString():"null";break;case un.END_GROUP:t+=" end of group ",t+=this.group?this.group.toString():"null";break;default:throw new Error("Unable to stringify validation event of type "+un.toDebugString(this.type)+" because no procedure was defined to stringify this type of event.")}return t}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.index===e.index&&this.batch===e.batch&&this.type===e.type&&this.message.equals(e.message)&&this.event.equals(e.event)&&this.group===e.group)}}])&&fa(e.prototype,n),r&&fa(e,r),t}();function pa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.copy=function(t){return null==t?t:t.clone()},t.create=e,t.ALLOCATOR=U.Duplicator.fromFactory(e)}(ha||(ha={}));var ya=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.event=new ha}var e,n,r;return e=t,(n=[{key:"setIndex",value:function(t){return this.event.setIndex(t),this}},{key:"setBatch",value:function(t){return this.event.setBatch(t),this}},{key:"asValidation",value:function(t){return this.event.asValidation(t),this}},{key:"asDocumentCompletion",value:function(){return this.event.asDocumentCompletion(),this}},{key:"asBeginGroup",value:function(t){return this.event.asBeginGroup(t),this}},{key:"asEndGroup",value:function(t){return this.event.asEndGroup(t),this}},{key:"asMessage",value:function(t){return this.event.asMessage(t),this}},{key:"build",value:function(){return this.event.clone()}},{key:"get",value:function(){return this.event}},{key:"configure",value:function(t){t.copy(this.event)}},{key:"clear",value:function(){this.event.clear()}},{key:"copy",value:function(e){return e instanceof t?this.event.copy(e.event):this.event.copy(e),this}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.event.equals(this.event))}}])&&pa(e.prototype,n),r&&pa(e,r),t}();function va(t){return(va="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ba(t,e,n){return(ba="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_a(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function ma(t,e){return(ma=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ea(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_a(t);if(e){var i=_a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ga(this,n)}}function ga(t,e){return!e||"object"!==va(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _a(t){return(_a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.INSTANCE=new t,t.create=function(){return new t},t.get=function(){return t.INSTANCE}}(ya||(ya={}));var Ta=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ma(t,e)}(o,t);var e,n,r,i=Ea(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._event=new ha,t._index=0,t._batch=0,t}return e=o,(n=[{key:"fail",value:function(t){ba(_a(o.prototype),"fail",this).call(this,t)}},{key:"initialize",value:function(){ba(_a(o.prototype),"initialize",this).call(this)}},{key:"produceValidation",value:function(t){return this._event.asValidation(t),this.produce(this._event),this}},{key:"produceDocumentCompletion",value:function(){return this._event.asDocumentCompletion(),this.produce(this._event),this}},{key:"produceBeginGroup",value:function(t){return this._event.asBeginGroup(t),this.produce(this._event),this}},{key:"produceEndGroup",value:function(t){return this._event.asEndGroup(t),this.produce(this._event),this}},{key:"produceMessage",value:function(t){return this._event.asMessage(t),this.produce(this._event),this}},{key:"produce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._event;t.type!==un.VALIDATION&&t.type!==un.DOCUMENT_COMPLETION||(this._batch+=1),t.index=this._index,t.batch=this._batch,this._index+=1,ba(_a(o.prototype),"produce",this).call(this,t)}},{key:"complete",value:function(){ba(_a(o.prototype),"complete",this).call(this)}},{key:"clear",value:function(){this._event.clear(),this._index=0,this._batch=0,this.removeAllEventListener()}}])&&da(e.prototype,n),r&&da(e,r),o}(Wt);function ka(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(Ta||(Ta={}));var Sa,Aa,wa,Oa=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.message=new la}var e,n,r;return e=t,(n=[{key:"setData",value:function(t,e){return this.message.setData(t,e),this}},{key:"setCode",value:function(t){return this.message.setCode(t),this}},{key:"setType",value:function(t){return this.message.setType(t),this}},{key:"asVerbose",value:function(){return this.message.asVerbose(),this}},{key:"asInformation",value:function(){return this.message.asInformation(),this}},{key:"asWarning",value:function(){return this.message.asWarning(),this}},{key:"asError",value:function(){return this.message.asError(),this}},{key:"asFailure",value:function(){return this.message.asFailure(),this}},{key:"build",value:function(){return this.message.clone()}},{key:"get",value:function(){return this.message}},{key:"configure",value:function(t){t.copy(this.message)}},{key:"clear",value:function(){this.message.clear()}},{key:"copy",value:function(e){return e instanceof t?this.message.copy(e.message):this.message.copy(e),this}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.message.equals(this.message))}}])&&ka(e.prototype,n),r&&ka(e,r),t}();!function(t){t.INSTANCE=new t,t.create=function(){return new t},t.get=function(){return t.INSTANCE}}(Oa||(Oa={})),function(t){t.TYPE=na.FAILURE,t.CODE="standard:blueprint:failure:expected-content",function(t){t.BLUEPRINT="blueprint"}(t.Data||(t.Data={}))}(Sa||(Sa={})),function(t){t.TYPE=na.WARNING,t.CODE="standard:blueprint:warning:preffered-content",function(t){t.BLUEPRINT="blueprint"}(t.Data||(t.Data={}))}(Aa||(Aa={})),function(t){t.TYPE=na.ERROR,t.CODE="standard:blueprint:error:too-many-content",function(t){t.BLUEPRINT="blueprint"}(t.Data||(t.Data={})),function(t){t.TYPE=na.FAILURE,t.CODE="standard:blueprint:failure:too-many-content",function(t){t.BLUEPRINT="blueprint"}(t.Data||(t.Data={}))}(t.Strict||(t.Strict={}))}(wa||(wa={}));var Ia=ve().mark(Ca);function Ra(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Na(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Na(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Na(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ca(t){var e,n,r,i,o;return ve().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e="",n=!1,r=Ra(yu.match(t)),a.prev=3,r.s();case 5:if((i=r.n()).done){a.next=25;break}if(!(o=i.value).isEmit()||!o.event.isValidation()){a.next=13;break}return o.event.event.isWord()?(n&&e.length>0&&(e+=" ",n=!1),e+=o.event.event.text):o.event.event.isWhitespace()&&(n=!0),a.next=11,o;case 11:a.next=23;break;case 13:if(!o.isEnd()){a.next=17;break}return a.abrupt("return",void 0);case 17:if(!o.isMatch()){a.next=21;break}return a.abrupt("return",e);case 21:return a.next=23,o;case 23:a.next=5;break;case 25:a.next=30;break;case 27:a.prev=27,a.t0=a.catch(3),r.e(a.t0);case 30:return a.prev=30,r.f(),a.finish(30);case 33:return a.abrupt("return",e);case 34:case"end":return a.stop()}}),Ia,null,[[3,27,30,33]])}var xa=ve().mark(Pa);function Pa(t,e){var n;return ve().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(Ca(t),"t0",1);case 1:if(void 0!==(n=r.t0)){r.next=6;break}return r.abrupt("return",yu.output.end());case 6:if(!e.test(n)){r.next=10;break}return r.abrupt("return",yu.output.match());case 10:return r.next=12,yu.output.message.expectedContent(ut.regexp(e));case 12:return r.abrupt("return",yu.output.end());case 13:case"end":return r.stop()}}),xa)}var La=ve().mark(Da);function Da(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.output.current();case 2:t=e.sent;case 3:if(!t||!t.isWhitespace()){e.next=11;break}return e.next=6,yu.output.validation(t);case 6:return e.next=8,yu.output.next();case 8:t=e.sent,e.next=3;break;case 11:if(null!=t&&t.isWord()){e.next=17;break}return e.next=14,yu.output.validation(t);case 14:return e.next=16,yu.output.message.expectedContent(ut.word());case 16:return e.abrupt("return",yu.output.end());case 17:if(!t||!t.isWhitespace()&&!t.isWord()){e.next=25;break}return e.next=20,yu.output.validation(t);case 20:return e.next=22,yu.output.next();case 22:t=e.sent,e.next=17;break;case 25:return e.abrupt("return",yu.output.match());case 26:case"end":return e.stop()}}),La)}!function(t){t.thatMatch=function(e){return Pa(t(),e)}}(Da||(Da={}));var Ua=ve().mark(ja);function ja(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.output.current();case 2:t=e.sent;case 3:if(!t||!t.isWhitespace()){e.next=11;break}return e.next=6,yu.output.validation(t);case 6:return e.next=8,yu.output.next();case 8:t=e.sent,e.next=3;break;case 11:if(null!=t&&t.isWord()){e.next=17;break}return e.next=14,yu.output.validation(t);case 14:return e.next=16,yu.output.message.expectedContent(ut.word());case 16:return e.abrupt("return",yu.output.end());case 17:if(!t||!t.isWord()){e.next=25;break}return e.next=20,yu.output.validation(t);case 20:return e.next=22,yu.output.next();case 22:t=e.sent,e.next=17;break;case 25:if(!t||!t.isWhitespace()){e.next=33;break}return e.next=28,yu.output.validation(t);case 28:return e.next=30,yu.output.next();case 30:t=e.sent,e.next=25;break;case 33:return e.abrupt("return",yu.output.match());case 34:case"end":return e.stop()}}),Ua)}!function(t){t.thatMatch=function(e){return Pa(t(),e)}}(ja||(ja={}));var Wa,Ma=ve().mark(Fa);function Fa(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.output.current();case 2:return t=e.sent,e.next=5,yu.output.validation(t);case 5:if(!t){e.next=11;break}return e.next=8,yu.output.message.expectedContent(ut.end());case 8:return e.abrupt("return",yu.output.end());case 11:return e.abrupt("return",yu.output.match());case 12:case"end":return e.stop()}}),Ma)}function Ga(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(e){switch(e){case t.CURRENT:return"CURRENT";case t.NEXT:return"NEXT";case t.EMIT:return"EMIT";case t.END:return"END";default:return}}t.CURRENT=0,t.NEXT=1,t.EMIT=2,t.END=3,t.MATCH=4,t.ALL=[t.CURRENT,t.NEXT,t.EMIT,t.END,t.MATCH],t.DEFAULT=t.CURRENT,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(Wa||(Wa={}));var za=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=Wa.DEFAULT,this.event=new ha}var e,n,r;return e=t,(n=[{key:"isCurrent",value:function(){return this.type===Wa.CURRENT}},{key:"isNext",value:function(){return this.type===Wa.NEXT}},{key:"isEmit",value:function(){return this.type===Wa.EMIT}},{key:"isEnd",value:function(){return this.type===Wa.END}},{key:"isMatch",value:function(){return this.type===Wa.MATCH}},{key:"asCurrent",value:function(){return this.type=Wa.CURRENT,this.event.clear(),this}},{key:"asNext",value:function(){return this.type=Wa.NEXT,this.event.clear(),this}},{key:"asMatch",value:function(){return this.type=Wa.MATCH,this.event.clear(),this}},{key:"asEmit",value:function(t){return this.type=Wa.EMIT,this.event.copy(t),this}},{key:"asEnd",value:function(){return this.type=Wa.END,this.event.clear(),this}},{key:"clear",value:function(){this.type=Wa.DEFAULT,this.event.clear()}},{key:"copy",value:function(t){this.type=t.type,this.event.copy(t.event)}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"toString",value:function(){var t=Wa.toDebugString(this.type);switch(this.type){case Wa.CURRENT:t+=" get current event";break;case Wa.NEXT:t+=" get next event";break;case Wa.EMIT:t+=" emit ",t+=this.event.toString();break;case Wa.END:t+=" end";break;case Wa.MATCH:t+=" match";break;default:throw new Error("Unable to stringify validator output of type "+Wa.toDebugString(this.type)+" because no procedure was defined to stringify this type of event.")}return t}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type&&this.event.equals(e.event))}}])&&Ga(e.prototype,n),r&&Ga(e,r),t}();!function(t){function e(){return new t}t.CURRENT=e().asCurrent(),t.NEXT=e().asNext(),t.END=e().asEnd(),t.MATCH=e().asMatch(),t.copy=function(t){return null==t?t:t.clone()},t.create=e,t.ALLOCATOR=U.Allocator.fromFactory(e)}(za||(za={}));var Ba=ve().mark(Ha);function Ha(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,za.CURRENT;case 2:return t=e.sent,e.next=5,yu.output.validation(t);case 5:if(!t||!t.isEndOfAnyTag()){e.next=11;break}return e.next=8,yu.output.next();case 8:return e.abrupt("return",yu.output.match());case 11:return e.next=13,yu.output.message.expectedContent(ut.event(P.isTagEnd()));case 13:return e.abrupt("return",yu.output.end());case 14:case"end":return e.stop()}}),Ba)}var Va=ve().mark(qa);function qa(t){var e;return ve().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,yu.output.current();case 2:return e=n.sent,n.next=5,yu.output.validation(e);case 5:if(!e||!e.isEndOfTag(t)){n.next=11;break}return n.next=8,yu.output.next();case 8:return n.abrupt("return",yu.output.match());case 11:return n.next=13,yu.output.message.expectedContent(ut.tagStart(t));case 13:return n.abrupt("return",yu.output.end());case 14:case"end":return n.stop()}}),Va)}!function(t){t.factory=function(e){return t.bind(void 0,e)}}(qa||(qa={}));var Ya=ve().mark(Ka);function Ka(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",yu.output.match());case 1:case"end":return t.stop()}}),Ya)}var Xa=ve().mark(Za);function Za(){var t,e,n,r,i=arguments;return ve().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:0,e=i.length>1&&void 0!==i[1]?i[1]:Number.POSITIVE_INFINITY,o.next=4,yu.output.current();case 4:n=o.sent,r=0;case 6:if(!n||!n.isWhitespace()){o.next=19;break}if(!(r<e)){o.next=16;break}return o.next=10,yu.output.validation(n);case 10:return r+=1,o.next=13,yu.output.next();case 13:n=o.sent,o.next=17;break;case 16:return o.abrupt("return",yu.output.match());case 17:o.next=6;break;case 19:if(!(r<t)){o.next=25;break}return o.next=22,yu.output.message.expectedContent(ut.many(ut.whitespace()).atLeast(t-r));case 22:return o.abrupt("return",yu.output.end());case 25:return o.abrupt("return",yu.output.match());case 26:case"end":return o.stop()}}),Xa)}var $a=ve().mark(Ja);function Ja(){var t,e,n,r,i=arguments;return ve().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:0,e=i.length>1&&void 0!==i[1]?i[1]:Number.POSITIVE_INFINITY,o.next=4,yu.output.current();case 4:n=o.sent,r=0;case 6:if(!n||!n.isWord()){o.next=19;break}if(!(r<e)){o.next=16;break}return o.next=10,yu.output.validation(n);case 10:return r+=1,o.next=13,yu.output.next();case 13:n=o.sent,o.next=17;break;case 16:return o.abrupt("return",yu.output.match());case 17:o.next=6;break;case 19:if(!(r<t)){o.next=25;break}return o.next=22,yu.output.message.expectedContent(ut.many(ut.word()).atLeast(t-r));case 22:return o.abrupt("return",yu.output.end());case 25:return o.abrupt("return",yu.output.match());case 26:case"end":return o.stop()}}),$a)}var Qa=ve().mark(tu);function tu(){var t,e,n,r=arguments;return ve().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=0,e=r.length;case 1:if(!(t<e)){i.next=17;break}return i.delegateYield(t<0||r.length<=t?void 0:r[t],"t0",3);case 3:if(null!=(n=i.t0)){i.next=8;break}throw new Error("Illegal behavior, a KISS validator returned nothing at the end of it's execution.");case 8:if(!n.isEnd()){i.next=12;break}return i.abrupt("return",n);case 12:if(n.isMatch()){i.next=14;break}throw new Error("Illegal behavior, a KISS validator returned a result that was neither end nor match at the end of it's execution.");case 14:++t,i.next=1;break;case 17:return i.abrupt("return",yu.output.match());case 18:case"end":return i.stop()}}),Qa)}var eu=ve().mark(nu);function nu(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.output.current();case 2:return t=e.sent,e.next=5,yu.output.validation(t);case 5:if(!t||!t.isStartOfAnyTag()){e.next=11;break}return e.next=8,yu.output.next();case 8:return e.abrupt("return",yu.output.match());case 11:return e.next=13,yu.output.message.expectedContent(ut.event(P.isTagStart()));case 13:return e.abrupt("return",yu.output.end());case 14:case"end":return e.stop()}}),eu)}var ru=ve().mark(iu);function iu(t){var e;return ve().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,yu.output.current();case 2:return e=n.sent,n.next=5,yu.output.validation(e);case 5:if(!e||!e.isStartOfTag(t)){n.next=11;break}return n.next=8,yu.output.next();case 8:return n.abrupt("return",yu.output.match());case 11:return n.next=13,yu.output.message.expectedContent(ut.tagStart(t));case 13:return n.abrupt("return",yu.output.end());case 14:case"end":return n.stop()}}),ru)}!function(t){t.factory=function(e){return t.bind(void 0,e)}}(iu||(iu={}));var ou=ve().mark(au);function au(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.output.current();case 2:t=e.sent;case 3:if(!t||!t.isWhitespace()){e.next=11;break}return e.next=6,yu.output.validation(t);case 6:return e.next=8,yu.output.next();case 8:t=e.sent,e.next=3;break;case 11:if(!t||!t.isWhitespace()&&!t.isWord()){e.next=19;break}return e.next=14,yu.output.validation(t);case 14:return e.next=16,yu.output.next();case 16:t=e.sent,e.next=11;break;case 19:return e.abrupt("return",yu.output.match());case 20:case"end":return e.stop()}}),ou)}!function(t){t.thatMatch=function(e){return Pa(t(),e)}}(au||(au={}));var uu=ve().mark(su);function su(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.output.current();case 2:t=e.sent;case 3:if(!t||!t.isWhitespace()){e.next=11;break}return e.next=6,yu.output.validation(t);case 6:return e.next=8,yu.output.next();case 8:t=e.sent,e.next=3;break;case 11:if(!t||!t.isWord()){e.next=19;break}return e.next=14,yu.output.validation(t);case 14:return e.next=16,yu.output.next();case 16:t=e.sent,e.next=11;break;case 19:if(!t||!t.isWhitespace()){e.next=27;break}return e.next=22,yu.output.validation(t);case 22:return e.next=24,yu.output.next();case 24:t=e.sent,e.next=19;break;case 27:return e.abrupt("return",yu.output.match());case 28:case"end":return e.stop()}}),uu)}!function(t){t.thatMatch=function(e){return Pa(t(),e)}}(su||(su={}));var cu=ve().mark(lu);function lu(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.output.current();case 2:return t=e.sent,e.next=5,yu.output.validation(t);case 5:if(!t||!t.isWhitespace()){e.next=11;break}return e.next=8,yu.output.next();case 8:return e.abrupt("return",yu.output.match());case 11:return e.next=13,yu.output.message.expectedContent(ut.whitespace());case 13:return e.abrupt("return",yu.output.end());case 14:case"end":return e.stop()}}),cu)}var fu=ve().mark(hu);function hu(){var t;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.output.current();case 2:return t=e.sent,e.next=5,yu.output.validation(t);case 5:if(!t||!t.isWord()){e.next=11;break}return e.next=8,yu.output.next();case 8:return e.abrupt("return",yu.output.match());case 11:return e.next=13,yu.output.message.expectedContent(ut.word());case 13:return e.abrupt("return",yu.output.end());case 14:case"end":return e.stop()}}),fu)}function pu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var yu,vu=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._output=new za}var e,n,r;return e=t,(n=[{key:"asCurrent",value:function(){return this._output.asCurrent(),this}},{key:"asNext",value:function(){return this._output.asNext(),this}},{key:"asEmit",value:function(t){return this._output.asEmit(t),this}},{key:"asEnd",value:function(){return this._output.asEnd(),this}},{key:"build",value:function(){return this._output.clone()}},{key:"get",value:function(){return this._output}},{key:"configure",value:function(t){t.copy(this._output)}},{key:"clear",value:function(){this._output.clear()}},{key:"copy",value:function(e){return e instanceof t?this._output.copy(e._output):this._output.copy(e),this}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this._output.equals(e._output))}}])&&pu(e.prototype,n),r&&pu(e,r),t}();function du(t){return(du="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mu(t,e){return(mu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Eu(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_u(t);if(e){var i=_u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gu(this,n)}}function gu(t,e){return!e||"object"!==du(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _u(t){return(_u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.INSTANCE=new t,t.create=function(){return new t},t.get=function(){return t.INSTANCE}}(vu||(vu={})),function(t){var e=ve().mark(r),n=ve().mark(i);function r(t){var n;return ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t,"t0",1);case 1:if(null!=(n=e.t0)){e.next=6;break}throw new Error("Illegal behavior, a KISS validator returned nothing at the end of it's execution.");case 6:if(!n.isEnd()){e.next=10;break}return e.abrupt("return",!1);case 10:if(!n.isMatch()){e.next=14;break}return e.abrupt("return",!0);case 14:throw new Error("Illegal behavior, a KISS validator returned a result that was neither end nor match at the end of it's execution.");case 15:case"end":return e.stop()}}),e)}function i(t,e){var r;return ve().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=t.next(e);case 1:if(r.done||!r.value.isCurrent()&&!r.value.isEmit()){n.next=7;break}return n.next=4,r.value;case 4:r=t.next(e),n.next=1;break;case 7:return n.abrupt("return",r.value);case 8:case"end":return n.stop()}}),n)}!function(t){function e(t){return vu.get().asEmit(ya.get().asMessage(t).get()).get()}t.current=function(){return za.CURRENT},t.next=function(){return za.NEXT},t.end=function(){return za.END},t.match=function(){return za.MATCH},t.emit=function(t){return vu.get().asEmit(t).get()},t.validation=function(t){return t?vu.get().asEmit(ya.get().asValidation(t).get()).get():vu.get().asEmit(ya.get().asDocumentCompletion().get()).get()},t.message=e,t.builder=function(){return vu.get()},function(t){function e(){return Oa.get()}function n(n){return t(e().setType(wa.TYPE).setCode(wa.CODE).setData(wa.Data.BLUEPRINT,n).get())}t.builder=e,t.expectedContent=function(n){return t(e().setType(Sa.TYPE).setCode(Sa.CODE).setData(Sa.Data.BLUEPRINT,n).get())},t.preferredContent=function(n){return t(e().setType(Aa.TYPE).setCode(Aa.CODE).setData(Aa.Data.BLUEPRINT,n).get())},t.tooManyContent=n,function(n){n.strict=function(n){return t(e().setType(wa.Strict.TYPE).setCode(wa.Strict.CODE).setData(wa.Strict.Data.BLUEPRINT,n).get())}}(n=t.tooManyContent||(t.tooManyContent={}))}(e=t.message||(t.message={}))}(t.output||(t.output={})),t.match=r,t.captureValidatedText=Ca,t.requireText=Da,t.requireToken=ja,t.validateContentThatMatch=Pa,t.validateEnd=Fa,t.validateEndOfAnyTag=Ha,t.validateEndOfTag=qa,t.validateEpsilon=Ka,t.validateManyWhitespace=Za,t.validateManyWord=Ja,t.validateSequence=tu,t.validateStartOfAnyTag=nu,t.validateStartOfTag=iu,t.validateText=Da,t.validateToken=ja,t.validateWhitespace=lu,t.validateWord=hu,t.feed=i}(yu||(yu={}));var Tu,ku=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mu(t,e)}(o,t);var e,n,r,i=Eu(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).validator=null,e.factory=t,e.output=new Ta,e}return e=o,(n=[{key:"addEventListener",value:function(t,e){this.output.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.output.removeEventListener(t,e)}},{key:"removeAllEventListener",value:function(t){this.output.removeAllEventListener(t)}},{key:"handleInitialization",value:function(){var t=this.factory(),e=this.output;e.initialize(),this.validator=t;for(var n=t.next();!n.done;)switch(n.value.type){case Wa.CURRENT:case Wa.NEXT:return;case Wa.EMIT:n.value.event.message.isFailure()?(e.produce(n.value.event),n=t.return(yu.output.end())):(e.produce(n.value.event),n=t.next());break;case Wa.END:case Wa.MATCH:return void(this.validator=null);default:throw new Error("Unable to handle kiss validator output of type "+Wa.toDebugString(n.value.type)+" because no procedure was defined for that.")}}},{key:"handleProduction",value:function(t){var e=this.validator,n=this.output;if(e)for(var r=e.next(t);!r.done;)switch(r.value.type){case Wa.CURRENT:r=e.next(t);break;case Wa.NEXT:return;case Wa.EMIT:r.value.event.message.isFailure()?(n.produce(r.value.event),r=e.return(yu.output.end())):(n.produce(r.value.event),r=e.next());break;case Wa.END:case Wa.MATCH:return void(this.validator=null);default:throw new Error("Unable to handle kiss validator output of type "+Wa.toDebugString(r.value.type)+" because no procedure was defined for that.")}}},{key:"handleCompletion",value:function(){var t=this.validator,e=this.output;if(t)for(var n=t.next(void 0);!n.done;)switch(n.value.type){case Wa.CURRENT:case Wa.NEXT:n=t.next(void 0);break;case Wa.EMIT:n.value.event.message.isFailure()?(e.produce(n.value.event),n=t.return(yu.output.end())):(e.produce(n.value.event),n=t.next());break;case Wa.END:case Wa.MATCH:return void(this.validator=null);default:throw new Error("Unable to handle kiss validator output of type "+Wa.toDebugString(n.value.type)+" because no procedure was defined for that.")}e.complete()}},{key:"handleFailure",value:function(t){this.output.fail(t)}}])&&bu(e.prototype,n),r&&bu(e,r),o}(dt);function Su(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=wu(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Au(t){return function(t){if(Array.isArray(t))return Ou(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||wu(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wu(t,e){if(t){if("string"===typeof t)return Ou(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ou(t,e):void 0}}function Ou(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Iu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(e){switch(e){case t.START:return"START";case t.STATE:return"STATE";case t.EVENT:return"EVENT";case t.HEAD:return"HEAD";default:return}}t.START=0,t.STATE=1,t.EVENT=2,t.HEAD=3,t.ALL=[t.START,t.STATE,t.EVENT,t.HEAD],t.DEFAULT=t.START,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(Tu||(Tu={}));var Ru=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._parent=null,this._children=U.PackSet.any(4),this.children=this._children.view(),this.event=new ha,this.type=Tu.DEFAULT,this.state=null}var e,n,r;return e=t,(n=[{key:"isLeaf",value:function(){return 0===this._children.size}},{key:"isNode",value:function(){return this._children.size>0}},{key:"isEvent",value:function(){return this.type===Tu.EVENT}},{key:"isState",value:function(){return this.type===Tu.STATE}},{key:"isStart",value:function(){return this.type===Tu.START}},{key:"isHead",value:function(){return this.type===Tu.HEAD}},{key:"asEvent",value:function(t){return this.type=Tu.EVENT,this.event.copy(t),this.state=null,this}},{key:"asState",value:function(t){return this.type=Tu.STATE,this.event.clear(),this.state=t,this}},{key:"asStart",value:function(){return this.type=Tu.START,this.event.clear(),this.state=null,this}},{key:"asHead",value:function(){return this.type=Tu.HEAD,this.event.clear(),this.state=null,this}},{key:"isUpward",value:function(t){for(var e=this._parent;e;){if(e===t)return!0;e=e.parent}return!1}},{key:"root",value:function(){for(var t=this;null!=t.parent;)t=t.parent;return t}},{key:"up",value:ve().mark((function t(){var e;return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this;case 1:if(null==e.parent){t.next=7;break}return e=e.parent,t.next=5,e;case 5:t.next=1;break;case 7:return t.abrupt("return",e);case 8:case"end":return t.stop()}}),t,this)}))},{key:"countMessages",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=0,n=na.ALL.length;e<n;++e)t[e]=0;for(var r=this;r;)r.type===Tu.EVENT&&r.event.isMessage()&&(t[r.event.message.type]+=1),r=r.parent;return t}},{key:"batch",value:function(){for(var t=this;t;){if(t.type===Tu.EVENT)return t.event.batch;t=t.parent}return 0}},{key:"fork",value:function(){var e=t.ALLOCATOR.allocate();return e.parent=this,e}},{key:"addChild",value:function(t){this._children.add(t),t.parent=this}},{key:"deleteChild",value:function(t){this._children.delete(t),t.parent=null}},{key:"delete",value:function(){var t=this._parent;for(this.parent=null;this._children.size>0;)this._children.first.parent=t}},{key:"clear",value:function(){for(this.parent=null;this._children.size>0;)this._children.first.parent=null}},{key:"toString",value:function(){var t=this.constructor.name;switch(this.type){case Tu.START:return t+" START with "+this._children.size+" children";case Tu.STATE:return t+" STATE #"+this.state.identifier+" with "+this._children.size+" children";case Tu.EVENT:return t+" EVENT "+this.event.toString()+" with "+this._children.size+" children";case Tu.HEAD:return t+" HEAD with "+this._children.size+" children";default:throw new Error("Unable to stringify tree node of type "+Tu.toDebugString(this.type)+" as no procedure was defined for that.")}}},{key:"parent",get:function(){return this._parent},set:function(t){if(this._parent!==t){if(this._parent){var e=this._parent;this._parent=null,e.deleteChild(this)}this._parent=t,t&&t.addChild(this)}}}])&&Iu(e.prototype,n),r&&Iu(e,r),t}();function Nu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.create=e,t.ALLOCATOR=U.Allocator.fromFactory(e),t.trash=function(e){for(var n=Au(e.children),r=n.pop();r;){var i,o=Su(r.children);try{for(o.s();!(i=o.n()).done;){var a=i.value;n.push(a)}}catch(u){o.e(u)}finally{o.f()}t.ALLOCATOR.free(r),r=n.pop()}},t.cut=function(e){var n=e.parent;for(e.parent=null;n&&!n.isStart()&&0===n.children.size;){var r=n.parent;t.ALLOCATOR.free(n),n=r}for(var i=e;i&&i.children.size<2;){var o=1===i.children.size?i.children.first:null;t.ALLOCATOR.free(i),i=o}i&&n&&(i.parent=n)}}(Ru||(Ru={}));var Cu=function(){function t(e,n,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e.graph!==n.graph)throw new Error("Unable to instantiate a relationship between the given states because they both belongs to two different graphs.");this.from=e,this.to=n,this.validator=r,this.identifier=this.from.graph.addRelationship(this),this.from.addOutputRelationship(this)}var e,n,r;return e=t,(n=[{key:"toString",value:function(){var t=this.constructor.name;return t+=" #",t+=this.identifier,t+=" from state #",t+=this.from.identifier,t+=" to state #",t+=this.to.identifier}}])&&Nu(e.prototype,n),r&&Nu(e,r),t}();function xu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pu=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.graph=e,this._outputs=U.PackSet.any(4),this.outputs=this._outputs.view(),this.identifier=e.addState(this)}var e,n,r;return e=t,(n=[{key:"isMatch",value:function(){return void 0!==this._match}},{key:"addOutputRelationship",value:function(t){if(t.from!==this)throw new Error("Unable to add the given relationship as an outgoing relationship of this state as the given relationship originate from a different state. #addOutputRelationship is a method that must be called at theright time, please do not use it if you do not know exactly what you are doing.");this._outputs.add(t)}},{key:"output",value:function(t,e){new Cu(this,t,e)}},{key:"input",value:function(t,e){new Cu(t,this,e)}},{key:"epsilon",value:function(t){new Cu(this,t,yu.validateEpsilon)}},{key:"toString",value:function(){var t=this.constructor.name;t+=" #",t+=this.identifier,null!=this._match&&(t+=" (MATCH:"+this._match+")"),t+=" with outgoing relationships (",t+=this._outputs.size,t+=") into [";for(var e=0;e<this._outputs.size;++e)e>0&&(t+=", "),t+=this._outputs.get(e).to.identifier;return t+="]"}},{key:"match",set:function(t){this._match!==t&&(this._match=t,void 0===this._match?this.graph.deleteMatch(this):this.graph.addMatch(this,t))},get:function(){return this._match}}])&&xu(e.prototype,n),r&&xu(e,r),t}();function Lu(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Du(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Du(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Du(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Uu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ju(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wu=function(){function t(e){Uu(this,t),this.graph=e;for(var n=new Set,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(var a=0,u=i;a<u.length;a++){var s=u[a];if(s instanceof Pu)n.add(s);else{var c,l=Lu(s);try{for(l.s();!(c=l.n()).done;){var f=c.value;n.add(f)}}catch(h){l.e(h)}finally{l.f()}}}0===n.size&&n.add(e.start),this._origin=n,this._input=void 0}var e,n,r;return e=t,(n=[{key:"origin",value:ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._origin.values());case 1:case"end":return t.stop()}}),t,this)}))},{key:"input",value:function(){if(this._origin.size>1){if(this._input)return this._input;var t,e=this.graph.state(),n=Lu(this._origin);try{for(n.s();!(t=n.n()).done;)t.value.epsilon(e)}catch(r){n.e(r)}finally{n.f()}return this._input=e,e}return this._origin.values().next().value}},{key:"then",value:function(e){var n=this.graph.state();return this.input().output(n,e),new t(this.graph,n)}},{key:"match",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.graph.state();e.match=t;var n,r=Lu(this._origin);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.epsilon(e)}}catch(o){r.e(o)}finally{r.f()}return this.graph}},{key:"many",value:function(e){var n=this.graph.state(),r=this.input();return r.output(n,e),r.epsilon(n),n.epsilon(r),new t(this.graph,n)}},{key:"optional",value:function(e){var n=this.graph.state(),r=this.input();return r.output(n,e),r.epsilon(n),new t(this.graph,n)}},{key:"atLeast",value:function(e,n){for(var r=this.input(),i=0;i<n;++i){var o=this.graph.state();r.output(o,e),r=o}return new t(this.graph,r)}},{key:"upTo",value:function(e,n){for(var r=this.graph.state(),i=this.input(),o=0;o<n-1;++o){var a=this.graph.state();i.output(a,e),i.epsilon(r),i=a}return i.output(r,e),i.epsilon(r),new t(this.graph,r)}},{key:"range",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY,r=this;return e>0&&(r=r.atLeast(t,e)),r=n===Number.POSITIVE_INFINITY?r.many(t):r.upTo(t,n-e)}},{key:"any",value:function(){for(var e=this.graph.state(),n=this.input(),r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];for(var a=0,u=i;a<u.length;a++){var s=u[a];n.output(e,s)}return new t(this.graph,e)}}])&&ju(e.prototype,n),r&&ju(e,r),t}();function Mu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(e){return new t(e)}}(Wu||(Wu={}));var Fu=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._states=U.Pack.any(2),this.states=this._states.view(),this._relationships=U.Pack.any(0),this.relationships=this._relationships.view(),this._matchs=new U.NativeSet(new Set),this.start=new Pu(this),this.matchs=this._matchs.view()}var e,n,r;return e=t,(n=[{key:"addMatch",value:function(t,e){this._matchs.add(t),t.match=e}},{key:"deleteMatch",value:function(t){this._matchs.delete(t),t.match=void 0}},{key:"addState",value:function(t){if(t.graph!==this)throw new Error("Unable to add the given state to this graph as it was instantiated for another graph. #addState is a method that must be called at the right time, please do not use it if you do not know exactly what you are doing.");if(void 0===t.identifier){var e=this._states.size;return this._states.push(t),e}return t.identifier}},{key:"addRelationship",value:function(t){if(t.from.graph!==this)throw new Error("Unable to add the given relationship to this graph as it was instantiated for another graph. #addRelationship is a method that must be called at the right time, please do not use it if you do not know exactly what you are doing.");if(void 0===t.identifier){var e=this._relationships.size;return this._relationships.push(t),e}return t.identifier}},{key:"state",value:function(){return new Pu(this)}},{key:"builder",value:function(){return new Wu(this)}}])&&Mu(e.prototype,n),r&&Mu(e,r),t}();function Gu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.MATCH=(new t).builder().match()}(Fu||(Fu={}));var zu=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.process=yu.validateEpsilon(),this.head=Ru.ALLOCATOR.allocate().asHead(),this.relationship=0}var e,n,r;return e=t,(n=[{key:"push",value:function(t){var e=this.head;return this.head=Ru.ALLOCATOR.allocate().asHead(),e.asEvent(t),this.head.parent=e,this}},{key:"clear",value:function(){this.process=yu.validateEpsilon(),this.relationship=0;var t=this.head;this.head=Ru.ALLOCATOR.allocate().asHead(),Ru.cut(t)}}])&&Gu(e.prototype,n),r&&Gu(e,r),t}();function Bu(t){return(Bu="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hu(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Vu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vu(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Vu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yu(t,e){return(Yu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ku(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zu(t);if(e){var i=Zu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Xu(this,n)}}function Xu(t,e){return!e||"object"!==Bu(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zu(t){return(Zu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){function e(){return new t}t.create=e,t.ALLOCATOR=U.Allocator.fromFactory(e)}(zu||(zu={}));var $u,Ju=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yu(t,e)}(o,t);var e,n,r,i=Ku(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._graph=Fu.MATCH,t._visited=new Map,t._pendingStack=U.Pack.any(16),t._nextPendingStack=U.Pack.any(16),t._matchs=U.Pack.any(16),t._failures=U.Pack.any(16),t._tree=new Ru,t._current=void 0,t._output=new Ta,t}return e=o,(n=[{key:"validate",value:function(t){this.reset(),this._graph=t;var e=t.start,n=this._tree.fork().asState(e);this._visited.set(e.identifier,n);var r,i=Hu(e.outputs);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=zu.ALLOCATOR.allocate();a.head.parent=n,a.process=o.validator(),this._pendingStack.push(a)}}catch(u){i.e(u)}finally{i.f()}}},{key:"isLeftBetterThanRight",value:function(t,e){var n=t.countMessages(),r=t.batch(),i=e.countMessages(),o=e.batch();if(r===o){for(var a=na.ALL.length,u=0;u<a;++u){var s=n[a-u-1],c=i[a-u-1];if(s!==c)return s<c}return!0}return r>o}},{key:"handleInitialization",value:function(){for(var t=this._pendingStack,e=this._nextPendingStack;t.size>0;)this.continueProcess(this._pendingStack.pop());this._pendingStack=e,this._nextPendingStack=t,this._visited.clear(),this._matchs.size>0?this.handleGraphMatch():0===this._pendingStack.size?this.handleGraphError():this.dump()}},{key:"handleProduction",value:function(t){this.dumpFailures();var e=this._pendingStack,n=this._nextPendingStack;for(this._current=t;e.size>0;)this.continueProcess(this._pendingStack.pop());this._pendingStack=n,this._nextPendingStack=e,this._visited.clear(),this._matchs.size>0?this.handleGraphMatch():0===this._pendingStack.size?this.handleGraphError():this.dump()}},{key:"continueProcess",value:function(t){for(var e=t.process,n=this._current,r=n?e.next(n):e.next();!r.done;)switch(r.value.type){case Wa.CURRENT:if(n){r=e.next(n);break}case Wa.NEXT:return void this._nextPendingStack.push(t);case Wa.EMIT:if(t.push(r.value.event),r.value.event.isMessage()&&r.value.event.message.isFailure())return void this._failures.push(t);r=e.next();break;case Wa.MATCH:this.handleProcessMatch(t),r=e.next(void 0);break;case Wa.END:throw new Error("Unable to continue a validation process because it's related KISS validator yielded an end signal. An end signal must only be returned as it will explicitely stop the occuring validation process.");default:throw new Error("Unable to handle kiss validator output of type "+Wa.toDebugString(r.value.type)+" because no procedure was defined for that.")}if(r.value.isMatch())this.handleProcessMatch(t);else{if(!r.value.isEnd())throw new Error("Unable to continue a validation process because it's related KISS validator ended without returning a match nor an end signal.");this._failures.push(t)}}},{key:"handleCompletion",value:function(){this.dumpFailures();var t=this._pendingStack;for(this._current=void 0;t.size>0;)this.terminateProcess(this._pendingStack.pop());this._matchs.size>0?(this.dumpFailures(),this.handleGraphMatch()):this.handleGraphError()}},{key:"dumpFailures",value:function(){for(var t=this._failures;t.size>0;)zu.ALLOCATOR.free(t.pop())}},{key:"handleGraphMatch",value:function(){for(var t=this._matchs.pop();this._matchs.size>0;){var e=this._matchs.pop();this.isLeftBetterThanRight(e.head,t.head)?(zu.ALLOCATOR.free(t),t=e):zu.ALLOCATOR.free(e)}this.dump(),this._output.complete(),t.head.parent=null,zu.ALLOCATOR.free(t)}},{key:"handleGraphError",value:function(){var t=this._failures;if(t.size>0){for(var e=t.pop();t.size>0;){var n=t.pop();this.isLeftBetterThanRight(n.head,e.head)?(zu.ALLOCATOR.free(e),e=n):zu.ALLOCATOR.free(n)}this.dump(),this._output.complete(),e.head.parent=null,zu.ALLOCATOR.free(e)}else this.dump(),this._output.complete()}},{key:"dump",value:function(){for(var t=this._tree;1===t.children.size;){var e=t.children.first;if(e.isHead())return;e.isEvent()&&this._output.produce(e.event),e.delete(),Ru.ALLOCATOR.free(e)}}},{key:"terminateProcess",value:function(t){for(var e=t.process,n=e.next();!n.done;)switch(n.value.type){case Wa.CURRENT:n=e.next(void 0);break;case Wa.NEXT:throw new Error("Unable to terminate a validation process because it's related KISS validator requested the next available event after the reception of the end of document.");case Wa.EMIT:if(t.push(n.value.event),n.value.event.isMessage()&&n.value.event.message.isFailure())return void this._failures.push(t);n=e.next();break;case Wa.MATCH:this.handleProcessMatch(t),n=e.next();break;case Wa.END:throw new Error("Unable to terminate a validation process because it's related KISS validator yielded an end signal. An end signal must only be returned as it will explicitely stop the occuring validation process.");default:throw new Error("Unable to handle kiss validator output of type "+Wa.toDebugString(n.value.type)+" because no procedure was defined for that.")}if(n.value.isMatch())this.handleProcessMatch(t);else{if(!n.value.isEnd())throw new Error("Unable to terminate a validation process because it's related KISS validator ended without returning a match nor an end signal.");this._failures.push(t)}}},{key:"handleFailure",value:function(t){this._output.fail(t)}},{key:"handleProcessMatch",value:function(t){var e=this._graph.relationships.get(t.relationship).to;if(e.isMatch())this._matchs.push(t);else{var n=this._visited.get(e.identifier);if(n){if(!t.head.isUpward(n)){var r=n.parent,i=t.head.parent;t.head.parent=null,this.isLeftBetterThanRight(i,r)&&(n.parent=i,Ru.cut(r))}zu.ALLOCATOR.free(t)}else{n=t.head.parent.fork().asState(e),this._visited.set(e.identifier,n);for(var o=1;o<e.outputs.size;++o){var a=e.outputs.get(o),u=zu.ALLOCATOR.allocate();u.head.parent=n,u.relationship=a.identifier,u.process=a.validator(),this._pendingStack.push(u)}var s=e.outputs.get(0);t.head.parent=n,t.relationship=s.identifier,t.process=s.validator(),this._pendingStack.push(t)}}}},{key:"reset",value:function(){this._matchs.clear(),this._visited.clear(),this._pendingStack.clear(),Ru.trash(this._tree),this._current=void 0}},{key:"addEventListener",value:function(t,e){this._output.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this._output.removeEventListener(t,e)}},{key:"removeAllEventListener",value:function(){var t;(t=this._output).removeAllEventListener.apply(t,arguments)}}])&&qu(e.prototype,n),r&&qu(e,r),o}(dt);!function(t){t.kiss=function(t){return new ku(t)},t.graph=function(t){var e=new Ju;return e.validate(t),e}}($u||($u={}));var Qu=n(435);function ts(t){return(ts="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function es(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return ns(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ns(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function ns(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function rs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function is(t,e){return(is=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function os(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ss(t);if(e){var i=ss(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return as(this,n)}}function as(t,e){return!e||"object"!==ts(e)&&"function"!==typeof e?us(t):e}function us(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ss(t){return(ss=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cs=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&is(t,e)}(o,t);var e,n,r,i=os(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).handleRxSubscription=t.handleRxSubscription.bind(us(t)),t._subscribers=new Set,t.observable=new Qu.Observable(t.handleRxSubscription),t}return e=o,(n=[{key:"handleRxSubscription",value:function(t){this._subscribers.add(t)}},{key:"handleInitialization",value:function(){}},{key:"handleProduction",value:function(t){var e,n=es(this._subscribers);try{for(n.s();!(e=n.n()).done;)e.value.next(t)}catch(r){n.e(r)}finally{n.f()}}},{key:"handleCompletion",value:function(){var t,e=es(this._subscribers);try{for(e.s();!(t=e.n()).done;)t.value.complete()}catch(n){e.e(n)}finally{e.f()}}},{key:"handleFailure",value:function(t){var e,n=es(this._subscribers);try{for(n.s();!(e=n.n()).done;)e.value.error(t)}catch(r){n.e(r)}finally{n.f()}}}])&&rs(e.prototype,n),r&&rs(e,r),o}(dt);function ls(t){return function(e){t.subscribe(new Ai(e));var n=new cs;return n.subscribe(t),n.observable}}function fs(t){var e=new jr,n=new ei,r=new _o;return e.subscribe(t),n.subscribe(e),r.subscribe(n),r.importations.addEventListener(pt.PRODUCTION,t.import.bind(t)),r.importations.addEventListener(pt.FAILURE,t.fail.bind(t)),r}function hs(t){var e=new ei;return e.subscribe(t),e}function ps(t){var e=new jr;return e.subscribe(t),e}},666:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(C){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof d?e:d,o=Object.create(i.prototype),a=new I(r||[]);return o._invoke=function(t,e,n){var r=f;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===y){if("throw"===i)throw o;return N()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var u=A(a,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var s=l(t,e,n);if("normal"===s.type){if(r=n.done?y:h,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=y,n.method="throw",n.arg=s.arg)}}}(t,n,a),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=c;var f="suspendedStart",h="suspendedYield",p="executing",y="completed",v={};function d(){}function b(){}function m(){}var E={};E[o]=function(){return this};var g=Object.getPrototypeOf,_=g&&g(g(R([])));_&&_!==n&&r.call(_,o)&&(E=_);var T=m.prototype=d.prototype=Object.create(E);function k(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(i,o,a,u){var s=l(t[i],t,o);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"===typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var i;this._invoke=function(t,r){function o(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(o,o):o()}}function A(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function w(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function R(t){if(t){var n=t[o];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:N}}function N(){return{value:e,done:!0}}return b.prototype=T.constructor=m,m.constructor=b,b.displayName=s(m,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,s(t,u,"GeneratorFunction")),t.prototype=Object.create(T),t},t.awrap=function(t){return{__await:t}},k(S.prototype),S.prototype[a]=function(){return this},t.AsyncIterator=S,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new S(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(T),s(T,u,"Generator"),T[o]=function(){return this},T.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=R,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return u.type="throw",u.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:R(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=e}catch(n){Function("r","regeneratorRuntime = r")(e)}},332:e=>{"use strict";e.exports=t},435:t=>{"use strict";t.exports=e}},r={};function i(t){if(r[t])return r[t].exports;var e=r[t]={exports:{}};return n[t](e,e.exports,i),e.exports}return i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i(211)})()},t.exports=r(n("3Vbp"),n("DtyJ"))}}]);