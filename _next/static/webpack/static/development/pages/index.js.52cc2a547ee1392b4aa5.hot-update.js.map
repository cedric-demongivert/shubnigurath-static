{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.52cc2a547ee1392b4aa5.hot-update.js","sources":["webpack:///./typescript/Value.ts"],"sourcesContent":["import { List } from 'immutable'\r\n\r\nimport { Modifier } from './Modifier'\r\nimport { Empty } from './utils'\r\n\r\n/**\r\n * \r\n */\r\nconst VANILLA_PROPERTIES = { base: 0 }\r\n\r\nfunction vanilla(value: number): Value.Properties {\r\n  VANILLA_PROPERTIES.base = value\r\n  return VANILLA_PROPERTIES\r\n}\r\n\r\n/**\r\n * \r\n */\r\nexport class Value {\r\n  /**\r\n   * \r\n   */\r\n  public readonly base: number | undefined\r\n\r\n  /**\r\n   * \r\n   */\r\n  public readonly modifiers: List<Modifier>\r\n\r\n  /**\r\n   * \r\n   */\r\n  private static ZERO: Value = new Value(vanilla(0))\r\n\r\n  /**\r\n   * \r\n   */\r\n  private static EMPTY: Value = new Value()\r\n\r\n  /**\r\n   * \r\n   */\r\n  public static create(properties?: Value.Properties | number | undefined): Value {\r\n    if (properties == null) {\r\n      return Value.EMPTY\r\n    } else if (typeof properties === 'number') {\r\n      return properties === 0 ? Value.ZERO : new Value(vanilla(properties))\r\n    } else {\r\n      return new Value(properties)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public static zero(): Value {\r\n    return Value.ZERO\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public static empty(): Value {\r\n    return Value.EMPTY\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  private constructor(properties: Value.Properties = Empty.OBJECT) {\r\n    this.base = properties.base\r\n    this.modifiers = properties.modifiers || List()\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public levelup(): Value {\r\n    const sum: number = this.sum()\r\n\r\n    if (sum >= 99) {\r\n      return this\r\n    }\r\n\r\n    const roll: number = (Math.random() * 100 + 1) << 0\r\n\r\n    if (roll > sum) {\r\n      const upgrade: number = (Math.random() * 10 + 1) << 0\r\n\r\n      return Value.create({\r\n        base: this.base,\r\n        modifiers: List.of(\r\n          ...this.modifiers,\r\n          Modifier.create({\r\n            value: Math.min(upgrade, 99 - sum),\r\n            label: 'Gain d\\'expÃ©rience (' + roll + ' vs ' + sum + ')'\r\n          })\r\n        )\r\n      })\r\n    } else {\r\n      return this\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public sum(): number {\r\n    let result: number = this.base || 0\r\n\r\n    for (const modifier of this.modifiers) {\r\n      result += modifier.value\r\n    }\r\n\r\n    return result\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public half(): number {\r\n    return this.sum() >> 1\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public fifth(): number {\r\n    return (this.sum() / 5) << 0\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public toString() {\r\n    return this.sum() + ' / ' + this.half() + ' / ' + this.fifth()\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public equals(other: any): boolean {\r\n    if (other == null) return false\r\n    if (other === this) return true\r\n\r\n    if (other instanceof Value) {\r\n      return (\r\n        other.base === this.base &&\r\n        other.modifiers.equals(this.modifiers)\r\n      )\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public [Symbol.toPrimitive](): number {\r\n    return this.sum()\r\n  }\r\n}\r\n\r\n/**\r\n * \r\n */\r\nexport namespace Value {\r\n  /**\r\n   * \r\n   */\r\n  export type Properties = {\r\n    /**\r\n     * \r\n     */\r\n    readonly base?: number | undefined,\r\n\r\n    /**\r\n     * \r\n     */\r\n    readonly modifiers?: List<Modifier> | undefined\r\n  }\r\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAyIA;AA1IA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAvBA;AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AArCA;AAAA;AAAA;AAsCA;AACA;AAEA;AACA;AACA;AACA;AA5CA;AAAA;AAAA;AA6CA;AACA;AAEA;AACA;AACA;AACA;AAnDA;AACA;AAkDA;AAAA;AACA;AADA;AACA;AADA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AA5DA;AAAA;AAAA;AA4DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGA;AACA;AAFA;AAJA;AAUA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAzFA;AAAA;AAAA;AA0FA;AACA;AAFA;AAAA;AACA;AADA;AAGA;AAAA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AACA;AAMA;AACA;AAEA;AACA;AACA;AACA;AAtGA;AAAA;AAAA;AAuGA;AACA;AAEA;AACA;AACA;AACA;AA7GA;AAAA;AAAA;AA8GA;AACA;AAEA;AACA;AACA;AACA;AApHA;AAAA;AAAA;AAqHA;AACA;AAEA;AACA;AACA;AACA;AA3HA;AAAA;AAAA;AA4HA;AACA;AACA;AACA;AACA;AAIA;AACA;AAEA;AACA;AACA;AACA;AA1IA;AAAA;AAAA;AA2IA;AACA;AA5IA;AACA;AADA;AAAA;AA+IA;AACA;AACA;AACA;AAlJA;AAAA;AACA;AAiJA;;;;A","sourceRoot":""}