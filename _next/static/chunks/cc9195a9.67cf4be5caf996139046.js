(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[6],{EZz0:function(t,e,n){var r;r=function(t){return(()=>{var e={757:(t,e,n)=>{t.exports=n(666)},908:(t,e,n)=>{"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e),n.d(e,{CodePoint:()=>fe,Data:()=>Ot,DataEvent:()=>Pt,DataEventCompiler:()=>re,DataEventProducer:()=>he,DataEventType:()=>It,DataPath:()=>xt,UnidocAnyPredicate:()=>p,UnidocAnythingPredicate:()=>v,UnidocBlueprint:()=>st,UnidocBlueprintType:()=>D,UnidocBlueprintVisitor:()=>yt,UnidocBuffer:()=>kt,UnidocBufferOrigin:()=>de,UnidocBufferizer:()=>St,UnidocContext:()=>Ti,UnidocDisjunctionBlueprint:()=>F,UnidocEndBlueprint:()=>G,UnidocEvent:()=>Ye,UnidocEventBlueprint:()=>H,UnidocEventProducer:()=>Fi,UnidocEventType:()=>S,UnidocFragmentResolver:()=>Wr,UnidocFunction:()=>Yt,UnidocGenerator:()=>ir,UnidocGeneratorSource:()=>Yo,UnidocGroupBlueprint:()=>K,UnidocImportation:()=>Ir,UnidocImportationFilter:()=>ei,UnidocImportationProducer:()=>Vr,UnidocImportationResolver:()=>Ar,UnidocKissValidator:()=>Fs,UnidocKissValidatorOutput:()=>ps,UnidocKissValidatorOutputBuilder:()=>Ms,UnidocKissValidatorOutputType:()=>cs,UnidocKissValidatorResolver:()=>Ys,UnidocLenientSequenceBlueprint:()=>Z,UnidocLexer:()=>io,UnidocLexerState:()=>Ki,UnidocListener:()=>dt,UnidocLocation:()=>Ae,UnidocLocationTracker:()=>$n,UnidocLocationTrackerState:()=>Yn,UnidocManyBlueprint:()=>Q,UnidocMatchPredicate:()=>b,UnidocNFAValidationGraph:()=>ou,UnidocNFAValidationGraphBuilder:()=>nu,UnidocNFAValidationGraphResolver:()=>ku,UnidocNFAValidationRelationship:()=>Xs,UnidocNFAValidationState:()=>Zs,UnidocNetworkOrigin:()=>ge,UnidocNullResolver:()=>li,UnidocNullSymbolGenerator:()=>Tr,UnidocOnlyPredicate:()=>c,UnidocOperator:()=>ea,UnidocOrigin:()=>Ce,UnidocOriginElement:()=>Oe,UnidocOriginElementType:()=>le,UnidocParser:()=>ko,UnidocParserState:()=>uo,UnidocPath:()=>Fo,UnidocPathElement:()=>Oo,UnidocPathElementType:()=>Eo,UnidocPredicate:()=>P,UnidocProducerEvent:()=>pt,UnidocPublisher:()=>Ft,UnidocRangeOrigin:()=>je,UnidocRangeOriginBuilder:()=>De,UnidocReducer:()=>Hn,UnidocReductionExecutor:()=>sn,UnidocReductionInput:()=>$e,UnidocReductionInputBuilder:()=>fn,UnidocReductionInputType:()=>ze,UnidocReductionRequest:()=>Xe,UnidocRegexpBlueprint:()=>nt,UnidocResource:()=>Rr,UnidocResourceOrigin:()=>Ee,UnidocRuntimeEventProducer:()=>xi,UnidocRuntimeOrigin:()=>Te,UnidocRuntimeTokenProducer:()=>la,UnidocSequenceBlueprint:()=>q,UnidocSetBlueprint:()=>ot,UnidocSink:()=>Wt,UnidocSource:()=>qo,UnidocSourceState:()=>jo,UnidocStringSymbolGenerator:()=>pr,UnidocSuccessSkipper:()=>na,UnidocSymbol:()=>Kn,UnidocSymbolGenerator:()=>_r,UnidocTagBlueprint:()=>ct,UnidocTextOrigin:()=>Re,UnidocToken:()=>Vi,UnidocTokenBuffer:()=>_a,UnidocTokenBuilder:()=>Xi,UnidocTokenProducer:()=>Ra,UnidocTokenType:()=>ji,UnidocValidationEvent:()=>ja,UnidocValidationEventBuilder:()=>Ma,UnidocValidationEventProducer:()=>Ya,UnidocValidationEventType:()=>an,UnidocValidationMessage:()=>Ua,UnidocValidationMessageBuilder:()=>Ja,UnidocValidationMessageType:()=>Oa,UnidocValidationToReductionTranslator:()=>bn,UnidocValidator:()=>Tu,fullyParse:()=>Su,parse:()=>Au,skipSuccess:()=>ra,tokenize:()=>wu});var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"select",value:function(t){return t.tag}},{key:"toString",value:function(){return"tag name"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&r(e.prototype,n),i&&r(e,i),t}();function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(i||(i={}));var a,s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"select",value:function(t){return t.text}},{key:"toString",value:function(){return"content"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&o(e.prototype,n),r&&o(e,r),t}();function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(s||(s={})),function(t){t.tagName=function(){return i.INSTANCE},t.content=function(){return s.INSTANCE}}(a||(a={}));var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return t===this.value}},{key:"toString",value:function(){return"only("+this.value+")"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.value===this.value)}}])&&u(e.prototype,n),r&&u(e,r),t}();function f(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._values=new Set;var n,r=f(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this._values.add(i)}}catch(o){r.e(o)}finally{r.f()}}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return this._values.has(t)}},{key:"toString",value:function(){var t="$any(",e=this._values.values(),n=e.next();for(n.done||(t+=n.value);!(n=e.next()).done;)t+=", ",t+=n.value;return t+=")"}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e._values.size!==this._values.size)return!1;var n,r=f(this._values);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!e._values.has(i))return!1}}catch(o){r.e(o)}finally{r.f()}return!0}return!1}}])&&h(e.prototype,n),r&&h(e,r),t}();function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return!0}},{key:"toString",value:function(){return"$anything"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&y(e.prototype,n),r&&y(e,r),t}();function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t}(v||(v={}));var b=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.regexp=e}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return this.regexp.test(t)}},{key:"toString",value:function(){return"$match("+this.regexp.toString()+")"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.regexp===this.regexp)}}])&&d(e.prototype,n),r&&d(e,r),t}();function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var m=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.selector=e,this.predicate=n}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return this.predicate.test(this.selector.select(t))}},{key:"toString",value:function(){return this.selector.toString()+" is "+this.predicate.toString()}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.selector.equals(e.selector)&&this.predicate.equals(e.predicate))}}])&&g(e.prototype,n),r&&g(e,r),t}();function E(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){if(t){if("string"===typeof t)return T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(t,e):void 0}}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var S,A=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.predicates=E(e)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){var e,n=function(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=_(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this.predicates);try{for(n.s();!(e=n.n()).done;)if(!e.value.test(t))return!1}catch(r){n.e(r)}finally{n.f()}return!0}},{key:"toString",value:function(){if(0===this.predicates.length)return"true";var t="(",e=this.predicates.values(),n=e.next();for(n.done||(t+=n.value.toString());!(n=e.next()).done;)t+=" and ",t+=n.value.toString();return t+=")"}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.predicates.length!==this.predicates.length)return!1;for(var n=0;n<this.predicates.length;++n)if(!e.predicates[n].equals(this.predicates[n]))return!1;return!0}return!1}}])&&k(e.prototype,n),r&&k(e,r),t}();function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(e){switch(e){case t.START_TAG:return"START_TAG";case t.END_TAG:return"END_TAG";case t.WHITESPACE:return"WHITESPACE";case t.WORD:return"WORD";default:return}}t.TAG=0,t.WHITESPACE=4,t.WORD=6,t.START=0,t.END=1,t.DEFAULT_TYPE=0,t.START_TAG=t.START|t.TAG,t.END_TAG=t.END|t.TAG,t.ALL=[t.START_TAG,t.END_TAG,t.WHITESPACE,t.WORD],t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(S||(S={}));var I=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return t.type===S.START_TAG}},{key:"toString",value:function(){return"is start of tag"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&w(e.prototype,n),r&&w(e,r),t}();function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(I||(I={}));var R=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return t.type===S.END_TAG}},{key:"toString",value:function(){return"is end of tag"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&O(e.prototype,n),r&&O(e,r),t}();function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(R||(R={}));var x=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return t.type===S.WORD}},{key:"toString",value:function(){return"is word"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&N(e.prototype,n),r&&N(e,r),t}();function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(x||(x={}));var P,L=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"test",value:function(t){return t.type===S.WHITESPACE}},{key:"toString",value:function(){return"is whitespace"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}}])&&C(e.prototype,n),r&&C(e,r),t}();!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(L||(L={})),function(t){t.is=function(t,e){return new m(t,e)},t.isWhitespace=function(){return L.create()},t.isWord=function(){return x.create()},t.isTagStart=function(){return I.create()},t.isTagEnd=function(){return R.create()},t.and=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new A(e)},t.only=function(t){return new c(t)},t.any=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new p(e)},t.anything=function(){return v.INSTANCE},t.match=function(t){return new b(t)}}(P||(P={}));var D,U=n(332);function W(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(e){switch(e){case t.EVENT:return"EVENT";case t.MANY:return"MANY";case t.DISJUNCTION:return"DISJUNCTION";case t.SET:return"SET";case t.SEQUENCE:return"SEQUENCE";case t.LENIENT_SEQUENCE:return"LENIENT_SEQUENCE";case t.END:return"END";case t.TAG:return"TAG";case t.GROUP:return"GROUP";case t.REGEXP:return"REGEXP";default:return}}t.EVENT=1,t.MANY=2,t.DISJUNCTION=3,t.SET=4,t.SEQUENCE=5,t.LENIENT_SEQUENCE=6,t.END=7,t.TAG=8,t.GROUP=9,t.REGEXP=10,t.DEFAULT=t.EVENT,t.ALL=[t.EVENT,t.MANY,t.DISJUNCTION,t.SET,t.SEQUENCE,t.LENIENT_SEQUENCE,t.END,t.TAG,t.GROUP,t.REGEXP],t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(D||(D={}));var F=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;W(this,t),this.type=D.DISJUNCTION,this.operands=U.Pack.any(e)}var e,n,r;return e=t,(n=[{key:"or",value:function(t){return this.operands.push(t),this}},{key:"clear",value:function(){this.operands.clear()}},{key:"copy",value:function(t){this.operands.copy(t.operands)}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.operands.size!==this.operands.size)return!1;var r=n||new Set;if(!r.has(this)){r.add(this);for(var i=0;i<this.operands.size;++i)if(!this.operands.get(i).equals(e.operands.get(i),r))return!1}return!0}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"> @"+n.get(this);n.set(this,n.size.toString());var r="+ ";if(r+=n.get(this),r+=": ",r+=this.constructor.name,t>0||0===this.operands.size)for(var i=0;i<this.operands.size;++i)r+="\r\n\t",r+=this.operands.get(i).toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t");else r+="\r\n\t...";return r+="\r\n",r+="- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&j(e.prototype,n),r&&j(e,r),t}();function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(F||(F={}));var G=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.END}var e,n,r;return e=t,(n=[{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t)}},{key:"toString",value:function(){return"| "+this.constructor.name}}])&&M(e.prototype,n),r&&M(e,r),t}();function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(G||(G={}));var H=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.EVENT,this.predicate=P.anything()}var e,n,r;return e=t,(n=[{key:"thatMatch",value:function(t){return this.predicate=t,this}},{key:"copy",value:function(t){this.predicate=t.predicate}},{key:"clear",value:function(){this.predicate=P.anything()}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.predicate.equals(e.predicate))}},{key:"toString",value:function(){return"| "+this.constructor.name+" "+this.predicate.toString()}}])&&B(e.prototype,n),r&&B(e,r),t}();function z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(H||(H={}));var q=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;z(this,t),this.type=D.SEQUENCE,this.operands=U.Pack.any(e)}var e,n,r;return e=t,(n=[{key:"then",value:function(t){return this.operands.push(t),this}},{key:"copy",value:function(t){this.operands.copy(t.operands)}},{key:"clear",value:function(){this.operands.clear()}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.operands.size!==this.operands.size)return!1;var r=n||new Set;if(!r.has(this)){r.add(this);for(var i=0;i<this.operands.size;++i)if(!this.operands.get(i).equals(e.operands.get(i),r))return!1}return!0}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";if(r+=n.get(this),r+=": ",r+=this.constructor.name,t>0||0===this.operands.size)for(var i=0;i<this.operands.size;++i)r+="\r\n\t",r+=this.operands.get(i).toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t");else r+="\r\n\t...";return r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&V(e.prototype,n),r&&V(e,r),t}();function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.EMPTY_SEQUENCE=new t(0),t.empty=function(){return t.EMPTY_SEQUENCE},t.create=function(){return new t}}(q||(q={}));var K=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.GROUP,this.group=0,this.operand=q.empty()}var e,n,r;return e=t,(n=[{key:"of",value:function(t){return this.operand=t,this}},{key:"as",value:function(t){return this.group=t,this}},{key:"copy",value:function(t){this.group=t.group,this.operand=t.operand}},{key:"clear",value:function(){this.group=0,this.operand=q.empty()}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(this.group!==e.group)return!1;var r=n||new Set;return!(!r.has(this)&&(r.add(this),!this.operand.equals(e.operand,r)))}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";return r+=n.get(this),r+=": ",r+=this.constructor.name,r+=" as ",r+=this.group,t>0?(r+="\r\n\t",r+=this.operand.toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t")):r+="\r\n\t...",r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&Y(e.prototype,n),r&&Y(e,r),t}();function X(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(K||(K={}));var Z=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;X(this,t),this.type=D.LENIENT_SEQUENCE,this.operands=U.Pack.any(e)}var e,n,r;return e=t,(n=[{key:"then",value:function(t){return this.operands.push(t),this}},{key:"clear",value:function(){this.operands.clear()}},{key:"copy",value:function(t){this.operands.copy(t.operands)}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.operands.size!==this.operands.size)return!1;var r=n||new Set;if(!r.has(this)){r.add(this);for(var i=0;i<this.operands.size;++i)if(!this.operands.get(i).equals(e.operands.get(i),r))return!1}return!0}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";if(r+=n.get(this),r+=": ",r+=this.constructor.name,t>0||0===this.operands.size)for(var i=0;i<this.operands.size;++i)r+="\r\n\t",r+=this.operands.get(i).toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t");else r+="\r\n\t...";return r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&$(e.prototype,n),r&&$(e,r),t}();function J(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(Z||(Z={}));var Q=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.MANY,this.minimum=0,this.maximum=Number.POSITIVE_INFINITY,this.operand=q.empty()}var e,n,r;return e=t,(n=[{key:"between",value:function(t,e){return this.minimum=t,this.maximum=e,this}},{key:"optional",value:function(){return this.minimum=0,this.maximum=1,this}},{key:"atLeast",value:function(t){return this.minimum=t,this}},{key:"upTo",value:function(t){return this.maximum=t,this}},{key:"of",value:function(t){return this.operand=t,this}},{key:"copy",value:function(t){this.minimum=t.minimum,this.maximum=t.maximum,this.operand=t.operand}},{key:"clear",value:function(){this.minimum=0,this.maximum=Number.POSITIVE_INFINITY,this.operand=q.empty()}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(this.minimum!==e.minimum||this.maximum!==e.maximum)return!1;var r=n||new Set;return!(!r.has(this)&&(r.add(this),!this.operand.equals(e.operand,r)))}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";return r+=n.get(this),r+=": ",r+=this.constructor.name,r+=" between ",r+=this.minimum,r+=" and ",r+=this.maximum,t>0?(r+="\r\n\t",r+=this.operand.toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t")):r+="\r\n\t...",r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&J(e.prototype,n),r&&J(e,r),t}();function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(Q||(Q={}));var et=/.*/,nt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.REGEXP,this.regexp=et}var e,n,r;return e=t,(n=[{key:"thatMatch",value:function(t){return this.regexp=t,this}},{key:"copy",value:function(t){this.regexp=t.regexp}},{key:"clear",value:function(){this.regexp=et}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.regexp===e.regexp)}},{key:"toString",value:function(){return"| "+this.constructor.name+" "+this.regexp.toString()}}])&&tt(e.prototype,n),r&&tt(e,r),t}();function rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(nt||(nt={}));var ot=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;rt(this,t),this.type=D.SET,this.operands=U.Pack.any(e)}var e,n,r;return e=t,(n=[{key:"with",value:function(t){return this.operands.push(t),this}},{key:"copy",value:function(t){this.operands.copy(t.operands)}},{key:"clear",value:function(){this.operands.clear()}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.operands.size!==this.operands.size)return!1;var r=n||new Set;if(!r.has(this)){r.add(this);for(var i=0;i<this.operands.size;++i)if(!this.operands.get(i).equals(e.operands.get(i),r))return!1}return!0}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";if(r+=n.get(this),r+=": ",r+=this.constructor.name,t>0||0===this.operands.size)for(var i=0;i<this.operands.size;++i)r+="\r\n\t",r+=this.operands.get(i).toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t");else r+="\r\n\t...";return r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&it(e.prototype,n),r&&it(e,r),t}();function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(ot||(ot={}));var st,ut,ct=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=D.TAG,this.predicate=P.anything(),this.operand=q.empty()}var e,n,r;return e=t,(n=[{key:"thatMatch",value:function(t){return this.predicate=t,this}},{key:"withContent",value:function(t){return this.operand=t,this}},{key:"copy",value:function(t){this.predicate=t.predicate,this.operand=t.operand}},{key:"clear",value:function(){this.predicate=P.anything(),this.operand=q.empty()}},{key:"equals",value:function(e,n){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(!e.predicate.equals(e.predicate))return!1;var r=n||new Set;return!(!r.has(this)&&(r.add(this),this.operand.equals(e.operand,r)))}return!1}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,e=arguments.length>1?arguments[1]:void 0,n=e||new Map;if(n.has(this))return"| @"+n.get(this);n.set(this,n.size.toString());var r="+ ";return r+=n.get(this),r+=": ",r+=this.constructor.name,r+=" ",r+=this.predicate.toString(),t>0?(r+="\r\n\t",r+=this.operand.toString(t-1,n).replace(/^(\r\n|\r|\n)/gm,"$1\t")):r+="\r\n\t...",r+="\r\n- ",r+=n.get(this),r+=": ",r+=this.constructor.name}}])&&at(e.prototype,n),r&&at(e,r),t}();function ft(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return lt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(ct||(ct={})),function(t){function e(t){var e=H.create();return t&&e.thatMatch(t),e}function n(){for(var t=q.create(),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(n){var i,o=ft(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.then(a)}}catch(s){o.e(s)}finally{o.f()}}return t}t.disjunction=function(){for(var t=F.create(),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(n){var i,o=ft(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.or(a)}}catch(s){o.e(s)}finally{o.f()}}return t},t.end=G.create,t.event=e,t.many=function(t){var e=Q.create();return t&&e.of(t),e},t.group=function(t,e){var n=K.create();return n.as(t),e&&n.of(e),n},t.optional=function(t){var e=Q.create();return e.optional(),t&&e.of(t),e},t.sequence=n,function(t){t.lenient=function(){for(var t=Z.create(),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(n){var i,o=ft(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.then(a)}}catch(s){o.e(s)}finally{o.f()}}return t}}(n=t.sequence||(t.sequence={})),t.set=function(){for(var t=ot.create(),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(n){var i,o=ft(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.with(a)}}catch(s){o.e(s)}finally{o.f()}}return t},t.tag=ct.create,t.tagStart=function(t){return e(P.and(P.isTagStart(),P.is(a.tagName(),"string"===typeof t?P.only(t):t)))},t.tagEnd=function(t){return e(P.and(P.isTagEnd(),P.is(a.tagName(),"string"===typeof t?P.only(t):t)))};var r=e(P.isWord()),i=e(P.isWhitespace()),o=t.many(i);function s(e){return t.sequence(o,e,o)}t.word=function(){return r},t.whitespace=function(){return i},t.whitespaces=function(){return o},t.whitespaced=s,function(e){function n(){for(var e=q.create(),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(r){var a,s=ft(r);try{for(s.s();!(a=s.n()).done;){var u=a.value;e.then(t.sequence(o,u))}}catch(c){s.e(c)}finally{s.f()}}return e}e.head=function(e){return t.sequence(o,e)},e.tail=function(e){return t.sequence(e,o)},e.disjunction=function(){for(var e=F.create(),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(r){var a,s=ft(r);try{for(s.s();!(a=s.n()).done;){var u=a.value;e.or(u)}}catch(c){s.e(c)}finally{s.f()}}return t.sequence(o,e)},e.many=function(e){var n=Q.create();return e&&n.of(t.sequence(o,e)),n},e.optional=function(e){var n=Q.create();return n.optional(),e&&n.of(t.sequence(o,e)),n},e.sequence=n,function(e){e.lenient=function(){for(var e=Z.create(),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(r){var a,s=ft(r);try{for(s.s();!(a=s.n()).done;){var u=a.value;e.then(t.sequence(o,u))}}catch(c){s.e(c)}finally{s.f()}}return e}}(n=e.sequence||(e.sequence={})),e.set=function(){for(var e=ot.create(),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(r){var a,s=ft(r);try{for(s.s();!(a=s.n()).done;){var u=a.value;e.with(t.sequence(o,u))}}catch(c){s.e(c)}finally{s.f()}}return e}}(s=t.whitespaced||(t.whitespaced={})),t.regexp=function(t){return nt.create().thatMatch(t)}}(st||(st={})),function(t){t.UNVISITED=0,t.VISITING=1,t.VISITED=2,t.ALL=[t.UNVISITED,t.VISITING,t.VISITED],t.toString=function(e){switch(e){case t.UNVISITED:return"UNVISITED";case t.VISITING:return"VISITING";case t.VISITED:return"VISITED";default:return}}}(ut||(ut={}));var pt,yt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._states=new Map}var e,n,r;return e=t,(n=[{key:"visiting",value:function(t){this._states.set(t,ut.VISITING)}},{key:"visited",value:function(t){this._states.set(t,ut.VISITED)}},{key:"state",value:function(t){return this._states.get(t)||ut.UNVISITED}},{key:"isVisiting",value:function(t){return this._states.get(t)===ut.VISITING}},{key:"wasVisited",value:function(t){return this._states.get(t)===ut.VISITED}},{key:"isUnvisited",value:function(t){return null==this._states.get(t)||this._states.get(t)===ut.UNVISITED}},{key:"clear",value:function(){this._states.clear()}}])&&ht(e.prototype,n),r&&ht(e,r),t}();function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.State=ut,t.create=function(){return new t}}(yt||(yt={})),function(t){t.START="start",t.NEXT="next",t.SUCCESS="success",t.FAILURE="failure",t.ALL=[t.START,t.NEXT,t.SUCCESS,t.FAILURE]}(pt||(pt={}));var dt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.start=this.start.bind(this),this.next=this.next.bind(this),this.success=this.success.bind(this),this.failure=this.failure.bind(this)}var e,n,r;return e=t,(n=[{key:"subscribe",value:function(t){t.on(pt.START,this.start),t.on(pt.NEXT,this.next),t.on(pt.SUCCESS,this.success),t.on(pt.FAILURE,this.failure)}},{key:"unsubscribe",value:function(t){t.off(pt.START,this.start),t.off(pt.NEXT,this.next),t.off(pt.SUCCESS,this.success),t.off(pt.FAILURE,this.failure)}},{key:"start",value:function(){}},{key:"next",value:function(t){console.warn("Unhandled production of value %o. To suppress this warning, override the next method.",t)}},{key:"success",value:function(){}},{key:"failure",value:function(t){console.warn("Unhandled failure %o. To suppress this warning, override the failure method.",t)}}])&&vt(e.prototype,n),r&&vt(e,r),t}();function bt(t){return(bt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mt(t,e){return(mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Et(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Tt(t);if(e){var i=Tt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _t(this,n)}}function _t(t,e){return!e||"object"!==bt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tt(t){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kt,St=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(o,t);var e,n,r,i=Et(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).buffer=t,e}return e=o,(n=[{key:"start",value:function(){this.buffer.clear()}},{key:"next",value:function(t){this.buffer.push(t)}},{key:"success",value:function(){this.buffer.fit()}},{key:"failure",value:function(t){console.error(t)}}])&&gt(e.prototype,n),r&&gt(e,r),o}(dt);function At(t){return(At="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(t){for(var e="[",n=0;n<t.size;++n){var r=t.get(n);e+=n>0?",":"",e+="\r\n\t",null==r||null==r.toString?e+=JSON.stringify(r):e+=r.toString()}return e+=t.size>0?"\r\n":"",e+="]"}function n(t){return null==t||null==t.toString?JSON.stringify(t):t.toString()}t.bufferize=function(e,n){var r;return(r=new St(null==n?U.Pack.any(32):t.create(n,32))).subscribe(e),r.buffer},t.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;return U.Pack.instance(t,e)},t.toString=e,t.stringify=n,t.expect=function(t,r){if(null==t||null==r){if(r===t)throw new Error("Received different values, received "+n(t)+" but expected "+n(r)+".")}else if(t!=r){if(t.size!==r.size)throw new Error("Received a buffer of size "+t.size+" instead of a buffer of size "+r.size+", received "+e(t)+" but expected "+e(r)+".");for(var i=0,o=r.size;i<o;++i){var a=t.get(i),s=r.get(i);if(null==a||null==s||null==s.equals){if(a!==s)throw new Error("Difference between buffers at index "+i+" : "+n(a)+" != "+n(s)+", received "+e(t)+" but expected "+e(r)+".")}else if(!a.equals(s))throw new Error("Difference between buffers at index "+i+" : "+n(a)+" != "+n(s)+", received "+e(t)+" but expected "+e(r)+".")}}}}(kt||(kt={}));var It,Ot=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=void 0}var e,n,r;return e=t,(n=[{key:"isMap",value:function(){return t.isMap(this.value)}},{key:"isArray",value:function(){return t.isArray(this.value)}},{key:"isObject",value:function(){return t.isObject(this.value)}},{key:"isPrimitive",value:function(){return t.isPrimitive(this.value)}},{key:"move",value:function(e){this.value=t.move(this.value,e)}},{key:"follow",value:function(e){this.value=t.follow(this.value,e)}},{key:"set",value:function(e,n){t.set(this.value,e,n)}},{key:"setIn",value:function(e,n){t.setIn(this.value,e,n)}},{key:"push",value:function(e){t.push(this.value,e)}},{key:"pushIn",value:function(e,n){t.pushIn(this.value,e,n)}}])&&wt(e.prototype,n),r&&wt(e,r),t}();function Rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(t,e){if(null==t||"object"!==At(t))throw null==t?new Error("Illegal call to move, a data object can't move throughout a null or undefined value."):new Error("Illegal call to move, a data object can't move throughout a primitive value.");if(t instanceof Array){if("number"===typeof t)return t[e];throw new Error("Illegal call to move, a data object can't move throughout an array by using a string key.")}return t instanceof Map?t.get(e):t[e]}function n(t,e,n){if(null==t||"object"!==At(t))throw null==t?new Error("Illegal call to set, a data object can't assign a field to a null or undefined value."):new Error("Illegal call to set, a data object can't assign a field to a primitive value.");if(t instanceof Array){if("number"!==typeof e)throw new Error("Illegal call to set, a data object can't assign a string field to an array.");t[e]=n}else t instanceof Map?t.set(e,n):t[e]=n}function r(t,e){if(null==t||"object"!==At(t))throw null==t?new Error("Illegal call to push, a data object can't push into a null or undefined value."):new Error("Illegal call to push, a data object can't push into a primitive value.");if(!(t instanceof Array))throw new Error("Illegal call to push, a data object can't push into an object or a map.");t.push(e)}t.isMap=function(t){return null!=t&&"object"===At(t)&&t instanceof Map},t.isArray=function(t){return null!=t&&"object"===At(t)&&t instanceof Array},t.isObject=function(t){return null!=t&&"object"===At(t)&&!(t instanceof Array)},t.isPrimitive=function(t){return null==t&&"object"!==At(t)},t.move=e,t.follow=function(t,n){for(var r=n.elements,i=t,o=0,a=r.size;o<a;++o)i=e(i,r.get(o));return i},t.set=n,t.setIn=function(t,r,i){for(var o=r.elements,a=t,s=0,u=o.size-1;s<u;++s)a=e(a,o.get(s));n(a,o.last,i)},t.push=r,t.pushIn=function(t,n,i){for(var o=n.elements,a=t,s=0,u=o.size;s<u;++s)a=e(a,o.get(s));r(a,i)}}(Ot||(Ot={})),function(t){function e(e){switch(e){case t.MOVE:return"MOVE";case t.BACK:return"BACK";case t.OBJECT:return"OBJECT";case t.ARRAY:return"ARRAY";case t.MAP:return"MAP";case t.SWAP:return"SWAP";case t.SET:return"SET";case t.PUSH:return"PUSH";case t.PUBLISH:return"PUBLISH";default:return}}t.MOVE=0,t.BACK=1,t.OBJECT=2,t.ARRAY=3,t.MAP=4,t.SWAP=5,t.SET=6,t.PUSH=7,t.PUBLISH=8,t.DEFAULT=t.MOVE,t.ALL=[t.MOVE,t.BACK,t.OBJECT,t.ARRAY,t.MAP,t.SWAP,t.SET,t.PUSH,t.PUBLISH],t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(It||(It={}));var xt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;Rt(this,t),this._elements=U.Pack.any(e),this.elements=this._elements.view()}var e,n,r;return e=t,(n=[{key:"reallocate",value:function(t){this._elements.reallocate(t)}},{key:"fit",value:function(){this._elements.fit()}},{key:"push",value:function(t){this._elements.push(t)}},{key:"pop",value:function(){return this._elements.pop()}},{key:"concat",value:function(t){this._elements.concat(t._elements)}},{key:"copy",value:function(t){this._elements.copy(t._elements)}},{key:"clear",value:function(){this._elements.clear()}},{key:"clone",value:function(){var e=new t(this._elements.capacity);return e.copy(this),e}},{key:"toString",value:function(){if(this._elements.size>0){var t=".",e=this._elements.get(0);"string"===typeof e?t+=e:(t+="[",t+=e,t+="]");for(var n=1;n<this._elements.size;++n){var r=this._elements.get(1);"string"===typeof r?(t+=".",t+=r):(t+="[",t+=r,t+="]")}return t}return"."}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e._elements.equals(this._elements))}},{key:Symbol.iterator,value:function(){return this._elements[Symbol.iterator]()}},{key:"size",get:function(){return this._elements.size}},{key:"capacity",get:function(){return this._elements.capacity}}])&&Nt(e.prototype,n),r&&Nt(e,r),t}();function Ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.copy=function(t){return null==t?t:t.clone()}}(xt||(xt={}));var Pt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=0,this.type=It.DEFAULT,this.value=void 0,this.path=new xt(8)}var e,n,r;return e=t,(n=[{key:"publish",value:function(){this.type=It.PUBLISH,this.value=void 0,this.path.clear()}},{key:"object",value:function(){this.type=It.OBJECT,this.value=void 0,this.path.clear()}},{key:"array",value:function(){this.type=It.ARRAY,this.value=void 0,this.path.clear()}},{key:"map",value:function(){this.type=It.MAP,this.value=void 0,this.path.clear()}},{key:"swap",value:function(t){this.type=It.SWAP,this.value=t,this.path.clear()}},{key:"move",value:function(){this.type=It.MOVE,this.value=void 0,this.path.clear();for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];this.path.push(o)}}},{key:"back",value:function(){this.type=It.BACK,this.value=void 0,this.path.clear()}},{key:"set",value:function(){var t;this.type=It.SET,this.value=(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t],this.path.clear();for(var e=0,n=arguments.length-1;e<n;++e)this.path.push(e<0||arguments.length<=e?void 0:arguments[e])}},{key:"push",value:function(){var t;this.type=It.PUSH,this.value=(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t],this.path.clear();for(var e=0,n=arguments.length-1;e<n;++e)this.path.push(e<0||arguments.length<=e?void 0:arguments[e])}},{key:"clear",value:function(){this.index=0,this.type=It.DEFAULT,this.value=void 0}},{key:"copy",value:function(t){this.index=t.index,this.type=t.type,this.value=t.value}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"toString",value:function(){var t="#"+this.index;switch(this.type){case It.MOVE:return t+" move "+this.path.toString();case It.BACK:return t+" back";case It.OBJECT:return t+" object";case It.ARRAY:return t+" array";case It.MAP:return t+" map";case It.SWAP:return t+" swap to "+this.value;case It.SET:return t+" set "+this.path.toString()+" "+this.value;case It.PUSH:return t+" push "+this.path.toString()+" "+this.value;default:throw new Error("Unable to map a data event of type "+It.toDebugString(this.type)+" to a string because no procedure was defined for that.")}}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.index===this.index&&e.type===this.type&&e.value===this.value)}}])&&Ct(e.prototype,n),r&&Ct(e,r),t}();function Lt(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Dt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dt(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.copy=function(t){return null==t?t:t.clone()},t.create=e,t.ALLOCATOR=U.Allocator.fromFactory(e)}(Pt||(Pt={}));var Wt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._startListeners=new Set,this._nextListeners=new Set,this._successListeners=new Set,this._failureListeners=new Set}var e,n,r;return e=t,(n=[{key:"start",value:function(){var t,e=Lt(this._startListeners);try{for(e.s();!(t=e.n()).done;)(0,t.value)()}catch(n){e.e(n)}finally{e.f()}}},{key:"fail",value:function(t){var e,n=Lt(this._failureListeners);try{for(n.s();!(e=n.n()).done;)(0,e.value)(t)}catch(r){n.e(r)}finally{n.f()}}},{key:"next",value:function(t){var e,n=Lt(this._nextListeners);try{for(n.s();!(e=n.n()).done;)(0,e.value)(t)}catch(r){n.e(r)}finally{n.f()}}},{key:"success",value:function(){var t,e=Lt(this._successListeners);try{for(e.s();!(t=e.n()).done;)(0,t.value)()}catch(n){e.e(n)}finally{e.f()}}},{key:"on",value:function(t,e){switch(t){case pt.SUCCESS:return void this._successListeners.add(e);case pt.NEXT:return void this._nextListeners.add(e);case pt.FAILURE:return void this._failureListeners.add(e);case pt.START:return void this._startListeners.add(e);default:throw new Error('Unable to register the given listener for event type "'+t+'" because the given event type does not exists or is not supported.')}}},{key:"off",value:function(t,e){if(void 0===t)this._startListeners.clear(),this._nextListeners.clear(),this._successListeners.clear(),this._failureListeners.clear();else if(void 0===e)switch(t){case pt.SUCCESS:return this._successListeners.clear();case pt.NEXT:return this._nextListeners.clear();case pt.FAILURE:return this._failureListeners.clear();case pt.START:return this._startListeners.clear();default:throw new Error('Unable to remove all event listener of event type "'+t+'" because the given event type does not exists or is not supported.')}else switch(t){case pt.SUCCESS:return void this._successListeners.delete(e);case pt.NEXT:return void this._nextListeners.delete(e);case pt.FAILURE:return void this._failureListeners.delete(e);case pt.START:return void this._startListeners.delete(e);default:throw new Error('Unable to remove the given listener for event type "'+t+'" because the given event type does not exists or is not supported.')}}}])&&Ut(e.prototype,n),r&&Ut(e,r),t}();function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(Wt||(Wt={}));var Ft=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.output=new Wt}var e,n,r;return e=t,(n=[{key:"on",value:function(t,e){this.output.on(t,e)}},{key:"off",value:function(t,e){this.output.off(t,e)}}])&&jt(e.prototype,n),r&&jt(e,r),t}();function Mt(t){return(Mt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ht(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=qt(t);if(e){var i=qt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return zt(this,n)}}function zt(t,e){return!e||"object"!==Mt(e)&&"function"!==typeof e?Vt(t):e}function Vt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Yt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bt(t,e)}(o,t);var e,n,r,i=Ht(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).start=t.start.bind(Vt(t)),t.next=t.next.bind(Vt(t)),t.success=t.success.bind(Vt(t)),t.failure=t.failure.bind(Vt(t)),t}return e=o,(n=[{key:"subscribe",value:function(t){t.on(pt.START,this.start),t.on(pt.NEXT,this.next),t.on(pt.SUCCESS,this.success),t.on(pt.FAILURE,this.failure)}},{key:"unsubscribe",value:function(t){t.off(pt.START,this.start),t.off(pt.NEXT,this.next),t.off(pt.SUCCESS,this.success),t.off(pt.FAILURE,this.failure)}},{key:"start",value:function(){}},{key:"next",value:function(t){console.warn("Unhandled production of value %o. To suppress this warning, override the next method.",t)}},{key:"success",value:function(){}},{key:"failure",value:function(t){console.warn("Unhandled failure %o. To suppress this warning, override the failure method.",t)}}])&&Gt(e.prototype,n),r&&Gt(e,r),o}(Ft);function Kt(t){return(Kt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xt(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return $t(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$t(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function $t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Zt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qt(t,e){return(Qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function te(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ne(t);if(e){var i=ne(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ee(this,n)}}function ee(t,e){return!e||"object"!==Kt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ne(t){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var re=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qt(t,e)}(o,t);var e,n,r,i=te(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;return Zt(this,o),(t=i.call(this))._stack=U.Pack.any(e),t._path=new xt(e),t}return e=o,(n=[{key:"start",value:function(){this.output.start(),this._stack.push(void 0)}},{key:"next",value:function(t){switch(t.type){case It.MOVE:this.move(t.path);break;case It.BACK:this.back();break;case It.OBJECT:this.object();break;case It.ARRAY:this.array();break;case It.MAP:this.map();break;case It.SWAP:this.swap(t.value);break;case It.SET:this.set(t.path,t.value);break;case It.PUSH:this.push(t.path,t.value);break;case It.PUBLISH:this.publish();break;default:throw new Error("Unable to handle production of event of type "+It.toDebugString(t.type)+" because no procedure was defined for that.")}}},{key:"move",value:function(t){var e,n=this._stack.last,r=Xt(t.elements);try{for(r.s();!(e=r.n()).done;){var i=e.value;n=Ot.move(n,i),this._stack.push(n),this._path.push(i)}}catch(o){r.e(o)}finally{r.f()}}},{key:"back",value:function(){if(!(this._path.size>0))throw new Error("Unable to move back from the root of the declaration.");this._stack.pop(),this._path.pop()}},{key:"object",value:function(){var t=this._stack.last;if(null!=t){if("object"===Kt(t)){if(t instanceof Array)throw new Error("Unable to define the current value as an object as the current value is an array.");if(t instanceof Map)throw new Error("Unable to define the current value as an object as the current value is a map.");return}throw new Error("Unable to define the current value as an object as the current value is a primitive value.")}this._stack.set(this._stack.lastIndex,{})}},{key:"array",value:function(){var t=this._stack.last;if(null!=t){if("object"===Kt(t)){if(t instanceof Array)return;throw t instanceof Map?new Error("Unable to define the current value as an array as the current value is a map."):new Error("Unable to define the current value as an array as the current value is an object.")}throw new Error("Unable to define the current value as an array as the current value is a primitive value.")}this._stack.set(this._stack.lastIndex,[])}},{key:"map",value:function(){var t=this._stack.last;if(null!=t){if("object"===Kt(t)){if(t instanceof Array)throw new Error("Unable to define the current value as a map as the current value is an array.");if(t instanceof Map)return;throw new Error("Unable to define the current value as a map as the current value is an object.")}throw new Error("Unable to define the current value as a map as the current value is a primitive value.")}this._stack.set(this._stack.lastIndex,new Map)}},{key:"swap",value:function(t){this._stack.set(this._stack.lastIndex,t)}},{key:"set",value:function(t,e){Ot.setIn(this._stack.last,t,e)}},{key:"push",value:function(t,e){Ot.pushIn(this._stack.last,t,e)}},{key:"publish",value:function(){var t=this._stack.first;this._stack.clear(),this._path.clear(),this._stack.push(void 0),this.output.next(t)}},{key:"success",value:function(){var t=this._stack.first;this._stack.clear(),this._path.clear(),this.output.next(t),this.output.success()}},{key:"failure",value:function(t){this.output.fail(t)}},{key:"clear",value:function(){this._stack.clear(),this.off()}}])&&Jt(e.prototype,n),r&&Jt(e,r),o}(Yt);function ie(t){return(ie="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ae(t,e){return(ae=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function se(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ce(t);if(e){var i=ce(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ue(this,n)}}function ue(t,e){return!e||"object"!==ie(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ce(t){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fe,le,he=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ae(t,e)}(o,t);var e,n,r,i=se(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._index=0,t._event=new Pt,t}return e=o,(n=[{key:"publish",value:function(){return this._event.publish(),this.next(),this}},{key:"object",value:function(){return this._event.object(),this.next(),this}},{key:"array",value:function(){return this._event.array(),this.next(),this}},{key:"map",value:function(){return this._event.map(),this.next(),this}},{key:"swap",value:function(t){return this._event.swap(t),this.next(),this}},{key:"move",value:function(){var t;return(t=this._event).move.apply(t,arguments),this.next(),this}},{key:"back",value:function(){return this._event.back(),this.next(),this}},{key:"set",value:function(){var t;return(t=this._event).set.apply(t,arguments),this.next(),this}},{key:"push",value:function(){var t;return(t=this._event).push.apply(t,arguments),this.next(),this}},{key:"start",value:function(){this.clear(),this.output.start()}},{key:"next",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._event;t.index=this._index,this._index+=1,this.output.next(t)}},{key:"success",value:function(){this.output.success()}},{key:"clear",value:function(){this._index=0,this._event.clear()}}])&&oe(e.prototype,n),r&&oe(e,r),o}(Ft),pe=n(757),ye=n.n(pe);function ve(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.MINUS="-".codePointAt(0),t.SHARP="#".codePointAt(0),t.DOT=".".codePointAt(0),t.DOUBLE_DOT=":".codePointAt(0),t.ANTISLASH="\\".codePointAt(0),t.OPENING_BRACE="{".codePointAt(0),t.CLOSING_BRACE="}".codePointAt(0),t.ZERO="0".codePointAt(0),t.ONE="1".codePointAt(0),t.TWO="2".codePointAt(0),t.THREE="3".codePointAt(0),t.FOUR="4".codePointAt(0),t.FIVE="5".codePointAt(0),t.SIX="6".codePointAt(0),t.SEVEN="7".codePointAt(0),t.EIGHT="8".codePointAt(0),t.NINE="9".codePointAt(0),t.NEW_LINE="\n".codePointAt(0),t.CARRIAGE_RETURN="\r".codePointAt(0),t.TABULATION="\t".codePointAt(0),t.FORM_FEED="\f".codePointAt(0),t.DOUBLE_QUOTE='"'.codePointAt(0),t.SPACE=" ".codePointAt(0),t.a="a".codePointAt(0),t.b="b".codePointAt(0),t.c="c".codePointAt(0),t.d="d".codePointAt(0),t.e="e".codePointAt(0),t.f="f".codePointAt(0),t.g="g".codePointAt(0),t.h="h".codePointAt(0),t.i="i".codePointAt(0),t.j="j".codePointAt(0),t.k="k".codePointAt(0),t.l="l".codePointAt(0),t.m="m".codePointAt(0),t.n="n".codePointAt(0),t.o="o".codePointAt(0),t.p="p".codePointAt(0),t.q="q".codePointAt(0),t.r="r".codePointAt(0),t.s="s".codePointAt(0),t.t="t".codePointAt(0),t.u="u".codePointAt(0),t.v="v".codePointAt(0),t.w="w".codePointAt(0),t.x="x".codePointAt(0),t.y="y".codePointAt(0),t.z="z".codePointAt(0),t.A="A".codePointAt(0),t.B="B".codePointAt(0),t.C="C".codePointAt(0),t.D="D".codePointAt(0),t.E="E".codePointAt(0),t.F="F".codePointAt(0),t.G="G".codePointAt(0),t.H="H".codePointAt(0),t.I="I".codePointAt(0),t.J="J".codePointAt(0),t.K="K".codePointAt(0),t.L="L".codePointAt(0),t.M="M".codePointAt(0),t.N="N".codePointAt(0),t.O="O".codePointAt(0),t.P="P".codePointAt(0),t.Q="Q".codePointAt(0),t.R="R".codePointAt(0),t.S="S".codePointAt(0),t.T="T".codePointAt(0),t.U="U".codePointAt(0),t.V="V".codePointAt(0),t.W="W".codePointAt(0),t.X="X".codePointAt(0),t.Y="Y".codePointAt(0),t.Z="Z".codePointAt(0),t.COLON=":".codePointAt(0),t.SEMICOLON=";".codePointAt(0),t.isDecimalDigit=function(e){return e>=t.ZERO&&e<=t.NINE},t.isBinaryDigit=function(e){return e===t.ZERO||e===t.ONE},t.isHexadecimalDigit=function(e){return e>=t.ZERO&&e<=t.NINE||e>=t.A&&e<=t.F||e>=t.a&&e<=t.f},t.isWhitespace=function(e){return e===t.CARRIAGE_RETURN||e===t.NEW_LINE||e===t.FORM_FEED||e===t.TABULATION||e===t.SPACE},t.toDebugString=function(e){switch(e){case t.CARRIAGE_RETURN:return":r";case t.NEW_LINE:return":n";case t.FORM_FEED:return":f";case t.TABULATION:return":t";case t.SPACE:return":s";default:return String.fromCodePoint(e)}}}(fe||(fe={})),function(t){t.RUNTIME=0,t.RESOURCE=1,t.BUFFER=2,t.TEXT=3,t.NETWORK=4,t.ALL=[t.RUNTIME,t.RESOURCE,t.BUFFER,t.TEXT,t.NETWORK],t.toString=function(e){switch(e){case t.RUNTIME:return"RUNTIME";case t.RESOURCE:return"RESOURCE";case t.BUFFER:return"BUFFER";case t.TEXT:return"TEXT";case t.NETWORK:return"NETWORK";default:return}}}(le||(le={}));var de=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=le.BUFFER,this.byte=e}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return"byte "+this.byte}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type&&this.byte===e.byte)}}])&&ve(e.prototype,n),r&&ve(e,r),t}();function be(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(e){return new t(e)}}(de||(de={}));var ge=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=le.NETWORK,this.address=e}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return this.address}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type&&this.address===e.address)}}])&&be(e.prototype,n),r&&be(e,r),t}();function me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(e){return new t(e)}}(ge||(ge={}));var Ee=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=le.RESOURCE,this.unifiedResourceIdentifier=e}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return this.unifiedResourceIdentifier}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type&&this.unifiedResourceIdentifier===e.unifiedResourceIdentifier)}}])&&me(e.prototype,n),r&&me(e,r),t}();function _e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(e){return new t(e)}}(Ee||(Ee={}));var Te=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=le.RUNTIME}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return"runtime"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type)}}])&&_e(e.prototype,n),r&&_e(e,r),t}();function ke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(Te||(Te={}));var Ae=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;ke(this,t),this.column=n,this.line=e,this.index=r}var e,n,r;return e=t,(n=[{key:"asUnknown",value:function(){this.column=-1,this.line=-1,this.index=-1}},{key:"isUnknown",value:function(){return-1===this.index}},{key:"add",value:function(t,e,n){this.index<0||(this.column+=e,this.line+=t,this.index+=n)}},{key:"subtract",value:function(t,e,n){this.index<0||(this.column=Math.max(this.column-e,0),this.line=Math.max(this.line-t,0),this.index=Math.max(this.index-n,0))}},{key:"set",value:function(t,e,n){this.column=e,this.line=t,this.index=n}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"copy",value:function(t){this.column=t.column,this.line=t.line,this.index=t.index}},{key:"clear",value:function(){this.column=0,this.line=0,this.index=0}},{key:"toString",value:function(){return this.index<0?"unknown":"".concat(this.line,":").concat(this.column,"/").concat(this.index)}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&(-1===e.index&&-1===this.index||e.line===this.line&&e.column===this.column&&e.index===this.index))}}])&&Se(e.prototype,n),r&&Se(e,r),t}();function we(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Ae.ZERO=new Ae(0,0,0),Ae.UNKNOWN=new Ae(-1,-1,-1),function(t){var e=/\(?\s*(\d+)\s*,?\s*(\d+)\s*,?\s*(\d+)\s*\)?/i;function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new t(e,n,r)}t.create=n,t.fromString=function(n){var r=e.exec(n);if(r)return new t(parseInt(r[1]),parseInt(r[2]),parseInt(r[3]));throw new Error('Unable to extract an unidoc location from "'+n+'".')},t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Duplicator.fromFactory(n)}(Ae||(Ae={}));var Oe,Re=function(){function t(){if(we(this,t),this.type=le.TEXT,(arguments.length<=0?void 0:arguments[0])instanceof Ae){var e=arguments.length<=0?void 0:arguments[0];this.line=e.line,this.column=e.column,this.index=e.index}else this.line=arguments.length<=0?void 0:arguments[0],this.column=arguments.length<=1?void 0:arguments[1],this.index=arguments.length<=2?void 0:arguments[2]}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return"index "+this.index+" at line "+this.line+" and column "+this.column}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type&&this.index===e.index&&this.line===e.line&&this.column===e.column)}}])&&Ie(e.prototype,n),r&&Ie(e,r),t}();function Ne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(e,n,r){return new t(e,n,r)}}(Re||(Re={})),function(t){t.buffer=de.create,t.network=ge.create,t.resource=Ee.create,t.runtime=Te.create,t.text=Re.create}(Oe||(Oe={}));var Ce=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;Ne(this,t),this.elements=U.Pack.any(e)}var e,n,r;return e=t,(n=[{key:"reallocate",value:function(t){this.elements.reallocate(t)}},{key:"text",value:function(t,e,n){return this.elements.push(Oe.text(t,e,n)),this}},{key:"buffer",value:function(t){return this.elements.push(Oe.buffer(t)),this}},{key:"resource",value:function(t){return this.elements.push(Oe.resource(t)),this}},{key:"network",value:function(t){return this.elements.push(Oe.network(t)),this}},{key:"runtime",value:function(){return this.elements.push(Oe.runtime()),this}},{key:"concat",value:function(t){this.elements.concat(t.elements)}},{key:"copy",value:function(t){this.elements.copy(t.elements)}},{key:"clone",value:function(){var e=new t(this.elements.capacity);return e.copy(this),e}},{key:"clear",value:function(){this.elements.clear()}},{key:"toString",value:function(){if(this.elements.size>0){for(var t=this.elements.first.toString(),e=1;e<this.elements.size;++e)t+=" at "+this.elements.get(e).toString();return t}return"undefined origin"}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.elements.equals(this.elements))}}])&&xe(e.prototype,n),r&&xe(e,r),t}();function Pe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.Element=Oe,t.RUNTIME=new t(1).runtime(),t.runtime=function(){return t.RUNTIME}}(Ce||(Ce={}));var De=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;Pe(this,t),this.state=new je(e),this._builtOrigin=this.state.from}var e,n,r;return e=t,(n=[{key:"capacity",value:function(t){return this.state.reallocate(t),this}},{key:"from",value:function(t){return t?this.state.from.copy(t):this._builtOrigin=this.state.from,this}},{key:"to",value:function(t){return t?this.state.to.copy(t):this._builtOrigin=this.state.to,this}},{key:"runtime",value:function(){return this._builtOrigin.runtime(),this}},{key:"text",value:function(t,e,n){return this._builtOrigin.text(t,e,n),this}},{key:"buffer",value:function(t){return this._builtOrigin.buffer(t),this}},{key:"resource",value:function(t){return this._builtOrigin.resource(t),this}},{key:"network",value:function(t){return this._builtOrigin.network(t),this}},{key:"at",value:function(){return this}},{key:"copy",value:function(e){return e instanceof je?this.state.copy(e):e instanceof t?this.state.copy(e.state):this._builtOrigin.copy(e),this}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){return this.state.clear(),this}},{key:"build",value:function(){var t=this.state.clone();return this.state.clear(),t}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.state.equals(e.state))}}])&&Le(e.prototype,n),r&&Le(e,r),t}();function Ue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function We(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(De||(De={}));var je=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;Ue(this,t),this.from=new Ce(e),this.to=new Ce(e)}var e,n,r;return e=t,(n=[{key:"reallocate",value:function(t){this.from.reallocate(t),this.to.reallocate(t)}},{key:"runtime",value:function(){return this.from.runtime(),this.to.runtime(),this}},{key:"at",value:function(t){return this.from.copy(t),this.to.copy(t),this}},{key:"copy",value:function(t){this.from.copy(t.from),this.to.copy(t.to)}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.from.clear(),this.to.clear()}},{key:"toString",value:function(){return this.from.equals(this.to)?this.from.toString():"from "+this.from.toString()+" to "+this.to.toString()}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.from.equals(e.from)&&this.to.equals(e.to))}}])&&We(e.prototype,n),r&&We(e,r),t}();function Fe(t){return function(t){if(Array.isArray(t))return Be(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Ge(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Me(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Ge(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ge(t,e){if(t){if("string"===typeof t)return Be(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Be(t,e):void 0}}function Be(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function He(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t},t.RUNTIME=new t(1).runtime(),t.runtime=function(){return t.RUNTIME},t.builder=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return new De(t)}}(je||(je={}));var ze,Ve=/^([a-zA-Z0-9\-]+)(#[a-zA-Z0-9\-]+)?((?:\.[a-zA-Z0-9\-]+)+)?$/i,qe="",Ye=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=0,this.type=S.START_TAG,this.tag=qe,this.identifier=qe,this.classes=new Set,this.symbols=U.Pack.uint32(128),this.origin=(new je).runtime()}var e,n,r;return e=t,(n=[{key:"substring",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.symbols.size-t,n=[],r=t,i=t+e,o=r;o<i;++o)n.push(this.symbols.get(o));return String.fromCodePoint.apply(String,n)}},{key:"isStartOfAnyTag",value:function(){return this.type===S.START_TAG}},{key:"isStartOfTag",value:function(t){return this.type===S.START_TAG&&this.tag===t}},{key:"isEndOfAnyTag",value:function(){return this.type===S.END_TAG}},{key:"isEndOfTag",value:function(t){return this.type===S.END_TAG&&this.tag===t}},{key:"isWhitespace",value:function(){return this.type===S.WHITESPACE}},{key:"isWord",value:function(){return this.type===S.WORD}},{key:"ofIndex",value:function(t){return this.index=t,this}},{key:"asWord",value:function(t){this.identifier=qe,this.tag=qe,this.classes.clear(),this.type=S.WORD,this.text=t}},{key:"asWhitespace",value:function(t){this.identifier=qe,this.tag=qe,this.classes.clear(),this.type=S.WHITESPACE,this.text=t}},{key:"asTagStart",value:function(t){this.symbols.clear(),this.classes.clear(),this.type=S.START_TAG,this.tag=qe,this.identifier=qe;var e=Ve.exec(t);if(null!=e&&(this.tag=e[1],this.identifier=null==e[2]?qe:e[2].substring(1),null!=e[3])){var n,r=Me(e[3].substring(1).split("."));try{for(r.s();!(n=r.n()).done;){var i=n.value;this.classes.add(i)}}catch(o){r.e(o)}finally{r.f()}}}},{key:"asTagEnd",value:function(t){this.symbols.clear(),this.classes.clear(),this.type=S.END_TAG,this.tag=qe,this.identifier=qe;var e=Ve.exec(t);if(null!=e&&(this.tag=e[1],this.identifier=null==e[2]?qe:e[2].substring(1),null!=e[3])){var n,r=Me(e[3].substring(1).split("."));try{for(r.s();!(n=r.n()).done;){var i=n.value;this.classes.add(i)}}catch(o){r.e(o)}finally{r.f()}}}},{key:"addClasses",value:function(t){var e,n=Me(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.classes.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"copy",value:function(t){this.index=t.index,this.type=t.type,this.tag=t.tag,this.identifier=t.identifier,this.symbols.copy(t.symbols),this.origin.copy(t.origin),this.classes.clear();var e,n=Me(t.classes);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.classes.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.index=0,this.type=S.START_TAG,this.tag=qe,this.identifier=qe,this.origin.clear(),this.origin.runtime(),this.classes.clear(),this.symbols.clear()}},{key:"toString",value:function(){var t="";if(t+=this.index,t+=" ",t+=S.toString(this.type),t+=" ",t+=this.origin.toString(),this.tag.length>0&&(t+=" \\",t+=this.tag),this.identifier.length>0&&(t+=" #",t+=this.identifier),this.classes.size>0){t+=" ";var e,n=Me(this.classes);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=".",t+=r}}catch(i){n.e(i)}finally{n.f()}}return this.symbols.size>0&&(t+=' "',t+=this.debugText,t+='"'),t}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.index!==this.index||e.type!==this.type||e.classes.size!==this.classes.size||e.identifier!==this.identifier||e.tag!==this.tag||!e.origin.equals(this.origin))return!1;var n,r=Me(e.classes);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!this.classes.has(i))return!1}}catch(o){r.e(o)}finally{r.f()}return this.symbols.equals(e.symbols)}return!1}},{key:"text",get:function(){return String.fromCodePoint.apply(String,Fe(this.symbols))},set:function(t){this.symbols.clear(),this.symbols.size=t.length;for(var e=0;e<t.length;++e)this.symbols.set(e,t.codePointAt(e))}},{key:"debugText",get:function(){var t,e=[],n=Me(this.symbols);try{for(n.s();!(t=n.n()).done;){var r=t.value;switch(r){case fe.NEW_LINE:e.push(fe.COLON),e.push(fe.n);break;case fe.CARRIAGE_RETURN:e.push(fe.COLON),e.push(fe.r);break;case fe.TABULATION:e.push(fe.COLON),e.push(fe.t);break;case fe.SPACE:e.push(fe.COLON),e.push(fe.s);break;case fe.FORM_FEED:e.push(fe.COLON),e.push(fe.f);break;default:e.push(r)}}}catch(i){n.e(i)}finally{n.f()}return String.fromCodePoint.apply(String,e)}}])&&He(e.prototype,n),r&&He(e,r),t}();function Ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.create=e,t.word=function(e){var n=new t;return n.asWord(e),n},t.whitespace=function(e){var n=new t;return n.asWhitespace(e),n},t.tagStart=function(e){var n=new t;return n.asTagStart(e),n},t.tagEnd=function(e){var n=new t;return n.asTagEnd(e),n},t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Duplicator.fromFactory(e),t.equals=function(t,e){return null==t?t==e:t.equals(e)}}(Ye||(Ye={})),function(t){function e(e){switch(e){case t.START:return"START";case t.EVENT:return"EVENT";case t.GROUP_START:return"GROUP_START";case t.GROUP_END:return"GROUP_END";case t.END:return"END";default:return}}t.START=0,t.EVENT=1,t.GROUP_START=2,t.GROUP_END=3,t.END=4,t.ALL=[t.START,t.EVENT,t.GROUP_START,t.GROUP_END,t.END],t.DEFAULT=t.START,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(ze||(ze={}));var Xe,$e=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=ze.DEFAULT,this.event=new Ye,this.group=void 0}var e,n,r;return e=t,(n=[{key:"isStart",value:function(){return this.type===ze.START}},{key:"isEnd",value:function(){return this.type===ze.END}},{key:"isEvent",value:function(){return this.type===ze.EVENT}},{key:"isWhitespace",value:function(){return this.type===ze.EVENT&&this.event.type===S.WHITESPACE}},{key:"isWord",value:function(t){return this.type===ze.EVENT&&this.event.type===S.WORD&&this.event.text===t}},{key:"isAnyWord",value:function(){return this.type===ze.EVENT&&this.event.type===S.WORD}},{key:"isStartOfTag",value:function(t){return this.type===ze.EVENT&&this.event.type===S.START_TAG&&this.event.tag===t}},{key:"isEndOfTag",value:function(t){return this.type===ze.EVENT&&this.event.type===S.END_TAG&&this.event.tag===t}},{key:"isStartOfAnyTag",value:function(){return this.type===ze.EVENT&&this.event.type===S.START_TAG}},{key:"isEndOfAnyTag",value:function(){return this.type===ze.EVENT&&this.event.type===S.END_TAG}},{key:"isStartOfAnyGroup",value:function(){return this.type===ze.GROUP_START}},{key:"isStartOfGroup",value:function(t){return this.type===ze.GROUP_START&&this.group===t}},{key:"isEndOfAnyGroup",value:function(){return this.type===ze.GROUP_END}},{key:"isEndOfGroup",value:function(t){return this.type===ze.GROUP_END&&this.group===t}},{key:"asStart",value:function(){return this.type=ze.START,this.event.clear(),this.group=void 0,this}},{key:"asEvent",value:function(t){return this.type=ze.EVENT,this.event.copy(t),this.group=void 0,this}},{key:"asGroupStart",value:function(t){return this.type=ze.GROUP_START,this.event.clear(),this.group=t,this}},{key:"asGroupEnd",value:function(t){return this.type=ze.GROUP_END,this.event.clear(),this.group=t,this}},{key:"asEnd",value:function(){return this.type=ze.END,this.event.clear(),this.group=void 0,this}},{key:"copy",value:function(t){this.type=t.type,this.event.copy(t.event),this.group=t.group}},{key:"clear",value:function(){this.type=ze.DEFAULT,this.event.clear(),this.group=void 0}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"toString",value:function(){var t=this.constructor.name;switch(t+=" ",t+=ze.toDebugString(this.type),this.type){case ze.START:case ze.END:return t;case ze.EVENT:return t+" "+this.event.toString();case ze.GROUP_START:case ze.GROUP_END:return t+" "+this.group;default:throw new Error("Unable to stringify reduction event of type "+ze.toDebugString(this.type)+" because no procedure was defined for that.")}}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.type===this.type&&e.event.equals(this.event)&&e.group===this.group)}}])&&Ke(e.prototype,n),r&&Ke(e,r),t}();!function(t){function e(){return new t}t.START=(new t).asStart(),t.END=(new t).asEnd(),t.create=e,t.event=function(e){return(new t).asEvent(e)},t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Allocator.fromFactory(e),t.equals=function(t,e){return null==t?t==e:t.equals(e)}}($e||($e={})),function(t){function e(e){switch(e){case t.CURRENT:return"CURRENT";case t.NEXT:return"NEXT";default:return}}t.CURRENT=0,t.NEXT=1,t.ALL=[t.CURRENT,t.NEXT],t.DEFAULT=t.CURRENT,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(Xe||(Xe={}));var Ze=ye().mark(Je);function Je(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe.CURRENT;case 2:t=e.sent;case 3:e.t0=t.type,e.next=e.t0===ze.END?7:e.t0===ze.EVENT?8:10;break;case 7:return e.abrupt("return",t);case 8:if(t.event.type!==S.START_TAG){e.next=10;break}return e.abrupt("return",t);case 10:return e.next=12,Xe.NEXT;case 12:t=e.sent;case 13:e.next=3;break;case 15:case"end":return e.stop()}}),Ze)}function Qe(t){return(Qe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function en(t,e){return(en=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=on(t);if(e){var i=on(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rn(this,n)}}function rn(t,e){return!e||"object"!==Qe(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function on(t){return(on=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var an,sn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&en(t,e)}(o,t);var e,n,r,i=nn(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).reducerFactory=t,e._reducer=void 0,e}return e=o,(n=[{key:"start",value:function(){this._reducer=this.reducerFactory(),this.output.start()}},{key:"next",value:function(t){if(this._reducer){var e=Hn.feed(this._reducer,t);e.done&&(this.output.next(e.value),this._reducer=void 0)}}},{key:"success",value:function(){this._reducer&&(this.output.next(Hn.finish(this._reducer)),this._reducer=void 0),this.output.success()}},{key:"failure",value:function(t){this.output.fail(t)}}])&&tn(e.prototype,n),r&&tn(e,r),o}(Yt);function un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(e){switch(e){case t.VALIDATION:return"VALIDATION";case t.DOCUMENT_COMPLETION:return"DOCUMENT_COMPLETION";case t.MESSAGE:return"MESSAGE";case t.BEGIN_GROUP:return"BEGIN_GROUP";case t.END_GROUP:return"END_GROUP";default:return}}t.VALIDATION=0,t.DOCUMENT_COMPLETION=1,t.MESSAGE=2,t.BEGIN_GROUP=3,t.END_GROUP=4,t.DEFAULT=t.VALIDATION,t.ALL=[t.VALIDATION,t.DOCUMENT_COMPLETION,t.MESSAGE,t.BEGIN_GROUP,t.END_GROUP],t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(an||(an={}));var cn,fn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._event=new $e}var e,n,r;return e=t,(n=[{key:"asStart",value:function(){return this._event.copy($e.START),this}},{key:"asEvent",value:function(t){return this._event.asEvent(t),this}},{key:"asGroupStart",value:function(t){return this._event.asGroupStart(t),this}},{key:"asGroupEnd",value:function(t){return this._event.asGroupEnd(t),this}},{key:"asEnd",value:function(){return this._event.copy($e.END),this}},{key:"get",value:function(){return this._event}},{key:"build",value:function(){return this._event.clone()}},{key:"clear",value:function(){this._event.clear()}}])&&un(e.prototype,n),r&&un(e,r),t}();function ln(t){return(ln="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pn(t,e){return(pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=dn(t);if(e){var i=dn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return vn(this,n)}}function vn(t,e){return!e||"object"!==ln(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dn(t){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(){return new fn}}(cn||(cn={}));var bn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pn(t,e)}(o,t);var e,n,r,i=yn(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._event=new fn,t}return e=o,(n=[{key:"start",value:function(){this.output.start(),this._event.asStart(),this.output.next(this._event.get())}},{key:"next",value:function(t){switch(t.type){case an.VALIDATION:return this._event.asEvent(t.event),void this.output.next(this._event.get());case an.DOCUMENT_COMPLETION:case an.MESSAGE:return;case an.BEGIN_GROUP:return this._event.asGroupStart(t.group),void this.output.next(this._event.get());case an.END_GROUP:return this._event.asGroupEnd(t.group),void this.output.next(this._event.get());default:throw new Error("Unable to map validation event of type "+an.toDebugString(t.type)+" because no procedure was defined for that.")}}},{key:"success",value:function(){this._event.asEnd(),this.output.next(this._event.get()),this.output.success()}},{key:"failure",value:function(t){this.output.fail(t)}}])&&hn(e.prototype,n),r&&hn(e,r),o}(Yt);function gn(t,e){var n=new sn(e);return n.subscribe(t),n}!function(t){t.validation=function(t,e){var n=new sn(e),r=new bn;return r.subscribe(t),n.subscribe(r),n},t.iterator=function(t,e){for(var n=t.next();!n.done;){var r=Hn.feed(e,n.value);if(r.done)return r.value;n=t.next()}return Hn.finish(e)}}(gn||(gn={}));var mn=ye().mark(En);function En(t){var e,n;return ye().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Xe.CURRENT;case 2:e=r.sent;case 3:if(e.isEnd()){r.next=17;break}r.t0=e.type,r.next=r.t0===ze.START||r.t0===ze.EVENT?7:11;break;case 7:if(!(n=Hn.feed(t,e)).done){r.next=10;break}return r.abrupt("return",n.value);case 10:case 11:return r.abrupt("break",12);case 12:return r.next=14,Xe.NEXT;case 14:e=r.sent,r.next=3;break;case 17:return r.abrupt("return",Hn.finish(t));case 18:case"end":return r.stop()}}),mn)}var _n=ye().mark(Tn);function Tn(t){var e,n;return ye().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=[];case 1:return r.delegateYield(t(),"t0",3);case 3:if(void 0!==(n=r.t0)){r.next=8;break}return r.abrupt("return",e);case 8:e.push(n);case 9:r.next=1;break;case 11:case"end":return r.stop()}}),_n)}var kn=ye().mark(Sn);function Sn(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Xe.CURRENT;case 2:if(!t.sent.isStart()){t.next=7;break}return t.next=6,Xe.NEXT;case 6:t.sent;case 7:case"end":return t.stop()}}),kn)}var An=ye().mark(wn);function wn(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe.CURRENT;case 2:t=e.sent;case 3:if(!t.isWhitespace()){e.next=9;break}return e.next=6,Xe.NEXT;case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),An)}var In=ye().mark(On);function On(t){var e,n,r;return ye().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.delegateYield(Sn(),"t0",1);case 1:return i.delegateYield(wn(),"t1",2);case 2:return i.next=4,Xe.CURRENT;case 4:if(!(e=i.sent).isStartOfAnyTag()){i.next=37;break}n=0,r=Hn.feed(t,$e.START);case 8:i.t2=e.type,i.next=i.t2===ze.END?11:i.t2===ze.EVENT?16:24;break;case 11:if(!r.done){i.next=15;break}return i.abrupt("return",r.value);case 15:return i.abrupt("return",Hn.finish(t));case 16:i.t3=e.event.type,i.next=i.t3===S.START_TAG?19:i.t3===S.END_TAG?21:23;break;case 19:return n+=1,i.abrupt("break",24);case 21:return n-=1,i.abrupt("break",24);case 23:return i.abrupt("break",24);case 24:return r.done||(r=Hn.feed(t,e)),i.abrupt("break",26);case 26:return i.next=28,Xe.NEXT;case 28:e=i.sent;case 29:if(n>0){i.next=8;break}case 30:if(!r.done){i.next=34;break}return i.abrupt("return",r.value);case 34:return i.abrupt("return",Hn.finish(t));case 35:i.next=38;break;case 37:return i.abrupt("return",void 0);case 38:case"end":return i.stop()}}),In)}!function(t){var e=ye().mark(n);function n(t){var n,r,i;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Sn(),"t0",1);case 1:return e.delegateYield(wn(),"t1",2);case 2:return e.next=4,Xe.CURRENT;case 4:if(!(n=e.sent).isStartOfAnyTag()){e.next=65;break}return r=Hn.feed(t,$e.START),e.next=9,Xe.NEXT;case 9:n=e.sent,e.t2=n.type,e.next=e.t2===ze.END?13:e.t2===ze.EVENT?18:29;break;case 13:if(!r.done){e.next=17;break}return e.abrupt("return",r.value);case 17:return e.abrupt("return",Hn.finish(t));case 18:e.t3=n.event.type,e.next=e.t3===S.END_TAG?21:28;break;case 21:return e.next=23,Xe.NEXT;case 23:if(!r.done){e.next=27;break}return e.abrupt("return",r.value);case 27:return e.abrupt("return",Hn.finish(t));case 28:return e.abrupt("break",29);case 29:return e.abrupt("break",30);case 30:i=1;case 31:if(!(i>0)){e.next=55;break}return r.done||(r=Hn.feed(t,n)),e.next=35,Xe.NEXT;case 35:n=e.sent,e.t4=n.type,e.next=e.t4===ze.END?39:e.t4===ze.EVENT?44:52;break;case 39:if(!r.done){e.next=43;break}return e.abrupt("return",r.value);case 43:return e.abrupt("return",Hn.finish(t));case 44:e.t5=n.event.type,e.next=e.t5===S.START_TAG?47:e.t5===S.END_TAG?49:51;break;case 47:return i+=1,e.abrupt("break",52);case 49:return i-=1,e.abrupt("break",52);case 51:return e.abrupt("break",52);case 52:return e.abrupt("break",53);case 53:e.next=31;break;case 55:for(;i>0;);return e.next=58,Xe.NEXT;case 58:if(!r.done){e.next=62;break}return e.abrupt("return",r.value);case 62:return e.abrupt("return",Hn.finish(t));case 63:e.next=66;break;case 65:return e.abrupt("return",void 0);case 66:case"end":return e.stop()}}),e)}t.content=n}(On||(On={}));var Rn=ye().mark(Nn);function Nn(){var t,e;return ye().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Xe.CURRENT;case 2:if(!(e=n.sent).isStart()){n.next=9;break}return n.next=6,Xe.NEXT;case 6:if(!(e=n.sent).isEnd()){n.next=9;break}return n.abrupt("return","");case 9:if(!e.isAnyWord()){n.next=13;break}t=e.event.text,n.next=14;break;case 13:return n.abrupt("return",void 0);case 14:return n.next=16,Xe.NEXT;case 16:e=n.sent;case 17:if(!e.isAnyWord()){n.next=24;break}return t+=e.event.text,n.next=21,Xe.NEXT;case 21:e=n.sent,n.next=17;break;case 24:return n.abrupt("return",t);case 25:case"end":return n.stop()}}),Rn)}var xn=ye().mark(Cn);function Cn(){var t,e;return ye().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Xe.CURRENT;case 2:if(!(e=n.sent).isStart()){n.next=9;break}return n.next=6,Xe.NEXT;case 6:if(!(e=n.sent).isEnd()){n.next=9;break}return n.abrupt("return","");case 9:if(!e.isWhitespace()&&!e.isAnyWord()){n.next=38;break}return n.delegateYield(wn(),"t0",11);case 11:return n.delegateYield(Nn(),"t2",12);case 12:if(n.t1=n.t2,n.t1){n.next=15;break}n.t1="";case 15:return t=n.t1,n.next=18,Xe.CURRENT;case 18:e=n.sent;case 19:if(!e.isWhitespace()){n.next=37;break}return n.delegateYield(wn(),"t3",21);case 21:return n.next=23,Xe.CURRENT;case 23:if(!(e=n.sent).isAnyWord()){n.next=31;break}return t+=" ",n.t4=t,n.delegateYield(Nn(),"t5",28);case 28:t=n.t4+=n.t5,n.next=32;break;case 31:return n.abrupt("return",t);case 32:return n.next=34,Xe.CURRENT;case 34:e=n.sent,n.next=19;break;case 37:return n.abrupt("return",t);case 38:return n.abrupt("return",void 0);case 39:case"end":return n.stop()}}),xn)}function Pn(){return En(Cn())}var Ln=ye().mark(Dn);function Dn(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe.CURRENT;case 2:if(!(t=e.sent).isStart()){e.next=9;break}return e.next=6,Xe.NEXT;case 6:if(!(t=e.sent).isEnd()){e.next=9;break}return e.abrupt("return","");case 9:if(!t.isWhitespace()&&!t.isAnyWord()){e.next=16;break}return e.delegateYield(wn(),"t0",11);case 11:return e.delegateYield(Nn(),"t2",12);case 12:if(e.t1=e.t2,e.t1){e.next=15;break}e.t1="";case 15:return e.abrupt("return",e.t1);case 16:return e.abrupt("return",void 0);case 17:case"end":return e.stop()}}),Ln)}function Un(){return En(Dn())}var Wn=ye().mark(jn);function jn(){var t,e;return ye().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Xe.CURRENT;case 2:if(!(e=n.sent).isStart()){n.next=9;break}return n.next=6,Xe.NEXT;case 6:if(!(e=n.sent).isEnd()){n.next=9;break}return n.abrupt("return","");case 9:if(!e.isWhitespace()){n.next=13;break}t=e.event.text,n.next=14;break;case 13:return n.abrupt("return",void 0);case 14:return n.next=16,Xe.NEXT;case 16:e=n.sent;case 17:if(!e.isWhitespace()){n.next=24;break}return t+=e.event.text,n.next=21,Xe.NEXT;case 21:e=n.sent,n.next=17;break;case 24:return n.abrupt("return",t);case 25:case"end":return n.stop()}}),Wn)}var Fn=ye().mark(Mn);function Mn(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Xe.CURRENT;case 2:if(!t.sent.isEndOfAnyTag()){t.next=7;break}return t.next=6,Xe.NEXT;case 6:t.sent;case 7:case"end":return t.stop()}}),Fn)}var Gn=ye().mark(Bn);function Bn(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Xe.CURRENT;case 2:if(!t.sent.isStartOfAnyTag()){t.next=7;break}return t.next=6,Xe.NEXT;case 6:t.sent;case 7:case"end":return t.stop()}}),Gn)}var Hn,zn=ye().mark(Vn);function Vn(){var t,e;return ye().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Sn(),"t0",1);case 1:return n.delegateYield(wn(),"t1",2);case 2:return n.next=4,Xe.CURRENT;case 4:if(!(t=n.sent).isStartOfAnyTag()){n.next=30;break}e=1;case 7:if(!(e>0)){n.next=27;break}return n.next=10,Xe.NEXT;case 10:t=n.sent,n.t2=t.type,n.next=n.t2===ze.END?14:n.t2===ze.EVENT?15:24;break;case 14:return n.abrupt("return",t);case 15:n.t3=t.event.type,n.next=n.t3===S.START_TAG?18:n.t3===S.END_TAG?20:22;break;case 18:return e+=1,n.abrupt("break",23);case 20:return e-=1,n.abrupt("break",23);case 22:return n.abrupt("break",23);case 23:case 24:return n.abrupt("break",25);case 25:n.next=7;break;case 27:return n.next=29,Xe.NEXT;case 29:return n.abrupt("return",n.sent);case 30:return n.next=32,Xe.CURRENT;case 32:return n.abrupt("return",n.sent);case 33:case"end":return n.stop()}}),zn)}function qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){var e=ye().mark(r);function n(t,e){for(var n=t.next(e);!n.done&&n.value===Xe.CURRENT;)n=t.next(e);return n}function r(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe.CURRENT;case 2:t=e.sent;case 3:if(t.isEnd()){e.next=10;break}return console.log(t.toString()),e.next=7,Xe.NEXT;case 7:t=e.sent,e.next=3;break;case 10:console.log(t.toString());case 11:case"end":return e.stop()}}),e)}t.feed=n,t.finish=function(t){var e=n(t,$e.END);if(e.done)return e.value;throw new Error("Illegal nested reducer behavior, the nested reducer continue to run despite the fact that it received the event that notify the end of the reduction process.")},t.log=r,t.nextTag=Je,t.reduce=gn,t.reduceEvents=En,t.reduceMany=Tn,t.reduceTag=On,t.reduceToken=Un,t.reduceText=Pn,t.reduceWhitespaces=jn,t.reduceWords=Nn,t.skipEndOfAnyTag=Mn,t.skipStart=Sn,t.skipStartOfAnyTag=Bn,t.skipTag=Vn,t.skipWhitespaces=wn}(Hn||(Hn={}));var Yn,Kn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.code=0,this.origin=new je(4).runtime()}var e,n,r;return e=t,(n=[{key:"setSymbol",value:function(t){return this.code=t,this}},{key:"setOrigin",value:function(t){return this.origin.copy(t),this}},{key:"copy",value:function(t){this.code=t.code,this.origin.copy(t.origin)}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.code=0,this.origin.clear(),this.origin.runtime()}},{key:"toString",value:function(){var t="symbol(";return t+=fe.toDebugString(this.code),t+=") ",t+=this.origin.toString()}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.code===this.code&&e.origin.equals(this.origin))}}])&&qn(e.prototype,n),r&&qn(e,r),t}();function Xn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:je.runtime();return(new t).setSymbol(e).setOrigin(n)}t.equals=function(t,e){return null==t?t===e:t.equals(e)},t.create=e,t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Duplicator.fromFactory(e)}(Kn||(Kn={})),function(t){function e(e){switch(e){case t.SYMBOL:return"SYMBOL";case t.RETURN:return"RETURN";default:return}}t.SYMBOL=0,t.RETURN=1,t.DEFAULT=t.SYMBOL,t.ALL=[t.SYMBOL,t.RETURN],t.toString=e,t.throwUnhandledState=function(t){throw new Error("Unhandled or unknown unidoc source reader state "+t+' "'+e(t)+'".')}}(Yn||(Yn={}));var $n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.location=new Ae,this._state=Yn.DEFAULT}var e,n,r;return e=t,(n=[{key:"nextString",value:function(t){for(var e=0,n=t.length;e<n;++e)this.next(t.codePointAt(e))}},{key:"next",value:function(t){switch(t){case fe.CARRIAGE_RETURN:this.location.add(1,0,1),this.location.column=0,this._state=Yn.RETURN;break;case fe.NEW_LINE:this._state===Yn.RETURN?(this.location.add(0,0,1),this._state=Yn.SYMBOL):this.location.add(1,0,1),this.location.column=0;break;default:this.location.add(0,1,1),this._state=Yn.SYMBOL}}},{key:"clear",value:function(){this.location.clear(),this._state=Yn.DEFAULT}},{key:"copy",value:function(t){this.location.copy(t.location),this._state=t._state}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.location.equals(this.location)&&e._state===this._state)}}])&&Xn(e.prototype,n),r&&Xn(e,r),t}();function Zn(t){return(Zn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tr(t,e){return(tr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function er(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=rr(t);if(e){var i=rr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return nr(this,n)}}function nr(t,e){return!e||"object"!==Zn(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rr(t){return(rr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ir(t,e){return function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tr(t,e)}(o,t);var e,n,r,i=er(o);function o(){return Jn(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"next",value:function(){}},{key:"skip",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=0;e<t;++e)this.next()}},{key:"generator",value:ye().mark((function t(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.running){t.next=5;break}return t.next=3,this.next();case 3:t.next=0;break;case 5:return t.abrupt("return",void 0);case 6:case"end":return t.stop()}}),t,this)}))},{key:"current",get:function(){}},{key:"running",get:function(){return!1}}])&&Qn(e.prototype,n),r&&Qn(e,r),o}(e)}var or=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};function ar(t){return(ar="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ur(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cr(t,e){return(cr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function fr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=hr(t);if(e){var i=hr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lr(this,n)}}function lr(t,e){return!e||"object"!==ar(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hr(t){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pr=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cr(t,e)}(o,t);var e,n,r,i=fr(o);function o(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ce.runtime();return sr(this,o),(e=i.call(this)).source=t,e.origin=new Ce,e.origin.copy(n),e._tracker=new $n,e._symbol=new Kn,e}return e=o,(n=[{key:"next",value:function(){var t=this._tracker,e=this._symbol,n=this.source.codePointAt(t.location.index);if(null==n)throw new Error("Unable to read the next available code point at "+t.toString()+' from the underlying source : "'+this.source+'" in memory.');return e.code=n,e.origin.clear(),e.origin.from.text(t.location).concat(this.origin),t.next(n),e.origin.to.text(t.location).concat(this.origin),e}},{key:"running",get:function(){return this._tracker.location.index<this.source.length}},{key:"current",get:function(){var t=this._tracker.location.index;return t>0&&t<this.source.length?this._symbol:void 0}},{key:"location",get:function(){return this._tracker.location}}])&&ur(e.prototype,n),r&&ur(e,r),o}(ir(0,or));function yr(t){return(yr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function br(t,e){return(br=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Er(t);if(e){var i=Er(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return mr(this,n)}}function mr(t,e){return!e||"object"!==yr(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Er(t){return(Er=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ce.runtime();return new t(e,n)}}(pr||(pr={}));var _r,Tr=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&br(t,e)}(o,t);var e,n,r,i=gr(o);function o(){return vr(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"location",get:function(){return Ae.ZERO}}])&&dr(e.prototype,n),r&&dr(e,r),o}(ir(0,or));function kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.INSTANCE=new t,t.create=function(){return t.INSTANCE}}(Tr||(Tr={})),function(t){t.fromNothing=function(){return Tr.create()},t.fromString=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ce.runtime();return pr.create(t,e)}}(_r||(_r={}));var Sr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ar=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"resolve",value:function(t){return Sr(this,void 0,void 0,ye().mark((function t(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("UnidocImportationResolver#resolve was not implemented.");case 1:case"end":return t.stop()}}),t)})))}}])&&kr(e.prototype,n),r&&kr(e,r),t}();function wr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ir=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.origin=new je(8),this.resource=""}var e,n,r;return e=t,(n=[{key:"copy",value:function(t){this.origin.copy(t.origin),this.resource=t.resource}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.origin.clear(),this.resource=""}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.origin.equals(this.origin)&&e.resource===this.resource)}}])&&wr(e.prototype,n),r&&wr(e,r),t}();function Or(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.copy=function(t){return null==t?t:t.clone()},t.equals=function(t,e){return null==t?t==e:t.equals(e)},t.create=e,t.ALLOCATOR=U.Duplicator.fromFactory(e)}(Ir||(Ir={}));var Rr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.origin=new Ir,this.resource="",this.reader=_r.fromNothing()}var e,n,r;return e=t,(n=[{key:"copy",value:function(t){this.origin.copy(t.origin),this.resource=t.resource,this.reader=t.reader}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.origin.clear(),this.resource="",this.reader=_r.fromNothing()}}])&&Or(e.prototype,n),r&&Or(e,r),t}();function Nr(t){return(Nr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cr(t,e){return(Cr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Dr(t);if(e){var i=Dr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Lr(this,n)}}function Lr(t,e){return!e||"object"!==Nr(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dr(t){return(Dr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ur=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Wr=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cr(t,e)}(o,t);var e,n,r,i=Pr(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._fragments=new Map,t}return e=o,(n=[{key:"set",value:function(t,e){this._fragments.set(t,e)}},{key:"resolve",value:function(t){return Ur(this,void 0,void 0,ye().mark((function e(){var n,r;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this._fragments.get(t.resource))){e.next=5;break}throw new Error("Unable to resolve fragment : "+t.resource+" because there is no fragment registered with the given name.");case 5:return(r=new Rr).resource="fragment://"+t.resource,r.reader=_r.fromString(n,(new Ce).resource("fragment://"+t.resource)),r.origin.copy(t),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})))}}])&&xr(e.prototype,n),r&&xr(e,r),o}(Ar);function jr(t){return(jr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mr(t,e){return(Mr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Hr(t);if(e){var i=Hr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Br(this,n)}}function Br(t,e){return!e||"object"!==jr(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hr(t){return(Hr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zr,Vr=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mr(t,e)}(o,t);var e,n,r,i=Gr(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._importation=new Ir,t}return e=o,(n=[{key:"fail",value:function(t){this.output.fail(t)}},{key:"start",value:function(){this.output.start()}},{key:"ofResource",value:function(t){return this._importation.resource=t,this}},{key:"at",value:function(t){return this._importation.origin.from.copy(t),this._importation.origin.to.copy(t),this}},{key:"from",value:function(t){return t?(this._importation.origin.from.copy(t),this):(this._importation.origin.from.clear(),this._importation.origin.from)}},{key:"to",value:function(t){return t?(this._importation.origin.to.copy(t),this):(this._importation.origin.to.clear(),this._importation.origin.to)}},{key:"next",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._importation;this.output.next(t)}},{key:"success",value:function(){this.output.success()}},{key:"clear",value:function(){this._importation.clear(),this.off()}}])&&Fr(e.prototype,n),r&&Fr(e,r),o}(Ft);function qr(t){return(qr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yr(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Kr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kr(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Kr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Xr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $r(t,e){return($r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Zr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Qr(t);if(e){var i=Qr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Jr(this,n)}}function Jr(t,e){return!e||"object"!==qr(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qr(t){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(){return new t}}(Vr||(Vr={})),function(t){t.CONTENT=0,t.IMPORTATION_START=1,t.IMPORTATION_CONTENT=2,t.IMPORTATION_TRAILING_WHITESPACE=3,t.ALL=[t.CONTENT,t.IMPORTATION_START,t.IMPORTATION_CONTENT,t.IMPORTATION_TRAILING_WHITESPACE],t.toString=function(e){switch(e){case t.CONTENT:return"CONTENT";case t.IMPORTATION_START:return"IMPORTATION_START";case t.IMPORTATION_CONTENT:return"IMPORTATION_CONTENT";case t.IMPORTATION_TRAILING_WHITESPACE:return"IMPORTATION_TRAILING_WHITESPACE";default:return}}}(zr||(zr={}));var ti="import",ei=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$r(t,e)}(o,t);var e,n,r,i=Zr(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).importations=new Vr,t._nextIdentifier="",t._buffer=kt.create(Ye.ALLOCATOR,16),t._state=zr.CONTENT,t}return e=o,(n=[{key:"start",value:function(){this.output.start(),this.importations.start(),this._buffer.clear(),this._nextIdentifier="",this._state=zr.CONTENT}},{key:"next",value:function(t){switch(this._state){case zr.CONTENT:return this.handleProductionAfterContent(t);case zr.IMPORTATION_START:return this.handleProductionAfterImportationStart(t);case zr.IMPORTATION_CONTENT:return this.handleProductionAfterImportationContent(t);case zr.IMPORTATION_TRAILING_WHITESPACE:return this.handleProductionAfterTrailingWhitespace(t);default:throw new Error("Unable to handle production in state #"+this._state+"("+zr.toString(this._state)+") because no procedure was defined for that.")}}},{key:"handleProductionAfterContent",value:function(t){t.type===S.START_TAG&&t.tag===ti?(this._buffer.push(t),this.importations.from(t.origin.from),this._state=zr.IMPORTATION_START):this.output.next(t)}},{key:"handleProductionAfterImportationStart",value:function(t){t.type===S.WHITESPACE?this._buffer.push(t):t.type===S.WORD?(this._buffer.push(t),this._nextIdentifier+=t.text,this._state=zr.IMPORTATION_CONTENT):this.handleInvalidImportationTag(t)}},{key:"handleProductionAfterImportationContent",value:function(t){t.type===S.WHITESPACE?(this._buffer.push(t),this._state=zr.IMPORTATION_TRAILING_WHITESPACE):t.type===S.END_TAG?t.tag===ti?(this.importations.to(t.origin.to),this.emitValidImportation()):this.handleInvalidImportationTag(t):t.type===S.WORD?(this._buffer.push(t),this._nextIdentifier+=t.text):this.handleInvalidImportationTag(t)}},{key:"handleProductionAfterTrailingWhitespace",value:function(t){t.type===S.WHITESPACE?(this._buffer.push(t),this._state=zr.IMPORTATION_TRAILING_WHITESPACE):t.type===S.END_TAG&&t.tag===ti?(this.importations.to(t.origin.to),this.emitValidImportation()):this.handleInvalidImportationTag(t)}},{key:"handleInvalidImportationTag",value:function(t){var e,n=Yr(this._buffer);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.output.next(r)}}catch(i){n.e(i)}finally{n.f()}this.output.next(t),this._buffer.clear(),this._nextIdentifier="",this._state=zr.CONTENT}},{key:"emitValidImportation",value:function(){this._buffer.clear(),this._state=zr.CONTENT,this.importations.ofResource(this._nextIdentifier),this._nextIdentifier="",this.importations.next()}},{key:"success",value:function(){this.importations.success(),this.output.success(),this._buffer.clear(),this._nextIdentifier="",this._state=zr.CONTENT}},{key:"failure",value:function(t){console.error(t)}}])&&Xr(e.prototype,n),r&&Xr(e,r),o}(Yt);function ni(t){return(ni="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ri(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ii(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oi(t,e){return(oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ai(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ui(t);if(e){var i=ui(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return si(this,n)}}function si(t,e){return!e||"object"!==ni(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ui(t){return(ui=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ci,fi=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},li=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oi(t,e)}(o,t);var e,n,r,i=ai(o);function o(){return ri(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"resolve",value:function(t){return fi(this,void 0,void 0,ye().mark((function t(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw"A null resolver can't resolve unidoc resources.";case 1:case"end":return t.stop()}}),t)})))}}])&&ii(e.prototype,n),r&&ii(e,r),o}(Ar);function hi(t){return(hi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pi(t){return function(t){if(Array.isArray(t))return vi(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||yi(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yi(t,e){if(t){if("string"===typeof t)return vi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vi(t,e):void 0}}function vi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function di(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bi(t,e){return(bi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_i(t);if(e){var i=_i(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return mi(this,n)}}function mi(t,e){return!e||"object"!==hi(e)&&"function"!==typeof e?Ei(t):e}function Ei(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _i(t){return(_i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.INSTANCE=new t}(li||(li={})),function(t){t.CREATED=0,t.RUNNING=1,t.IMPORTING=2,t.COMPLETED=3,t.ALL=[t.CREATED,t.RUNNING,t.IMPORTING,t.COMPLETED],t.toString=function(e){switch(e){case t.CREATED:return"CREATED";case t.RUNNING:return"RUNNING";case t.IMPORTING:return"IMPORTING";case t.COMPLETED:return"COMPLETED";default:return}}}(ci||(ci={}));var Ti=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bi(t,e)}(o,t);var e,n,r,i=gi(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this))._resources=U.Pack.any(16),e._import=new Ir,e._symbol=new Kn,e._resolver=t,e._state=ci.CREATED,e._oldState=ci.CREATED,e.executeImport=e.executeImport.bind(Ei(e)),e.fail=e.fail.bind(Ei(e)),e}return e=o,(n=[{key:"startIfNecessary",value:function(){this._state===ci.CREATED&&(this.output.start(),this._state=ci.RUNNING)}},{key:"import",value:function(t){"string"===typeof t?(this._import.resource=t,this._import.origin.at(Ce.runtime()),this.resolveImport(this._import)):this.resolveImport(t)}},{key:"resolveImport",value:function(t){this._oldState=this._state,this._state=ci.IMPORTING,this._resolver.resolve(t).then(this.executeImport).catch(this.fail)}},{key:"executeImport",value:function(t){this._state=this._oldState,this.stream(t)}},{key:"stream",value:function(t){for(this.assertThatThereIsNoCircularDependency(t),this.startIfNecessary(),this._resources.push(t);this.running&&this._state===ci.RUNNING;)this.next();this._state===ci.RUNNING&&(this._state=ci.COMPLETED,this.output.success())}},{key:"assertThatThereIsNoCircularDependency",value:function(t){var e,n=function(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=yi(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this._resources);try{for(n.s();!(e=n.n()).done;)if(e.value.resource===t.resource)throw new Error("Unable to stream resource "+t.resource+" imported from "+t.origin.origin.toString()+" because there is a circular dependency : "+pi(this._resources).map((function(t){return t.resource})).join(" > ")+" > "+t.resource+".")}catch(r){n.e(r)}finally{n.f()}}},{key:"fail",value:function(t){this.output.fail(t)}},{key:"next",value:function(){var t=this._resources.last.reader.next();for(this._symbol.code=t.code;this._resources.size>0&&!this._resources.last.reader.running;)this._resources.pop();this.output.next(t)}},{key:"running",get:function(){return this._resources.size>0}}])&&di(e.prototype,n),r&&di(e,r),o}(Ft);function ki(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Si=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._event=new Ye}var e,n,r;return e=t,(n=[{key:"setType",value:function(t){return this._event.type=t,this}},{key:"setSymbols",value:function(t){return this._event.symbols.copy(t),this}},{key:"setTag",value:function(t){return this._event.tag=t,this}},{key:"setIdentifier",value:function(t){return this._event.identifier=t,this}},{key:"decrementIndex",value:function(){return this._event.index-=1,this}},{key:"incrementIndex",value:function(){return this._event.index+=1,this}},{key:"setIndex",value:function(t){return this._event.index=t,this}},{key:"setClasses",value:function(t){return this._event.classes.clear(),this._event.addClasses(t),this}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._event.origin.from.copy(t),this._event.origin.to.copy(e),this}},{key:"setTo",value:function(t){return this._event.origin.to.copy(t),this}},{key:"setFrom",value:function(t){return this._event.origin.from.copy(t),this}},{key:"asWord",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._event.asWord(t),this}},{key:"asWhitespace",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._event.asWhitespace(t),this}},{key:"asTagStart",value:function(t){return this._event.asTagStart(t),this}},{key:"asTagEnd",value:function(t){return this._event.asTagEnd(t),this}},{key:"get",value:function(){return this._event}},{key:"build",value:function(){return this._event.clone()}},{key:"clear",value:function(){this._event.clear()}},{key:"index",get:function(){return this._event.index},set:function(t){this._event.index=t}},{key:"type",get:function(){return this._event.type},set:function(t){this._event.type=t}},{key:"origin",get:function(){return this._event.origin},set:function(t){this._event.origin.copy(t)}},{key:"from",get:function(){return this._event.origin.from},set:function(t){this._event.origin.from.copy(t)}},{key:"to",get:function(){return this._event.origin.to},set:function(t){this._event.origin.to.copy(t)}},{key:"symbols",get:function(){return this._event.symbols},set:function(t){this._event.symbols.copy(t)}},{key:"tag",get:function(){return this._event.tag},set:function(t){this._event.tag=t}},{key:"identifier",get:function(){return this._event.identifier},set:function(t){this._event.identifier=t}},{key:"classes",get:function(){return this._event.classes},set:function(t){this._event.classes.clear(),this._event.addClasses(t)}}])&&ki(e.prototype,n),r&&ki(e,r),t}();function Ai(t){return(Ai="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ii(t,e){return(Ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Oi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ni(t);if(e){var i=Ni(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ri(this,n)}}function Ri(t,e){return!e||"object"!==Ai(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ni(t){return(Ni=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(){return new t}}(Si||(Si={}));var xi=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ii(t,e)}(o,t);var e,n,r,i=Oi(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._event=new Si,t._tracker=new $n,t}return e=o,(n=[{key:"start",value:function(){return this.output.start(),this}},{key:"fail",value:function(t){return this.output.fail(t),this}},{key:"produceWord",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this._event;return n.from.clear(),n.to.clear(),n.from.text(this._tracker.location).runtime(),this._tracker.nextString(e),n.to.text(this._tracker.location).runtime(),n.asWord(t),this.output.next(n.get()),n.incrementIndex(),this}},{key:"produceText",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.produceString(e.join("\r\n"))}},{key:"produceString",value:function(t){if(t.length>0){for(var e=0,n=fe.isWhitespace(t.codePointAt(0)),r=1,i=t.length;r<i;++r)fe.isWhitespace(t.codePointAt(r))!==n&&(n?this.produceWhitespace(t.substring(e,r)):this.produceWord(t.substring(e,r)),e=r,n=!n);n?this.produceWhitespace(t.substring(e)):this.produceWord(t.substring(e))}return this}},{key:"produceWhitespace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this._event;return n.from.clear(),n.to.clear(),n.from.text(this._tracker.location).runtime(),this._tracker.nextString(e),n.to.text(this._tracker.location).runtime(),n.asWhitespace(t),this.output.next(n.get()),n.incrementIndex(),this}},{key:"produceTagStart",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\\"+t+"{",n=this._event;return n.from.clear(),n.to.clear(),n.from.text(this._tracker.location).runtime(),this._tracker.nextString(e),n.to.text(this._tracker.location).runtime(),n.asTagStart(t),this.output.next(n.get()),n.incrementIndex(),this}},{key:"produceTagEnd",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"}",n=this._event;return n.from.clear(),n.to.clear(),n.from.text(this._tracker.location).runtime(),this._tracker.nextString(e),n.to.text(this._tracker.location).runtime(),n.asTagEnd(t),this.output.next(n.get()),n.incrementIndex(),this}},{key:"produceTag",value:function(t,e){return this.produceTagStart(t),e.call(this),this.produceTagEnd(t),this}},{key:"success",value:function(){this.output.success()}},{key:"clear",value:function(){return this._event.clear(),this._tracker.clear(),this.off(),this}}])&&wi(e.prototype,n),r&&wi(e,r),o}(Ft);function Ci(t){return(Ci="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Li(t,e){return(Li=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Di(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Wi(t);if(e){var i=Wi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ui(this,n)}}function Ui(t,e){return!e||"object"!==Ci(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wi(t){return(Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(){return new t}}(xi||(xi={}));var ji,Fi=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Li(t,e)}(o,t);var e,n,r,i=Di(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._event=new Si,t._index=0,t}return e=o,(n=[{key:"fail",value:function(t){this.output.fail(t)}},{key:"start",value:function(){this.output.start()}},{key:"event",value:function(){return this._event.clear(),this}},{key:"setType",value:function(t){return this._event.setType(t),this}},{key:"setSymbols",value:function(t){return this._event.setSymbols(t),this}},{key:"setTag",value:function(t){return this._event.setTag(t),this}},{key:"setIdentifier",value:function(t){return this._event.setIdentifier(t),this}},{key:"setClasses",value:function(t){return this._event.setClasses(t),this}},{key:"produce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._event.get();t.index=this._index,this._index+=1,this.output.next(t)}},{key:"success",value:function(){this.output.success()}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._event.setOrigin(t,e),this}},{key:"setFrom",value:function(t){return this._event.setFrom(t),this}},{key:"setTo",value:function(t){return this._event.setTo(t),this}},{key:"produceWord",value:function(t){return this._event.asWord(t),this.produce(),this}},{key:"produceWhitespace",value:function(t){return this._event.asWhitespace(t),this.produce(),this}},{key:"produceTagStart",value:function(t){return this._event.asTagStart(t),this.produce(),this}},{key:"produceTagEnd",value:function(t){return this._event.asTagEnd(t),this.produce(),this}},{key:"tag",value:function(t,e){return this.produceTagStart(t),e.call(this),this.produceTagEnd(t),this}},{key:"clear",value:function(){this._event.clear(),this._index=0,this.off()}}])&&Pi(e.prototype,n),r&&Pi(e,r),o}(Ft);function Mi(t){return function(t){if(Array.isArray(t))return Bi(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Gi(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gi(t,e){if(t){if("string"===typeof t)return Bi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bi(t,e):void 0}}function Bi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Hi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(Fi||(Fi={})),function(t){t.IDENTIFIER=0,t.CLASS=1,t.TAG=2,t.BLOCK_START=3,t.BLOCK_END=4,t.NEW_LINE=5,t.SPACE=6,t.WORD=7,t.DEFAULT_TYPE=0,t.ALL=[t.IDENTIFIER,t.CLASS,t.TAG,t.BLOCK_START,t.BLOCK_END,t.NEW_LINE,t.SPACE,t.WORD],t.toString=function(e){switch(e){case t.IDENTIFIER:return"IDENTIFIER";case t.CLASS:return"CLASS";case t.TAG:return"TAG";case t.BLOCK_START:return"BLOCK_START";case t.BLOCK_END:return"BLOCK_END";case t.NEW_LINE:return"NEW_LINE";case t.SPACE:return"SPACE";case t.WORD:return"WORD";default:return}}}(ji||(ji={}));var Vi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;Hi(this,t),this.index=0,this.type=ji.DEFAULT_TYPE,this.symbols=U.Pack.uint32(e),this.origin=new je}var e,n,r;return e=t,(n=[{key:"substring",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.symbols.size-t,n=[],r=t,i=t+e,o=r;o<i;++o)n.push(this.symbols.get(o));return String.fromCodePoint.apply(String,n)}},{key:"as",value:function(t,e){this.type=t,this.text=e}},{key:"asIdentifier",value:function(t){this.as(ji.IDENTIFIER,t)}},{key:"asClass",value:function(t){this.as(ji.CLASS,t)}},{key:"asTag",value:function(t){this.as(ji.TAG,t)}},{key:"asBlockStart",value:function(){this.as(ji.BLOCK_START,"{")}},{key:"asBlockEnd",value:function(){this.as(ji.BLOCK_END,"}")}},{key:"asSpace",value:function(t){this.as(ji.SPACE,t)}},{key:"asNewline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\r\n";this.as(ji.NEW_LINE,t)}},{key:"asWord",value:function(t){this.as(ji.WORD,t)}},{key:"isTag",value:function(t){if(this.type===ji.TAG){if(this.symbols.get(0)!==fe.ANTISLASH)return!1;for(var e=1;e<this.symbols.size;++e){var n=this.symbols.get(e),r=t.codePointAt(e-1);if(n>=65&&n<=90&&(n+=32),r>=65&&r<=90&&(r+=32),n!==r)return!1}return!0}return!1}},{key:"copy",value:function(t){this.index=t.index,this.type=t.type,this.origin.copy(t.origin),this.symbols.copy(t.symbols)}},{key:"clone",value:function(){var e=new t(this.symbols.capacity);return e.copy(this),e}},{key:"clear",value:function(){this.index=0,this.type=ji.DEFAULT_TYPE,this.symbols.clear(),this.origin.clear()}},{key:"toString",value:function(){var t="";return t+="unidoc token ",t+=this.index.toString().padEnd(5),t+=" #",t+=this.type.toString().padEnd(2),t+=" (",t+=(ji.toString(this.type)||"undefined").padEnd(10),t+=') "',t+=this.debugText,t+='" ',t+=this.origin.toString()}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.index===this.index&&e.type===this.type&&e.origin.equals(this.origin)&&e.symbols.equals(this.symbols))}},{key:"text",get:function(){return String.fromCodePoint.apply(String,Mi(this.symbols))},set:function(t){this.symbols.clear();for(var e=0;e<t.length;++e)this.symbols.push(t.codePointAt(e))}},{key:"debugText",get:function(){var t,e=[],n=function(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Gi(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this.symbols);try{for(n.s();!(t=n.n()).done;){var r=t.value;switch(r){case fe.NEW_LINE:e.push(fe.COLON),e.push(fe.n);break;case fe.CARRIAGE_RETURN:e.push(fe.COLON),e.push(fe.r);break;case fe.TABULATION:e.push(fe.COLON),e.push(fe.t);break;case fe.SPACE:e.push(fe.COLON),e.push(fe.s);break;case fe.FORM_FEED:e.push(fe.COLON),e.push(fe.f);break;default:e.push(r)}}}catch(i){n.e(i)}finally{n.f()}return String.fromCodePoint.apply(String,e)}}])&&zi(e.prototype,n),r&&zi(e,r),t}();function qi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;return new t(e)}t.create=e,t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Duplicator.fromFactory(e)}(Vi||(Vi={}));var Ki,Xi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;qi(this,t),this._token=new Vi(e)}var e,n,r;return e=t,(n=[{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._token.origin.from.copy(t),this._token.origin.to.copy(e),this}},{key:"setFrom",value:function(t){return this._token.origin.from.copy(t),this}},{key:"setTo",value:function(t){return this._token.origin.to.copy(t),this}},{key:"setSymbols",value:function(t){return this._token.symbols.copy(t),this}},{key:"clearSymbols",value:function(){return this._token.symbols.clear(),this}},{key:"appendSymbols",value:function(t){return this._token.symbols.concat(t),this}},{key:"appendSymbol",value:function(t){return this._token.symbols.push(t),this}},{key:"setType",value:function(t){return this._token.type=t,this}},{key:"setIndex",value:function(t){return this._token.index=t,this}},{key:"incrementIndex",value:function(){return this._token.index+=1,this}},{key:"decrementIndex",value:function(){return this._token.index-=1,this}},{key:"asIdentifier",value:function(t){return this._token.asIdentifier(t),this}},{key:"asClass",value:function(t){return this._token.asClass(t),this}},{key:"asTag",value:function(t){return this._token.asTag(t),this}},{key:"asBlockStart",value:function(){return this._token.asBlockStart(),this}},{key:"asBlockEnd",value:function(){return this._token.asBlockEnd(),this}},{key:"asSpace",value:function(t){return this._token.asSpace(t),this}},{key:"asNewline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\r\n";return this._token.asNewline(t),this}},{key:"asWord",value:function(t){return this._token.asWord(t),this}},{key:"get",value:function(){return this._token}},{key:"build",value:function(){return this._token.clone()}},{key:"clear",value:function(){this._token.clear()}},{key:"index",get:function(){return this._token.index},set:function(t){this._token.index=t}},{key:"type",get:function(){return this._token.type},set:function(t){this._token.type=t}},{key:"origin",get:function(){return this._token.origin},set:function(t){this._token.origin.copy(t)}},{key:"from",get:function(){return this._token.origin.from},set:function(t){this._token.origin.from.copy(t)}},{key:"to",get:function(){return this._token.origin.to},set:function(t){this._token.origin.to.copy(t)}},{key:"symbols",get:function(){return this._token.symbols},set:function(t){this._token.symbols.copy(t)}}])&&Yi(e.prototype,n),r&&Yi(e,r),t}();function $i(t){return($i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ji(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qi(t,e){return(Qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function to(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=no(t);if(e){var i=no(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return eo(this,n)}}function eo(t,e){return!e||"object"!==$i(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function no(t){return(no=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(){return new t}}(Xi||(Xi={})),function(t){function e(e){switch(e){case t.START:return"START";case t.ANTISLASH:return"ANTISLASH";case t.SHARP:return"SHARP";case t.IDENTIFIER:return"IDENTIFIER";case t.DOT:return"DOT";case t.CLASS:return"CLASS";case t.TAG:return"TAG";case t.SPACE:return"SPACE";case t.CARRIAGE_RETURN:return"CARRIAGE_RETURN";case t.WORD:return"WORD";case t.END:return"END";default:return}}t.START=0,t.ANTISLASH=1,t.SHARP=2,t.IDENTIFIER=3,t.DOT=4,t.CLASS=5,t.TAG=6,t.SPACE=7,t.CARRIAGE_RETURN=8,t.WORD=9,t.END=10,t.ALL=[t.START,t.ANTISLASH,t.SHARP,t.IDENTIFIER,t.DOT,t.CLASS,t.TAG,t.SPACE,t.CARRIAGE_RETURN,t.WORD,t.END],t.DEFAULT=t.START,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(Ki||(Ki={}));var ro,io=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qi(t,e)}(o,t);var e,n,r,i=to(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64;return Zi(this,o),(t=i.call(this))._state=Ki.START,t._token=new Xi(e),t}return e=o,(n=[{key:"start",value:function(){}},{key:"failure",value:function(t){this.output.fail(t)}},{key:"next",value:function(t){switch(this._state){case Ki.SPACE:return this.nextAfterSpace(t);case Ki.CARRIAGE_RETURN:return this.nextAfterCarriageReturn(t);case Ki.SHARP:return this.nextAfterSharp(t);case Ki.IDENTIFIER:return this.nextAfterIdentifier(t);case Ki.DOT:return this.nextAfterDot(t);case Ki.CLASS:return this.nextAfterClass(t);case Ki.ANTISLASH:return this.nextAfterAntislash(t);case Ki.TAG:return this.nextAfterTag(t);case Ki.WORD:return this.nextAfterWord(t);default:return this.nextAfterStart(t)}}},{key:"success",value:function(){switch(this._state){case Ki.END:break;case Ki.SHARP:case Ki.DOT:case Ki.ANTISLASH:this.emit(ji.WORD);break;case Ki.SPACE:this.emit(ji.SPACE);break;case Ki.CARRIAGE_RETURN:this.emit(ji.NEW_LINE);break;case Ki.TAG:this.emit(ji.TAG);break;case Ki.WORD:this.emit(ji.WORD);break;case Ki.IDENTIFIER:this.emit(ji.IDENTIFIER);break;case Ki.CLASS:this.emit(ji.CLASS);break;case Ki.START:}this._state=Ki.END,this.output.success()}},{key:"nextAfterAntislash",value:function(t){var e=t.code;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS||e===fe.DOUBLE_DOT)this._token.appendSymbol(e).setTo(t.origin.to),this._state=Ki.TAG;else switch(e){case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:this.emit(ji.WORD),this._state=Ki.START,this.nextAfterStart(t);break;default:this._token.appendSymbol(e).setTo(t.origin.to),this._state=Ki.WORD}}},{key:"nextAfterTag",value:function(t){var e=t.code;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS)this._token.appendSymbol(e).setTo(t.origin.to);else switch(e){case fe.TABULATION:case fe.ANTISLASH:case fe.SPACE:case fe.FORM_FEED:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:case fe.DOT:case fe.SHARP:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emit(ji.TAG),this._state=Ki.START,this.nextAfterStart(t);break;default:this._token.appendSymbol(e).setTo(t.origin.to),this._state=Ki.WORD}}},{key:"nextAfterWord",value:function(t){var e=t.code;switch(e){case fe.TABULATION:case fe.SPACE:case fe.FORM_FEED:case fe.NEW_LINE:case fe.ANTISLASH:case fe.CARRIAGE_RETURN:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emit(ji.WORD),this._state=Ki.START,this.nextAfterStart(t);break;default:this._token.appendSymbol(e).setTo(t.origin.to)}}},{key:"nextAfterCarriageReturn",value:function(t){var e=t.code;switch(e){case fe.NEW_LINE:this._token.appendSymbol(e).setTo(t.origin.to),this.emit(ji.NEW_LINE),this._state=Ki.START;break;default:this.emit(ji.NEW_LINE),this._state=Ki.START,this.nextAfterStart(t)}}},{key:"nextAfterSpace",value:function(t){var e=t.code;switch(e){case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:this._token.appendSymbol(e).setTo(t.origin.to);break;default:this.emit(ji.SPACE),this._state=Ki.START,this.nextAfterStart(t)}}},{key:"nextAfterDot",value:function(t){var e=t.code;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS)this._token.appendSymbol(e).setTo(t.origin.to),this._state=Ki.CLASS;else switch(e){case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emit(ji.WORD),this._state=Ki.START,this.nextAfterStart(t);break;default:this._token.appendSymbol(e).setTo(t.origin.to),this._state=Ki.WORD}}},{key:"nextAfterClass",value:function(t){var e=t.code;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS)this._token.appendSymbol(e).setTo(t.origin.to);else switch(e){case fe.TABULATION:case fe.ANTISLASH:case fe.SPACE:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:case fe.DOT:case fe.SHARP:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emit(ji.CLASS),this._state=Ki.START,this.nextAfterStart(t);break;default:this._token.appendSymbol(e).setTo(t.origin.to),this._state=Ki.WORD}}},{key:"nextAfterSharp",value:function(t){var e=t.code;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS)this._token.appendSymbol(e).setTo(t.origin.to),this._state=Ki.IDENTIFIER;else switch(e){case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emit(ji.WORD),this._state=Ki.START,this.nextAfterStart(t);break;default:this._token.appendSymbol(e).setTo(t.origin.to),this._state=Ki.WORD}}},{key:"nextAfterIdentifier",value:function(t){var e=t.code;if(e>=fe.a&&e<=fe.z||e>=fe.A&&e<=fe.Z||e>=fe.ZERO&&e<=fe.NINE||e===fe.MINUS)this._token.appendSymbol(e).setTo(t.origin.to);else switch(e){case fe.TABULATION:case fe.ANTISLASH:case fe.SPACE:case fe.NEW_LINE:case fe.CARRIAGE_RETURN:case fe.DOT:case fe.SHARP:case fe.OPENING_BRACE:case fe.CLOSING_BRACE:this.emit(ji.IDENTIFIER),this._state=Ki.START,this.nextAfterStart(t);break;default:this._token.appendSymbol(e).setTo(t.origin.to),this._state=Ki.WORD}}},{key:"nextAfterStart",value:function(t){var e=t.code;switch(this._token.appendSymbol(e).setOrigin(t.origin.from,t.origin.to),e){case fe.OPENING_BRACE:this.emit(ji.BLOCK_START);break;case fe.CLOSING_BRACE:this.emit(ji.BLOCK_END);break;case fe.ANTISLASH:this._state=Ki.ANTISLASH;break;case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:this._state=Ki.SPACE;break;case fe.NEW_LINE:this.emit(ji.NEW_LINE);break;case fe.CARRIAGE_RETURN:this._state=Ki.CARRIAGE_RETURN;break;case fe.SHARP:this._state=Ki.SHARP;break;case fe.DOT:this._state=Ki.DOT;break;default:this._state=Ki.WORD}}},{key:"emit",value:function(t){var e=this._token,n=this.output;0===e.index&&n.start(),e.setType(t),n.next(e.get()),e.setOrigin(e.to).clearSymbols(),e.incrementIndex()}},{key:"clear",value:function(){this._state=Ki.START,this._token.clear(),this.off()}},{key:"state",get:function(){return this._state}}])&&Ji(e.prototype,n),r&&Ji(e,r),o}(Yt);function oo(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return ao(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ao(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function so(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.START=0,t.LEADING_WHITESPACE=1,t.CLASS_OF_STREAM_WITHOUT_IDENTIFIER=2,t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER=3,t.CLASS_OF_STREAM_WITH_IDENTIFIER=4,t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER=5,t.STREAM_CONTENT=6,t.BLOCK_CONTENT=7,t.ERROR=8,t.WHITESPACE=9,t.WORD=10,t.CLASS_OF_TAG_WITHOUT_IDENTIFIER=11,t.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER=12,t.CLASS_OF_TAG_WITH_IDENTIFIER=13,t.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER=14,t.TERMINATION=15,t.DEFAULT=t.START,t.ALL=[t.START,t.LEADING_WHITESPACE,t.CLASS_OF_STREAM_WITHOUT_IDENTIFIER,t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER,t.CLASS_OF_STREAM_WITH_IDENTIFIER,t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER,t.STREAM_CONTENT,t.BLOCK_CONTENT,t.ERROR,t.WHITESPACE,t.WORD,t.CLASS_OF_TAG_WITHOUT_IDENTIFIER,t.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER,t.CLASS_OF_TAG_WITH_IDENTIFIER,t.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER,t.TERMINATION],t.toString=function(e){switch(e){case t.START:return"START";case t.LEADING_WHITESPACE:return"LEADING_WHITESPACE";case t.CLASS_OF_STREAM_WITHOUT_IDENTIFIER:return"CLASS_OF_STREAM_WITHOUT_IDENTIFIER";case t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER:return"WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER";case t.CLASS_OF_STREAM_WITH_IDENTIFIER:return"CLASS_OF_STREAM_WITH_IDENTIFIER";case t.WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER:return"WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER";case t.STREAM_CONTENT:return"STREAM_CONTENT";case t.BLOCK_CONTENT:return"BLOCK_CONTENT";case t.ERROR:return"ERROR";case t.WHITESPACE:return"WHITESPACE";case t.WORD:return"WORD";case t.CLASS_OF_TAG_WITHOUT_IDENTIFIER:return"CLASS_OF_TAG_WITHOUT_IDENTIFIER";case t.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER:return"WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER";case t.CLASS_OF_TAG_WITH_IDENTIFIER:return"CLASS_OF_TAG_WITH_IDENTIFIER";case t.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER:return"WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER";case t.TERMINATION:return"TERMINATION";default:return}}}(ro||(ro={}));var uo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=ro.START,this.tag="",this.identifier="",this.content=U.Pack.uint32(128),this.classes=new Set,this.origin=new je,this.origin.from.text(0,0,0).runtime(),this.origin.to.text(0,0,0).runtime()}var e,n,r;return e=t,(n=[{key:"begin",value:function(t,e){if(this.clear(),this.type=t,e instanceof Vi){switch(e.type){case ji.CLASS:this.classes.add(e.substring(1));break;case ji.IDENTIFIER:this.identifier=e.substring(1);break;case ji.TAG:this.tag=e.substring(1);break;case ji.NEW_LINE:case ji.SPACE:case ji.WORD:this.content.concat(e.symbols)}this.origin.copy(e.origin)}else this.origin.at(e)}},{key:"append",value:function(t){switch(t.type){case ji.CLASS:this.classes.add(t.substring(1));break;case ji.IDENTIFIER:this.identifier=t.substring(1);break;case ji.TAG:this.tag=t.substring(1);break;case ji.NEW_LINE:case ji.SPACE:case ji.WORD:this.content.concat(t.symbols)}this.origin.to.copy(t.origin.to)}},{key:"clear",value:function(){this.type=ro.START,this.tag="",this.identifier="",this.content.clear(),this.classes.clear(),this.origin.clear(),this.origin.from.text(0,0,0).runtime(),this.origin.to.text(0,0,0).runtime()}},{key:"copy",value:function(t){this.type=t.type,this.tag=t.tag,this.identifier=t.identifier,this.content.copy(t.content),this.origin.copy(t.origin),this.classes.clear();var e,n=oo(t.classes);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.classes.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.type!==this.type||e.tag!==this.tag||e.identifier!==this.identifier||!e.content.equals(this.content)||!e.origin.equals(this.origin)||e.classes.size!==this.classes.size)return!1;var n,r=oo(e.classes);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!this.classes.has(i))return!1}}catch(o){r.e(o)}finally{r.f()}return!0}return!1}}])&&so(e.prototype,n),r&&so(e,r),t}();function co(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.create=e,t.ALLOCATOR=U.Duplicator.fromFactory(e)}(uo||(uo={}));var lo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;co(this,t),this._states=U.Pack.instance(uo.ALLOCATOR,e),this.states=this._states.view()}var e,n,r;return e=t,(n=[{key:"reallocate",value:function(t){this._states.reallocate(t)}},{key:"get",value:function(t){return this.states.get(t)}},{key:"push",value:function(t){this._states.size+=1,this._states.last.type=t}},{key:"delete",value:function(t){this._states.delete(t)}},{key:"pop",value:function(){this._states.pop()}},{key:"clear",value:function(){this._states.clear()}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e._states.size!==this._states.size)return!1;for(var n=0,r=this._states.size;n<r;++n)if(!e._states.get(n).equals(this._states.get(n)))return!1;return!0}return!1}},{key:"first",get:function(){return this._states.first}},{key:"last",get:function(){return this._states.last}},{key:"capacity",get:function(){return this._states.capacity}},{key:"size",get:function(){return this._states.size},set:function(t){this._states.size=t}}])&&fo(e.prototype,n),r&&fo(e,r),t}();function ho(t){return(ho="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function po(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vo(t,e){return(vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=mo(t);if(e){var i=mo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return go(this,n)}}function go(t,e){return!e||"object"!==ho(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mo(t){return(mo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Eo,_o="document",To="block",ko=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vo(t,e)}(o,t);var e,n,r,i=bo(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;return po(this,o),(t=i.call(this))._states=new lo(e),t._event=new Si,t._states.push(ro.START),t}return e=o,(n=[{key:"start",value:function(){}},{key:"failure",value:function(t){this.output.fail(t)}},{key:"next",value:function(t){switch(this._states.last.type){case ro.START:this.nextAfterStart(t);break;case ro.STREAM_CONTENT:this.nextAfterStreamContent(t);break;case ro.BLOCK_CONTENT:this.nextAfterBlockContent(t);break;case ro.WHITESPACE:this.nextAfterWhitespace(t);break;case ro.WORD:this.nextAfterWord(t);break;case ro.CLASS_OF_TAG_WITHOUT_IDENTIFIER:this.nextAfterClassOfTagWithoutIdentifier(t);break;case ro.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER:this.nextAfterWhitespaceAfterClassOfTagWithoutIdentifier(t);break;case ro.CLASS_OF_TAG_WITH_IDENTIFIER:this.nextAfterClassOfTagWithIdentifier(t);break;case ro.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER:this.nextAfterWhitespaceAfterClassOfTagWithIdentifier(t);break;case ro.ERROR:this.nextAfterError(t);break;case ro.LEADING_WHITESPACE:this.nextAfterLeadingWhitespace(t);break;case ro.CLASS_OF_STREAM_WITHOUT_IDENTIFIER:this.nextAfterClassOfStreamWithoutIdentifier(t);break;case ro.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER:this.nextAfterWhitespaceAfterClassOfStreamWithoutIdentifier(t);break;case ro.CLASS_OF_STREAM_WITH_IDENTIFIER:this.nextAfterClassOfStreamWithIdentifier(t);break;case ro.WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER:this.nextAfterWhitespaceAfterClassOfStreamWithIdentifier(t);break;default:this.throwUhandledParserState(t)}}},{key:"throwUhandledParserState",value:function(t){throw new Error("Unable to handle token of type #"+t.type+' "'+ji.toString(t.type)+'" because this parser does not define an execution process when it has to handle a token when it is in #'+this._states.last.type+' "'+ro.toString(this._states.last.type)+'" state')}},{key:"success",value:function(){switch(this._states.last.type){case ro.START:this.emitVirtualDocumentStart(),this.emitVirtualDocumentEnd(),this._states.last.type=ro.TERMINATION,this.success();break;case ro.STREAM_CONTENT:case ro.BLOCK_CONTENT:this.emitTagEnd(),this._states.last.type=ro.TERMINATION,this._states.last.origin.at(this._states.last.origin.to),this.success();break;case ro.WHITESPACE:this.emitWhitespaceEvent(),this._states.get(this._states.size-2).origin.at(this._states.last.origin.to),this._states.pop(),this.success();break;case ro.WORD:this.emitWordEvent(),this._states.get(this._states.size-2).origin.at(this._states.last.origin.to),this._states.pop(),this.success();break;case ro.CLASS_OF_TAG_WITHOUT_IDENTIFIER:case ro.CLASS_OF_TAG_WITH_IDENTIFIER:this.emitTagStart(),this._states.last.origin.at(this._states.last.origin.to),this.emitTagEnd(),this._states.pop(),this.success();break;case ro.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER:case ro.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER:this.emitTagStart(this._states.get(this._states.size-2)),this._states.get(this._states.size-2).origin.at(this._states.last.origin.from),this.emitTagEnd(this._states.get(this._states.size-2)),this.emitWhitespaceEvent(),this._states.pop(),this._states.pop(),this.success();break;case ro.ERROR:this.throwUnhandledCompletionParserState();break;case ro.LEADING_WHITESPACE:this.emitVirtualDocumentStart(),this.emitWhitespaceEvent(),this.emitVirtualDocumentEnd(),this._states.last.type=ro.TERMINATION,this._states.last.origin.at(this._states.last.origin.to),this.success();break;case ro.CLASS_OF_STREAM_WITHOUT_IDENTIFIER:case ro.CLASS_OF_STREAM_WITH_IDENTIFIER:this.emitTagStart(),this.emitVirtualDocumentEnd(),this._states.last.type=ro.TERMINATION,this._states.last.origin.at(this._states.last.origin.to),this.success();break;case ro.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER:this.emitTagStart(this._states.get(this._states.size-2)),this._states.get(this._states.size-2).origin.at(this._states.last.origin.from),this.emitWhitespaceEvent(),this._states.pop(),this.emitVirtualDocumentEnd(),this._states.last.type=ro.TERMINATION,this._states.last.origin.at(this._states.last.origin.to),this.success();break;case ro.TERMINATION:return void this.output.success();default:this.throwUnhandledCompletionParserState()}}},{key:"throwUnhandledCompletionParserState",value:function(){throw new Error("Unable to handle stream completion because this parser does not define an execution process when it has to handle a completion when it is in #"+this._states.last.type+' "'+ro.toString(this._states.last.type)+'" state')}},{key:"nextAfterStart",value:function(t){switch(this._states.last.origin.at(t.origin.from),this._states.last.tag=_o,t.type){case ji.NEW_LINE:case ji.SPACE:return this._states.last.type=ro.LEADING_WHITESPACE,void this._states.last.append(t);case ji.TAG:case ji.BLOCK_START:case ji.WORD:case ji.IDENTIFIER:case ji.CLASS:return void(t.isTag(_o)?(this._states.last.type=ro.CLASS_OF_STREAM_WITHOUT_IDENTIFIER,this._states.last.origin.to.copy(t.origin.to)):(this.emitVirtualDocumentStart(),this._states.last.type=ro.STREAM_CONTENT,this.next(t)));case ji.BLOCK_END:return this.emitDocumentStartWithBlockEndingError(),void this.recoverFromDocumentStartWithBlockEndingError(t);default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterLeadingWhitespace",value:function(t){switch(t.type){case ji.NEW_LINE:case ji.SPACE:return void this._states.last.append(t);case ji.TAG:case ji.BLOCK_START:case ji.WORD:case ji.IDENTIFIER:case ji.CLASS:return void(t.isTag(_o)?(this._states.last.type=ro.CLASS_OF_STREAM_WITHOUT_IDENTIFIER,this._states.last.origin.to.copy(t.origin.to),this._states.last.content.clear()):(this.emitVirtualDocumentStart(),this.emitWhitespaceEvent(),this._states.last.type=ro.STREAM_CONTENT,this._states.last.origin.at(t.origin.from),this.next(t)));case ji.BLOCK_END:return this.emitDocumentStartWithBlockEndingError(),void this.recoverFromDocumentStartWithBlockEndingError(t);default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterClassOfStreamWithoutIdentifier",value:function(t){switch(t.type){case ji.SPACE:case ji.NEW_LINE:return this._states.push(ro.WHITESPACE_AFTER_CLASS_OF_STREAM_WITHOUT_IDENTIFIER),this._states.last.origin.at(t.origin.from),void this._states.last.append(t);case ji.IDENTIFIER:return this._states.last.append(t),void(this._states.last.type=ro.CLASS_OF_STREAM_WITH_IDENTIFIER);case ji.CLASS:return void this._states.last.append(t);case ji.TAG:case ji.WORD:case ji.BLOCK_START:case ji.BLOCK_END:return this.emitTagStart(),this._states.last.type=ro.STREAM_CONTENT,this._states.last.origin.at(t.origin.from),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterWhitespaceAfterClassOfStreamWithoutIdentifier",value:function(t){switch(t.type){case ji.SPACE:case ji.NEW_LINE:return void this._states.last.append(t);case ji.IDENTIFIER:case ji.CLASS:return this._states.pop(),void this.next(t);case ji.TAG:case ji.WORD:case ji.BLOCK_START:case ji.BLOCK_END:return this.emitTagStart(this._states.get(this._states.size-2)),this.emitWhitespaceEvent(),this._states.pop(),this._states.last.type=ro.STREAM_CONTENT,this._states.last.origin.at(t.origin.from),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterClassOfStreamWithIdentifier",value:function(t){switch(t.type){case ji.SPACE:case ji.NEW_LINE:return this._states.push(ro.WHITESPACE_AFTER_CLASS_OF_STREAM_WITH_IDENTIFIER),this._states.last.origin.at(t.origin.from),void this._states.last.append(t);case ji.CLASS:return void this._states.last.append(t);case ji.TAG:case ji.WORD:case ji.BLOCK_START:case ji.BLOCK_END:case ji.IDENTIFIER:return this.emitTagStart(),this._states.last.type=ro.STREAM_CONTENT,this._states.last.origin.at(t.origin.from),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterWhitespaceAfterClassOfStreamWithIdentifier",value:function(t){switch(t.type){case ji.SPACE:case ji.NEW_LINE:return void this._states.last.append(t);case ji.CLASS:return this._states.pop(),void this.next(t);case ji.IDENTIFIER:case ji.TAG:case ji.WORD:case ji.BLOCK_START:case ji.BLOCK_END:return this.emitTagStart(this._states.get(0)),this.emitWhitespaceEvent(),this._states.pop(),this._states.last.type=ro.STREAM_CONTENT,this._states.last.origin.at(t.origin.from),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterStreamContent",value:function(t){switch(t.type){case ji.TAG:case ji.NEW_LINE:case ji.SPACE:case ji.WORD:case ji.IDENTIFIER:case ji.CLASS:case ji.BLOCK_START:return void this.nextAfterContent(t);case ji.BLOCK_END:throw new Error("Trying to terminate a stream of content.");default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterBlockContent",value:function(t){switch(t.type){case ji.TAG:case ji.NEW_LINE:case ji.SPACE:case ji.WORD:case ji.IDENTIFIER:case ji.CLASS:case ji.BLOCK_START:return void this.nextAfterContent(t);case ji.BLOCK_END:this._states.last.append(t),this.emitTagEnd(),this._states.pop(),this._states.last.origin.at(t.origin.to);break;default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterContent",value:function(t){switch(t.type){case ji.TAG:this._states.push(ro.CLASS_OF_TAG_WITHOUT_IDENTIFIER),this._states.last.origin.at(t.origin.from),this._states.last.append(t);break;case ji.NEW_LINE:case ji.SPACE:this._states.push(ro.WHITESPACE),this._states.last.origin.at(t.origin.from),this._states.last.append(t);break;case ji.WORD:this._states.push(ro.WORD),this._states.last.origin.at(t.origin.from),this._states.last.append(t);break;case ji.IDENTIFIER:this._states.push(ro.CLASS_OF_TAG_WITH_IDENTIFIER),this._states.last.origin.at(t.origin.from),this._states.last.append(t),this._states.last.tag=To;break;case ji.CLASS:this._states.push(ro.CLASS_OF_TAG_WITHOUT_IDENTIFIER),this._states.last.origin.at(t.origin.from),this._states.last.append(t),this._states.last.tag=To;break;case ji.BLOCK_START:this._states.push(ro.BLOCK_CONTENT),this._states.last.origin.at(t.origin.from),this._states.last.append(t),this._states.last.tag=To,this.emitTagStart(),this._states.last.origin.from.copy(t.origin.to);break;default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterWhitespace",value:function(t){switch(t.type){case ji.SPACE:case ji.NEW_LINE:return void this._states.last.append(t);default:return this.emitWhitespaceEvent(),this._states.pop(),this._states.last.origin.at(t.origin.from),void this.next(t)}}},{key:"nextAfterWord",value:function(t){switch(t.type){case ji.WORD:return void this._states.last.append(t);default:return this.emitWordEvent(),this._states.pop(),this._states.last.origin.at(t.origin.from),void this.next(t)}}},{key:"nextAfterClassOfTagWithoutIdentifier",value:function(t){switch(t.type){case ji.SPACE:case ji.NEW_LINE:return this._states.push(ro.WHITESPACE_AFTER_CLASS_OF_TAG_WITHOUT_IDENTIFIER),this._states.last.origin.at(t.origin.from),void this._states.last.append(t);case ji.IDENTIFIER:return this._states.last.append(t),void(this._states.last.type=ro.CLASS_OF_TAG_WITH_IDENTIFIER);case ji.CLASS:return void this._states.last.append(t);case ji.TAG:case ji.WORD:case ji.BLOCK_END:return this.emitTagStart(),this._states.last.origin.at(this._states.last.origin.to),this.emitTagEnd(),this._states.pop(),void this.next(t);case ji.BLOCK_START:return this._states.last.append(t),this.emitTagStart(),this._states.last.type=ro.BLOCK_CONTENT,void this._states.last.origin.at(t.origin.to);default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterWhitespaceAfterClassOfTagWithoutIdentifier",value:function(t){switch(t.type){case ji.SPACE:case ji.NEW_LINE:return void this._states.last.append(t);case ji.IDENTIFIER:case ji.CLASS:case ji.BLOCK_START:return this._states.pop(),this._states.last.origin.to.copy(t.origin.from),void this.next(t);case ji.TAG:case ji.WORD:case ji.BLOCK_END:return this.emitTagStart(this._states.get(this._states.size-2)),this._states.get(this._states.size-2).origin.at(this._states.last.origin.from),this.emitTagEnd(this._states.get(this._states.size-2)),this.emitWhitespaceEvent(),this._states.pop(),this._states.pop(),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterClassOfTagWithIdentifier",value:function(t){switch(t.type){case ji.SPACE:case ji.NEW_LINE:return this._states.push(ro.WHITESPACE_AFTER_CLASS_OF_TAG_WITH_IDENTIFIER),this._states.last.origin.at(t.origin.from),void this._states.last.append(t);case ji.CLASS:return void this._states.last.append(t);case ji.TAG:case ji.WORD:case ji.BLOCK_END:case ji.IDENTIFIER:return this.emitTagStart(),this._states.last.origin.at(this._states.last.origin.to),this.emitTagEnd(),this._states.pop(),void this.next(t);case ji.BLOCK_START:return this._states.last.append(t),this.emitTagStart(),this._states.last.type=ro.BLOCK_CONTENT,void this._states.last.origin.at(t.origin.to);default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterWhitespaceAfterClassOfTagWithIdentifier",value:function(t){switch(t.type){case ji.SPACE:case ji.NEW_LINE:return void this._states.last.append(t);case ji.CLASS:case ji.BLOCK_START:return this._states.pop(),this._states.last.origin.to.copy(t.origin.from),void this.next(t);case ji.IDENTIFIER:case ji.TAG:case ji.WORD:case ji.BLOCK_END:return this.emitTagStart(this._states.get(this._states.size-2)),this._states.get(this._states.size-2).origin.at(this._states.last.origin.from),this.emitTagEnd(this._states.get(this._states.size-2)),this.emitWhitespaceEvent(),this._states.pop(),this._states.pop(),void this.next(t);default:this.throwUnhandledTokenType(t)}}},{key:"nextAfterError",value:function(t){this.throwUnhandledTokenType(t)}},{key:"throwUnhandledTokenType",value:function(t){throw new Error("The token type #"+t.type+' "'+ji.toString(t.type)+'" is currently not handled by this parser when it is in state #'+this._states.last.type+' "'+ro.toString(this._states.last.type)+'".')}},{key:"recoverFromDocumentStartWithBlockEndingError",value:function(t){this._states.last.origin.from.copy(t.origin.to)}},{key:"emitDocumentStartWithBlockEndingError",value:function(){}},{key:"emitVirtualDocumentStart",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._event.setOrigin(t.origin.from).asTagStart(_o),this.emit()}},{key:"emitVirtualDocumentEnd",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._event.setOrigin(t.origin.to).asTagEnd(_o),this.emit()}},{key:"emitTagStart",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._event.setOrigin(t.origin.from,t.origin.to).asTagStart(t.tag).setClasses(t.classes).setIdentifier(t.identifier),this.emit()}},{key:"emitTagEnd",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._event.setOrigin(t.origin.from,t.origin.to).asTagEnd(t.tag).setClasses(t.classes).setIdentifier(t.identifier),this.emit()}},{key:"emitWhitespaceEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._event.setOrigin(t.origin.from,t.origin.to).asWhitespace().setSymbols(t.content),this.emit()}},{key:"emitWordEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._states.last;this._event.setOrigin(t.origin.from,t.origin.to).asWord().setSymbols(t.content),this.emit()}},{key:"emit",value:function(){var t=this._event,e=this.output;0===t.index&&e.start(),e.next(t.get()),t.incrementIndex()}},{key:"clear",value:function(){this.off(),this._states.clear(),this._states.push(ro.START),this._event.clear()}}])&&yo(e.prototype,n),r&&yo(e,r),o}(Yt);function So(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Ao(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ao(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.TAG=0,t.SYMBOL=1,t.STREAM=2,t.FILE=3,t.MEMORY=4,t.ALL=[t.TAG,t.SYMBOL,t.STREAM,t.FILE,t.MEMORY],t.toString=function(e){switch(e){case t.TAG:return"TAG";case t.SYMBOL:return"SYMBOL";case t.STREAM:return"STREAM";case t.FILE:return"FILE";case t.MEMORY:return"MEMORY";default:return}}}(Eo||(Eo={}));var Io=/^([a-zA-Z0-9\-]+)(#[a-zA-Z0-9\-]+)?(\.[a-zA-Z0-9\-]+)*$/i,Oo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=Eo.SYMBOL,this.from=new Ae,this.to=new Ae,this.name="",this.identifier="",this.classes=new Set}var e,n,r;return e=t,(n=[{key:"asFile",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.clear(),this.type=Eo.FILE,this.name=t,this.from.copy(e),this.to.copy(n)}},{key:"asStream",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this.clear(),this.type=Eo.STREAM,this.from.copy(t),this.to.copy(e)}},{key:"asMemory",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.clear(),this.type=Eo.MEMORY,this.name=t,this.from.copy(e),this.to.copy(n)}},{key:"asSymbol",value:function(t){this.clear(),this.type=Eo.SYMBOL,this.from.copy(t),this.to.copy(t)}},{key:"asTag",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.clear(),this.type=Eo.TAG,this.from.copy(t),this.to.copy(e);var r=Io.exec(n);if(null!=r)for(var i=1;i<r.length;++i){var o=r[i];o.startsWith("#")?this.identifier=o.substring(1):o.startsWith(".")?this.classes.add(o.substring(1)):this.name=o}}},{key:"addClasses",value:function(t){var e,n=So(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.classes.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"copy",value:function(t){this.type=t.type,this.from.copy(t.from),this.to.copy(t.to),this.name=t.name,this.identifier=t.identifier,this.classes.clear();var e,n=So(t.classes);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.classes.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"clear",value:function(){this.type=Eo.SYMBOL,this.from.clear(),this.to.clear(),this.name="",this.identifier="",this.classes.clear()}},{key:"toString",value:function(){var t="";this.type===Eo.SYMBOL&&(t+="symbol"),this.type===Eo.STREAM&&(t+="stream"),this.type===Eo.MEMORY&&(t+="memory:\\\\"),this.type===Eo.FILE&&(t+="file:\\\\"),this.name.length>0&&(this.type===Eo.TAG&&(t+="\\"),t+=this.name),this.identifier.length>0&&(t+="#",t+=this.identifier);var e,n=So(this.classes);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=".",t+=r}}catch(i){n.e(i)}finally{n.f()}return this.from.isUnknown()||this.to.isUnknown()?this.from.isUnknown()?this.to.isUnknown()||(t+=" until "+this.to.toString()):t+=" from "+this.from.toString():this.from.equals(this.to)?t+=" at "+this.from.toString():t+=" between "+this.from.toString()+" and "+this.to.toString(),t}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.type!==this.type||e.classes.size!==this.classes.size||e.identifier!==this.identifier||e.name!==this.name||!e.from.equals(this.from)||!e.to.equals(this.to))return!1;var n,r=So(e.classes);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!this.classes.has(i))return!1}}catch(o){r.e(o)}finally{r.f()}return!0}return!1}}])&&wo(e.prototype,n),r&&wo(e,r),t}();function Ro(t,e,n){return(Ro=No()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&xo(i,n.prototype),i}).apply(null,arguments)}function No(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function xo(t,e){return(xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Co(t){return function(t){if(Array.isArray(t))return Do(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Lo(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Po(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Lo(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Lo(t,e){if(t){if("string"===typeof t)return Do(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Do(t,e):void 0}}function Do(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Uo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.create=e,t.copy=function(t){return null==t?t:t.clone()},t.ALLOCATOR=U.Duplicator.fromFactory(e)}(Oo||(Oo={}));var jo,Fo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;Uo(this,t),this._elements=U.Pack.instance(Oo.ALLOCATOR,e),this.elements=this._elements.view()}var e,n,r;return e=t,(n=[{key:"push",value:function(t){return this._elements.push(t),this}},{key:"pushSymbol",value:function(t){return this._elements.size+=1,this._elements.last.asSymbol(t),this}},{key:"pushTag",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._elements.size+=1,this._elements.last.asTag(t,e,n),this}},{key:"pushStream",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._elements.size+=1,this._elements.last.asStream(t,e),this}},{key:"pushMemory",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return this._elements.size+=1,this._elements.last.asMemory(t,e,n),this}},{key:"pushFile",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return this._elements.size+=1,this._elements.last.asFile(t,e,n),this}},{key:"snapToEnd",value:function(){var t,e=Po(this._elements);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.from.copy(n.to)}}catch(r){e.e(r)}finally{e.f()}return this}},{key:"snapToStart",value:function(){var t,e=Po(this._elements);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.to.copy(n.from)}}catch(r){e.e(r)}finally{e.f()}return this}},{key:"set",value:function(t,e){this._elements.set(t,e)}},{key:"setSymbol",value:function(t,e){this._elements.get(t).asSymbol(e)}},{key:"setTag",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this._elements.get(t).asTag(e,n,r)}},{key:"concat",value:function(t){var e,n=Po(t._elements);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._elements.push(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._elements.deleteMany(t,e)}},{key:"pop",value:function(){this._elements.pop()}},{key:"keep",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._elements.size=t+e,this._elements.deleteMany(0,t)}},{key:"clone",value:function(){var e=new t(this.size);return e.copy(this),e}},{key:"copy",value:function(t){this._elements.size=0;var e,n=Po(t._elements);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._elements.push(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"clear",value:function(){this._elements.clear()}},{key:"toString",value:function(){var t,e="",n=Po(this.elements);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.length>0&&(e+=" > "),e+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return e}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e._elements.size!==this._elements.size)return!1;for(var n=0,r=e.size;n<r;++n)if(!this._elements.get(n).equals(e._elements.get(n)))return!1;return!0}return!1}},{key:Symbol.iterator,value:ye().mark((function t(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(this._elements,"t0",1);case 1:case"end":return t.stop()}}),t,this)}))},{key:"capacity",get:function(){return this._elements.capacity}},{key:"size",get:function(){return this._elements.size},set:function(t){this._elements.size=t}},{key:"last",get:function(){return this._elements.last}},{key:"first",get:function(){return this._elements.first}}])&&Wo(e.prototype,n),r&&Wo(e,r),t}();function Mo(t){return(Mo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Go(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bo(t,e){return(Bo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ho(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Vo(t);if(e){var i=Vo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return zo(this,n)}}function zo(t,e){return!e||"object"!==Mo(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vo(t){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.Element=Oo,t.EMPTY=new t(0),t.create=function(e){return new t(e)},t.memory=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;return t.create(1).pushMemory(e,n instanceof Ae?n:Ro(Ae,Co(n)),r instanceof Ae?r:Ro(Ae,Co(r)))},t.copy=function(t){return null==t?t:t.clone()}}(Fo||(Fo={})),function(t){function e(e){switch(e){case t.INSTANTIATED:return"INSTANTIATED";case t.RUNNING:return"RUNNING";case t.FINISHED:return"FINISHED";case t.FAILED:return"FAILED";default:return}}t.INSTANTIATED=0,t.RUNNING=1,t.FINISHED=2,t.FAILED=3,t.ALL=[t.INSTANTIATED,t.RUNNING,t.FINISHED,t.FAILED],t.toString=e,t.toDebugString=function(t){return"UnidocSourceState #"+t+" ("+(e(t)||"undefined")+")"}}(jo||(jo={}));var qo,Yo=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bo(t,e)}(o,t);var e,n,r,i=Ho(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this))._generator=t,e._state=jo.INSTANTIATED,e}return e=o,(n=[{key:"skip",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._generator.skip(t)}},{key:"_start",value:function(){this.output.start(),this._state=jo.RUNNING}},{key:"_next",value:function(){var t=this._generator,e=this.output;if(t.running)try{e.next(t.next())}catch(n){e.fail(n),this._state=jo.FAILED}else e.success(),this._state=jo.FINISHED}},{key:"read",value:function(){for(;this._state!==jo.FINISHED&&this._state!==jo.FAILED;)switch(this._state){case jo.INSTANTIATED:this._start();break;case jo.RUNNING:this._next();break;default:return}}},{key:"state",get:function(){return this._state}}])&&Go(e.prototype,n),r&&Go(e,r),o}(Ft);function Ko(t){return(Ko="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zo(t,e){return(Zo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Jo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ta(t);if(e){var i=ta(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Qo(this,n)}}function Qo(t,e){return!e||"object"!==Ko(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ta(t){return(ta=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(e){return new t(e)}}(Yo||(Yo={})),function(t){t.fromNothing=function(){return Yo.create(_r.fromNothing())},t.fromString=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ce.runtime();return Yo.create(_r.fromString(t,e))}}(qo||(qo={}));var ea,na=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zo(t,e)}(o,t);var e,n,r,i=Jo(o);function o(){return Xo(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"start",value:function(){this.output.start()}},{key:"next",value:function(t){this.output.next(t)}},{key:"success",value:function(){}},{key:"failure",value:function(t){this.output.fail(t)}}])&&$o(e.prototype,n),r&&$o(e,r),o}(Yt);function ra(t){var e=na.create();return e.subscribe(t),e}function ia(t){return(ia="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function aa(t,e){return(aa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sa(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ca(t);if(e){var i=ca(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ua(this,n)}}function ua(t,e){return!e||"object"!==ia(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ca(t){return(ca=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fa(t){switch(t){case fe.NEW_LINE:return 3;case fe.CARRIAGE_RETURN:return 2;case fe.SPACE:case fe.TABULATION:case fe.FORM_FEED:return 1;default:return 0}}!function(t){t.create=function(){return new t}}(na||(na={})),function(t){t.identity=function(t){return t}}(ea||(ea={}));var la=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&aa(t,e)}(o,t);var e,n,r,i=sa(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._token=new Xi,t._tracker=new $n,t}return e=o,(n=[{key:"produceIdentifier",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this._token;return n.from.clear(),n.to.clear(),n.from.text(this._tracker.location).runtime(),this._tracker.nextString(e),n.to.text(this._tracker.location).runtime(),n.asIdentifier(t),this.output.next(n.get()),n.incrementIndex(),this}},{key:"produceClass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this._token;return n.from.clear(),n.to.clear(),n.from.text(this._tracker.location).runtime(),this._tracker.nextString(e),n.to.text(this._tracker.location).runtime(),n.asClass(t),this.output.next(n.get()),n.incrementIndex(),this}},{key:"produceTag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this._token;return n.from.clear(),n.to.clear(),n.from.text(this._tracker.location).runtime(),this._tracker.nextString(e),n.to.text(this._tracker.location).runtime(),n.asTag(t),this.output.next(n.get()),n.incrementIndex(),this}},{key:"produceBlockStart",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"{",e=this._token;return e.from.clear(),e.to.clear(),e.from.text(this._tracker.location).runtime(),this._tracker.nextString(t),e.to.text(this._tracker.location).runtime(),e.asBlockStart(),this.output.next(e.get()),e.incrementIndex(),this}},{key:"produceBlockEnd",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"}",e=this._token;return e.from.clear(),e.to.clear(),e.from.text(this._tracker.location).runtime(),this._tracker.nextString(t),e.to.text(this._tracker.location).runtime(),e.asBlockEnd(),this.output.next(e.get()),e.incrementIndex(),this}},{key:"produceSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this._token;return n.from.clear(),n.to.clear(),n.from.text(this._tracker.location).runtime(),this._tracker.nextString(e),n.to.text(this._tracker.location).runtime(),n.asSpace(t),this.output.next(n.get()),n.incrementIndex(),this}},{key:"produceNewline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\r\n",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this._token;return n.from.clear(),n.to.clear(),n.from.text(this._tracker.location).runtime(),this._tracker.nextString(e),n.to.text(this._tracker.location).runtime(),n.asNewline(t),this.output.next(n.get()),n.incrementIndex(),this}},{key:"produceWord",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this._token;return n.from.clear(),n.to.clear(),n.from.text(this._tracker.location).runtime(),this._tracker.nextString(e),n.to.text(this._tracker.location).runtime(),n.asWord(t),this.output.next(n.get()),n.incrementIndex(),this}},{key:"produceString",value:function(t){if(t.length>0){for(var e=0,n=1,r=fa(t.codePointAt(0));n<t.length;){var i=fa(t.codePointAt(n));switch(r){case 0:i!==r&&(this.produceWord(t.substring(e,n)),e=n);break;case 1:i!==r&&(this.produceSpace(t.substring(e,n)),e=n);break;case 2:3!==i&&(this.produceNewline(t.substring(e,n)),e=n);break;case 3:this.produceNewline(t.substring(e,n)),e=n}n+=1,r=i}switch(r){case 0:this.produceWord(t.substring(e,n));break;case 1:this.produceSpace(t.substring(e,n));break;case 2:case 3:this.produceNewline(t.substring(e,n))}}return this}},{key:"success",value:function(){this.output.success()}}])&&oa(e.prototype,n),r&&oa(e,r),o}(Ft);function ha(t){return(ha="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pa(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return ya(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ya(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ya(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function va(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ba(t,e){return(ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ga(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ea(t);if(e){var i=Ea(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ma(this,n)}}function ma(t,e){return!e||"object"!==ha(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ea(t){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.create=function(){return new t},t.forBuffer=function(e){var n=new t;return n.on(pt.NEXT,e.push.bind(e)),n.on(pt.SUCCESS,e.fit.bind(e)),n},t.forParser=function(e){var n=new t;return n.on(pt.NEXT,e.next.bind(e)),n.on(pt.SUCCESS,e.success.bind(e)),n}}(la||(la={}));var _a=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ba(t,e)}(o,t);var e,n,r,i=ga(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;return va(this,o),(t=i.call(this))._tokens=U.Pack.instance(Vi.ALLOCATOR,e),t.tokens=t._tokens.view(),t}return e=o,(n=[{key:"start",value:function(){}},{key:"next",value:function(t){this.push(t)}},{key:"success",value:function(){}},{key:"failure",value:function(t){console.error(t)}},{key:"slice",value:function(t,e){for(var n=new o(e),r=Math.min(e,this.size-t),i=0;i<r;++i)n.push(this._tokens.get(i+t));return n}},{key:"reallocate",value:function(t){this._tokens.reallocate(t)}},{key:"fit",value:function(){this._tokens.fit()}},{key:"get",value:function(t){return this._tokens.get(t)}},{key:"push",value:function(t){this._tokens.push(t)}},{key:"delete",value:function(t){this._tokens.delete(t)}},{key:"deleteMany",value:function(t,e){this._tokens.deleteMany(t,e)}},{key:"concat",value:function(t){var e,n=pa(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._tokens.push(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"copy",value:function(t){this._tokens.clear();var e,n=pa(t.tokens);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._tokens.push(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"clear",value:function(){this._tokens.clear()}},{key:"toString",value:function(){for(var t="[",e=0;e<this._tokens.size;++e)e>0&&(t+=","),t+="\r\n"+this._tokens.get(e).toString();return this._tokens.size>0&&(t+="\r\n"),t+="]"}},{key:Symbol.iterator,value:ye().mark((function t(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(this._tokens,"t0",1);case 1:case"end":return t.stop()}}),t,this)}))},{key:"equals",value:function(t){if(null==t)return!1;if(t===this)return!0;if(t instanceof o){if(t.tokens.size!==this._tokens.size)return!1;for(var e=0,n=this._tokens.size;e<n;++e)if(!t.tokens.get(e).equals(this._tokens.get(e)))return!1;return!0}return!1}},{key:"capacity",get:function(){return this._tokens.capacity}},{key:"size",get:function(){return this._tokens.size},set:function(t){this._tokens.size=t}},{key:"last",get:function(){return this._tokens.last}},{key:"first",get:function(){return this._tokens.first}},{key:"from",get:function(){return 0===this._tokens.size?Ce.runtime():this._tokens.first.origin.from}},{key:"to",get:function(){return 0===this._tokens.size?Ce.runtime():this._tokens.last.origin.to}},{key:"text",get:function(){var t,e="",n=pa(this._tokens);try{for(n.s();!(t=n.n()).done;)e+=t.value.text}catch(r){n.e(r)}finally{n.f()}return e}}])&&da(e.prototype,n),r&&da(e,r),o}(dt);function Ta(t){return(Ta="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ka(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Sa(t,e){return(Sa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Aa(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ia(t);if(e){var i=Ia(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return wa(this,n)}}function wa(t,e){return!e||"object"!==Ta(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ia(t){return(Ia=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.assert=function(t,e){if(t.tokens.size!==e.tokens.size)throw new Error("Buffers "+e.toString()+" and "+t.toString()+" are not equals because thay contains a different amount of tokens "+e.tokens.size+" !== "+t.tokens.size+".");for(var n=0,r=e.tokens.size;n<r;++n)if(!t.tokens.get(n).equals(e.tokens.get(n)))throw new Error("Buffers "+e.toString()+" and "+t.toString()+" are not equals because their #"+n+" token are not equal "+e.tokens.get(n).toString()+" !== "+t.tokens.get(n).toString()+".")}}(_a||(_a={}));var Oa,Ra=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sa(t,e)}(o,t);var e,n,r,i=Aa(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._token=new Vi,t._token.origin.from.runtime(),t._token.origin.to.runtime(),t._index=0,t}return e=o,(n=[{key:"start",value:function(){this.output.start()}},{key:"at",value:function(t){return this._token.origin.from.copy(t),this._token.origin.to.copy(t),this}},{key:"from",value:function(t){return t?(this._token.origin.from.copy(t),this):(this._token.origin.from.clear(),this._token.origin.from)}},{key:"to",value:function(t){return t?(this._token.origin.to.copy(t),this):(this._token.origin.to.clear(),this._token.origin.to)}},{key:"withSymbols",value:function(t){return this._token.symbols.copy(t),this}},{key:"withType",value:function(t){return this._token.type=t,this}},{key:"produceIdentifier",value:function(t){return this._token.asIdentifier(t),this.produce(this._token),this}},{key:"produceClass",value:function(t){return this._token.asClass(t),this.produce(this._token),this}},{key:"produceTag",value:function(t){return this._token.asTag(t),this.produce(this._token),this}},{key:"produceBlockStart",value:function(){return this._token.asBlockStart(),this.produce(this._token),this}},{key:"produceBlockEnd",value:function(){return this._token.asBlockEnd(),this.produce(this._token),this}},{key:"produceSpace",value:function(t){return this._token.asSpace(t),this.produce(this._token),this}},{key:"produceNewline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\r\n";return this._token.asNewline(t),this.produce(this._token),this}},{key:"produceWord",value:function(t){return this._token.asWord(t),this.produce(this._token),this}},{key:"produce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._token;t.index=this._index,this._index+=1,this.output.next(t)}},{key:"success",value:function(){this.output.success()}},{key:"fail",value:function(t){this.output.fail(t)}},{key:"clear",value:function(){this._index=0,this._token.clear(),this.off()}}])&&ka(e.prototype,n),r&&ka(e,r),o}(Ft);function Na(t){return function(t){if(Array.isArray(t))return La(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Pa(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xa(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(t,e)||Pa(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ca(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Pa(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Pa(t,e){if(t){if("string"===typeof t)return La(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?La(t,e):void 0}}function La(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(Ra||(Ra={})),function(t){function e(e){switch(e){case t.VERBOSE:return"VERBOSE";case t.INFORMATION:return"INFORMATION";case t.WARNING:return"WARNING";case t.ERROR:return"ERROR";case t.FAILURE:return"FAILURE";default:return}}t.VERBOSE=0,t.INFORMATION=1,t.WARNING=2,t.ERROR=3,t.FAILURE=4,t.ALL=[t.VERBOSE,t.INFORMATION,t.WARNING,t.ERROR,t.FAILURE],t.DEFAULT=0,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(Oa||(Oa={}));var Ua=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=Oa.DEFAULT,this.code="",this.data=new Map}var e,n,r;return e=t,(n=[{key:"setData",value:function(t,e){return this.data.set(t,e),this}},{key:"setCode",value:function(t){return this.code=t,this}},{key:"setType",value:function(t){return this.type=t,this}},{key:"asVerbose",value:function(){return this.type=Oa.VERBOSE,this}},{key:"asInformation",value:function(){return this.type=Oa.INFORMATION,this}},{key:"asWarning",value:function(){return this.type=Oa.WARNING,this}},{key:"asError",value:function(){return this.type=Oa.ERROR,this}},{key:"asFailure",value:function(){return this.type=Oa.FAILURE,this}},{key:"isVerbose",value:function(){return this.type===Oa.VERBOSE}},{key:"isInformation",value:function(){return this.type===Oa.INFORMATION}},{key:"isWarning",value:function(){return this.type===Oa.WARNING}},{key:"isError",value:function(){return this.type===Oa.ERROR}},{key:"isFailure",value:function(){return this.type===Oa.FAILURE}},{key:"clear",value:function(){this.type=Oa.DEFAULT,this.code="",this.data.clear()}},{key:"copy",value:function(t){this.type=t.type,this.code=t.code,this.data.clear();var e,n=Ca(t.data);try{for(n.s();!(e=n.n()).done;){var r=xa(e.value,2),i=r[0],o=r[1];this.data.set(i,o)}}catch(a){n.e(a)}finally{n.f()}}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"toString",value:function(){return"".concat(Oa.toDebugString(this.type)," ").concat(this.code," : {").concat(Na(this.data.entries()).map((function(t){return t[0]+": "+t[1]})).join(", "),"}")}},{key:"equals",value:function(e){if(null==e)return!1;if(e===this)return!0;if(e instanceof t){if(e.type!==this.type||e.code!==this.code||e.data.size!==this.data.size)return!1;var n,r=Ca(this.data);try{for(r.s();!(n=r.n()).done;){var i=xa(n.value,2),o=i[0],a=i[1],s=e.data.get(o);if(s.equals){if(!s.equals(a))return!1}else if(s!==a)return!1}}catch(u){r.e(u)}finally{r.f()}return!0}return!1}}])&&Da(e.prototype,n),r&&Da(e,r),t}();function Wa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.copy=function(t){return null==t?t:t.clone()},t.create=e,t.ALLOCATOR=U.Duplicator.fromFactory(e)}(Ua||(Ua={}));var ja=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=0,this.batch=0,this.type=an.DEFAULT,this.event=new Ye,this.message=new Ua,this.group=void 0}var e,n,r;return e=t,(n=[{key:"setIndex",value:function(t){return this.index=t,this}},{key:"setBatch",value:function(t){return this.batch=t,this}},{key:"isMessage",value:function(){return this.type===an.MESSAGE}},{key:"isValidation",value:function(){return this.type===an.VALIDATION}},{key:"isBeginGroup",value:function(){return this.type===an.BEGIN_GROUP}},{key:"isEndGroup",value:function(){return this.type===an.END_GROUP}},{key:"isDocumentCompletion",value:function(){return this.type===an.DOCUMENT_COMPLETION}},{key:"asValidation",value:function(t){return this.message.clear(),this.event.copy(t),this.type=an.VALIDATION,this.group=void 0,this}},{key:"asDocumentCompletion",value:function(){return this.message.clear(),this.event.clear(),this.type=an.DOCUMENT_COMPLETION,this.group=void 0,this}},{key:"asBeginGroup",value:function(t){return this.message.clear(),this.event.clear(),this.type=an.BEGIN_GROUP,this.group=t,this}},{key:"asEndGroup",value:function(t){return this.message.clear(),this.event.clear(),this.type=an.END_GROUP,this.group=t,this}},{key:"asMessage",value:function(t){return this.event.clear(),t?this.message.copy(t):this.message.clear(),this.type=an.MESSAGE,this.group=void 0,this}},{key:"clear",value:function(){this.index=0,this.batch=0,this.type=an.DEFAULT,this.message.clear(),this.event.clear(),this.group=void 0}},{key:"copy",value:function(t){this.index=t.index,this.batch=t.batch,this.type=t.type,this.message.copy(t.message),this.event.copy(t.event),this.group=t.group}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"toString",value:function(){var t=this.index.toString().padEnd(5);switch(t+=" batch #",t+=this.batch.toString().padEnd(5),t+=" of type ",t+=an.toDebugString(this.type),this.type){case an.MESSAGE:t+=" ",t+=this.message.toString();break;case an.VALIDATION:t+=" validating ",t+=this.event;break;case an.DOCUMENT_COMPLETION:t+=" document completion";break;case an.BEGIN_GROUP:t+=" start of group ",t+=this.group?this.group.toString():"null";break;case an.END_GROUP:t+=" end of group ",t+=this.group?this.group.toString():"null";break;default:throw new Error("Unable to stringify validation event of type "+an.toDebugString(this.type)+" because no procedure was defined to stringify this type of event.")}return t}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.index===e.index&&this.batch===e.batch&&this.type===e.type&&this.message.equals(e.message)&&this.event.equals(e.event)&&this.group===e.group)}}])&&Wa(e.prototype,n),r&&Wa(e,r),t}();function Fa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.copy=function(t){return null==t?t:t.clone()},t.create=e,t.ALLOCATOR=U.Duplicator.fromFactory(e)}(ja||(ja={}));var Ma=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.event=new ja}var e,n,r;return e=t,(n=[{key:"setIndex",value:function(t){return this.event.setIndex(t),this}},{key:"setBatch",value:function(t){return this.event.setBatch(t),this}},{key:"asValidation",value:function(t){return this.event.asValidation(t),this}},{key:"asDocumentCompletion",value:function(){return this.event.asDocumentCompletion(),this}},{key:"asBeginGroup",value:function(t){return this.event.asBeginGroup(t),this}},{key:"asEndGroup",value:function(t){return this.event.asEndGroup(t),this}},{key:"asMessage",value:function(t){return this.event.asMessage(t),this}},{key:"build",value:function(){return this.event.clone()}},{key:"get",value:function(){return this.event}},{key:"configure",value:function(t){t.copy(this.event)}},{key:"clear",value:function(){this.event.clear()}},{key:"copy",value:function(e){return e instanceof t?this.event.copy(e.event):this.event.copy(e),this}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.event.equals(this.event))}}])&&Fa(e.prototype,n),r&&Fa(e,r),t}();function Ga(t){return(Ga="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ba(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ha(t,e){return(Ha=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function za(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=qa(t);if(e){var i=qa(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Va(this,n)}}function Va(t,e){return!e||"object"!==Ga(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qa(t){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.INSTANCE=new t,t.create=function(){return new t},t.get=function(){return t.INSTANCE}}(Ma||(Ma={}));var Ya=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ha(t,e)}(o,t);var e,n,r,i=za(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._event=new ja,t._index=0,t._batch=0,t}return e=o,(n=[{key:"fail",value:function(t){this.output.fail(t)}},{key:"start",value:function(){this.output.start()}},{key:"produceValidation",value:function(t){return this._event.asValidation(t),this.produce(this._event),this}},{key:"produceDocumentCompletion",value:function(){return this._event.asDocumentCompletion(),this.produce(this._event),this}},{key:"produceBeginGroup",value:function(t){return this._event.asBeginGroup(t),this.produce(this._event),this}},{key:"produceEndGroup",value:function(t){return this._event.asEndGroup(t),this.produce(this._event),this}},{key:"produceMessage",value:function(t){return this._event.asMessage(t),this.produce(this._event),this}},{key:"produce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._event;t.type!==an.VALIDATION&&t.type!==an.DOCUMENT_COMPLETION||(this._batch+=1),t.index=this._index,t.batch=this._batch,this._index+=1,this.output.next(t)}},{key:"success",value:function(){this.output.success()}},{key:"clear",value:function(){this._event.clear(),this._index=0,this._batch=0,this.off()}}])&&Ba(e.prototype,n),r&&Ba(e,r),o}(Ft);function Ka(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(){return new t}}(Ya||(Ya={}));var Xa,$a,Za,Ja=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.message=new Ua}var e,n,r;return e=t,(n=[{key:"setData",value:function(t,e){return this.message.setData(t,e),this}},{key:"setCode",value:function(t){return this.message.setCode(t),this}},{key:"setType",value:function(t){return this.message.setType(t),this}},{key:"asVerbose",value:function(){return this.message.asVerbose(),this}},{key:"asInformation",value:function(){return this.message.asInformation(),this}},{key:"asWarning",value:function(){return this.message.asWarning(),this}},{key:"asError",value:function(){return this.message.asError(),this}},{key:"asFailure",value:function(){return this.message.asFailure(),this}},{key:"build",value:function(){return this.message.clone()}},{key:"get",value:function(){return this.message}},{key:"configure",value:function(t){t.copy(this.message)}},{key:"clear",value:function(){this.message.clear()}},{key:"copy",value:function(e){return e instanceof t?this.message.copy(e.message):this.message.copy(e),this}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&e.message.equals(this.message))}}])&&Ka(e.prototype,n),r&&Ka(e,r),t}();!function(t){t.INSTANCE=new t,t.create=function(){return new t},t.get=function(){return t.INSTANCE}}(Ja||(Ja={})),function(t){t.TYPE=Oa.FAILURE,t.CODE="standard:blueprint:failure:expected-content",function(t){t.BLUEPRINT="blueprint"}(t.Data||(t.Data={}))}(Xa||(Xa={})),function(t){t.TYPE=Oa.WARNING,t.CODE="standard:blueprint:warning:preffered-content",function(t){t.BLUEPRINT="blueprint"}(t.Data||(t.Data={}))}($a||($a={})),function(t){t.TYPE=Oa.ERROR,t.CODE="standard:blueprint:error:too-many-content",function(t){t.BLUEPRINT="blueprint"}(t.Data||(t.Data={})),function(t){t.TYPE=Oa.FAILURE,t.CODE="standard:blueprint:failure:too-many-content",function(t){t.BLUEPRINT="blueprint"}(t.Data||(t.Data={}))}(t.Strict||(t.Strict={}))}(Za||(Za={}));var Qa=ye().mark(ns);function ts(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return es(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?es(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function es(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ns(t){var e,n,r,i,o;return ye().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e="",n=!1,r=ts(Fs.match(t)),a.prev=3,r.s();case 5:if((i=r.n()).done){a.next=25;break}if(!(o=i.value).isEmit()||!o.event.isValidation()){a.next=13;break}return o.event.event.isWord()?(n&&e.length>0&&(e+=" ",n=!1),e+=o.event.event.text):o.event.event.isWhitespace()&&(n=!0),a.next=11,o;case 11:a.next=23;break;case 13:if(!o.isEnd()){a.next=17;break}return a.abrupt("return",void 0);case 17:if(!o.isMatch()){a.next=21;break}return a.abrupt("return",e);case 21:return a.next=23,o;case 23:a.next=5;break;case 25:a.next=30;break;case 27:a.prev=27,a.t0=a.catch(3),r.e(a.t0);case 30:return a.prev=30,r.f(),a.finish(30);case 33:return a.abrupt("return",e);case 34:case"end":return a.stop()}}),Qa,null,[[3,27,30,33]])}var rs=ye().mark(is);function is(t,e){var n;return ye().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(ns(t),"t0",1);case 1:if(void 0!==(n=r.t0)){r.next=6;break}return r.abrupt("return",Fs.output.end());case 6:if(!e.test(n)){r.next=10;break}return r.abrupt("return",Fs.output.match());case 10:return r.next=12,Fs.output.message.expectedContent(st.regexp(e));case 12:return r.abrupt("return",Fs.output.end());case 13:case"end":return r.stop()}}),rs)}var os=ye().mark(as);function as(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fs.output.current();case 2:t=e.sent;case 3:if(!t||!t.isWhitespace()){e.next=11;break}return e.next=6,Fs.output.validation(t);case 6:return e.next=8,Fs.output.next();case 8:t=e.sent,e.next=3;break;case 11:if(null!=t&&t.isWord()){e.next=17;break}return e.next=14,Fs.output.validation(t);case 14:return e.next=16,Fs.output.message.expectedContent(st.word());case 16:return e.abrupt("return",Fs.output.end());case 17:if(!t||!t.isWhitespace()&&!t.isWord()){e.next=25;break}return e.next=20,Fs.output.validation(t);case 20:return e.next=22,Fs.output.next();case 22:t=e.sent,e.next=17;break;case 25:return e.abrupt("return",Fs.output.match());case 26:case"end":return e.stop()}}),os)}!function(t){t.thatMatch=function(e){return is(t(),e)}}(as||(as={}));var ss=ye().mark(us);function us(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fs.output.current();case 2:t=e.sent;case 3:if(!t||!t.isWhitespace()){e.next=11;break}return e.next=6,Fs.output.validation(t);case 6:return e.next=8,Fs.output.next();case 8:t=e.sent,e.next=3;break;case 11:if(null!=t&&t.isWord()){e.next=17;break}return e.next=14,Fs.output.validation(t);case 14:return e.next=16,Fs.output.message.expectedContent(st.word());case 16:return e.abrupt("return",Fs.output.end());case 17:if(!t||!t.isWord()){e.next=25;break}return e.next=20,Fs.output.validation(t);case 20:return e.next=22,Fs.output.next();case 22:t=e.sent,e.next=17;break;case 25:if(!t||!t.isWhitespace()){e.next=33;break}return e.next=28,Fs.output.validation(t);case 28:return e.next=30,Fs.output.next();case 30:t=e.sent,e.next=25;break;case 33:return e.abrupt("return",Fs.output.match());case 34:case"end":return e.stop()}}),ss)}!function(t){t.thatMatch=function(e){return is(t(),e)}}(us||(us={}));var cs,fs=ye().mark(ls);function ls(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fs.output.current();case 2:return t=e.sent,e.next=5,Fs.output.validation(t);case 5:if(!t){e.next=11;break}return e.next=8,Fs.output.message.expectedContent(st.end());case 8:return e.abrupt("return",Fs.output.end());case 11:return e.abrupt("return",Fs.output.match());case 12:case"end":return e.stop()}}),fs)}function hs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(e){switch(e){case t.CURRENT:return"CURRENT";case t.NEXT:return"NEXT";case t.EMIT:return"EMIT";case t.END:return"END";default:return}}t.CURRENT=0,t.NEXT=1,t.EMIT=2,t.END=3,t.MATCH=4,t.ALL=[t.CURRENT,t.NEXT,t.EMIT,t.END,t.MATCH],t.DEFAULT=t.CURRENT,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(cs||(cs={}));var ps=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=cs.DEFAULT,this.event=new ja}var e,n,r;return e=t,(n=[{key:"isCurrent",value:function(){return this.type===cs.CURRENT}},{key:"isNext",value:function(){return this.type===cs.NEXT}},{key:"isEmit",value:function(){return this.type===cs.EMIT}},{key:"isEnd",value:function(){return this.type===cs.END}},{key:"isMatch",value:function(){return this.type===cs.MATCH}},{key:"asCurrent",value:function(){return this.type=cs.CURRENT,this.event.clear(),this}},{key:"asNext",value:function(){return this.type=cs.NEXT,this.event.clear(),this}},{key:"asMatch",value:function(){return this.type=cs.MATCH,this.event.clear(),this}},{key:"asEmit",value:function(t){return this.type=cs.EMIT,this.event.copy(t),this}},{key:"asEnd",value:function(){return this.type=cs.END,this.event.clear(),this}},{key:"clear",value:function(){this.type=cs.DEFAULT,this.event.clear()}},{key:"copy",value:function(t){this.type=t.type,this.event.copy(t.event)}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"toString",value:function(){var t=cs.toDebugString(this.type);switch(this.type){case cs.CURRENT:t+=" get current event";break;case cs.NEXT:t+=" get next event";break;case cs.EMIT:t+=" emit ",t+=this.event.toString();break;case cs.END:t+=" end";break;case cs.MATCH:t+=" match";break;default:throw new Error("Unable to stringify validator output of type "+cs.toDebugString(this.type)+" because no procedure was defined to stringify this type of event.")}return t}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this.type===e.type&&this.event.equals(e.event))}}])&&hs(e.prototype,n),r&&hs(e,r),t}();!function(t){function e(){return new t}t.CURRENT=e().asCurrent(),t.NEXT=e().asNext(),t.END=e().asEnd(),t.MATCH=e().asMatch(),t.copy=function(t){return null==t?t:t.clone()},t.create=e,t.ALLOCATOR=U.Allocator.fromFactory(e)}(ps||(ps={}));var ys=ye().mark(vs);function vs(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ps.CURRENT;case 2:return t=e.sent,e.next=5,Fs.output.validation(t);case 5:if(!t||!t.isEndOfAnyTag()){e.next=11;break}return e.next=8,Fs.output.next();case 8:return e.abrupt("return",Fs.output.match());case 11:return e.next=13,Fs.output.message.expectedContent(st.event(P.isTagEnd()));case 13:return e.abrupt("return",Fs.output.end());case 14:case"end":return e.stop()}}),ys)}var ds=ye().mark(bs);function bs(t){var e;return ye().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Fs.output.current();case 2:return e=n.sent,n.next=5,Fs.output.validation(e);case 5:if(!e||!e.isEndOfTag(t)){n.next=11;break}return n.next=8,Fs.output.next();case 8:return n.abrupt("return",Fs.output.match());case 11:return n.next=13,Fs.output.message.expectedContent(st.tagStart(t));case 13:return n.abrupt("return",Fs.output.end());case 14:case"end":return n.stop()}}),ds)}!function(t){t.factory=function(e){return t.bind(void 0,e)}}(bs||(bs={}));var gs=ye().mark(ms);function ms(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Fs.output.match());case 1:case"end":return t.stop()}}),gs)}var Es=ye().mark(_s);function _s(){var t,e,n,r,i=arguments;return ye().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:0,e=i.length>1&&void 0!==i[1]?i[1]:Number.POSITIVE_INFINITY,o.next=4,Fs.output.current();case 4:n=o.sent,r=0;case 6:if(!n||!n.isWhitespace()){o.next=19;break}if(!(r<e)){o.next=16;break}return o.next=10,Fs.output.validation(n);case 10:return r+=1,o.next=13,Fs.output.next();case 13:n=o.sent,o.next=17;break;case 16:return o.abrupt("return",Fs.output.match());case 17:o.next=6;break;case 19:if(!(r<t)){o.next=25;break}return o.next=22,Fs.output.message.expectedContent(st.many(st.whitespace()).atLeast(t-r));case 22:return o.abrupt("return",Fs.output.end());case 25:return o.abrupt("return",Fs.output.match());case 26:case"end":return o.stop()}}),Es)}var Ts=ye().mark(ks);function ks(){var t,e,n,r,i=arguments;return ye().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:0,e=i.length>1&&void 0!==i[1]?i[1]:Number.POSITIVE_INFINITY,o.next=4,Fs.output.current();case 4:n=o.sent,r=0;case 6:if(!n||!n.isWord()){o.next=19;break}if(!(r<e)){o.next=16;break}return o.next=10,Fs.output.validation(n);case 10:return r+=1,o.next=13,Fs.output.next();case 13:n=o.sent,o.next=17;break;case 16:return o.abrupt("return",Fs.output.match());case 17:o.next=6;break;case 19:if(!(r<t)){o.next=25;break}return o.next=22,Fs.output.message.expectedContent(st.many(st.word()).atLeast(t-r));case 22:return o.abrupt("return",Fs.output.end());case 25:return o.abrupt("return",Fs.output.match());case 26:case"end":return o.stop()}}),Ts)}var Ss=ye().mark(As);function As(){var t,e,n,r=arguments;return ye().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=0,e=r.length;case 1:if(!(t<e)){i.next=17;break}return i.delegateYield(t<0||r.length<=t?void 0:r[t],"t0",3);case 3:if(null!=(n=i.t0)){i.next=8;break}throw new Error("Illegal behavior, a KISS validator returned nothing at the end of it's execution.");case 8:if(!n.isEnd()){i.next=12;break}return i.abrupt("return",n);case 12:if(n.isMatch()){i.next=14;break}throw new Error("Illegal behavior, a KISS validator returned a result that was neither end nor match at the end of it's execution.");case 14:++t,i.next=1;break;case 17:return i.abrupt("return",Fs.output.match());case 18:case"end":return i.stop()}}),Ss)}var ws=ye().mark(Is);function Is(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fs.output.current();case 2:return t=e.sent,e.next=5,Fs.output.validation(t);case 5:if(!t||!t.isStartOfAnyTag()){e.next=11;break}return e.next=8,Fs.output.next();case 8:return e.abrupt("return",Fs.output.match());case 11:return e.next=13,Fs.output.message.expectedContent(st.event(P.isTagStart()));case 13:return e.abrupt("return",Fs.output.end());case 14:case"end":return e.stop()}}),ws)}var Os=ye().mark(Rs);function Rs(t){var e;return ye().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Fs.output.current();case 2:return e=n.sent,n.next=5,Fs.output.validation(e);case 5:if(!e||!e.isStartOfTag(t)){n.next=11;break}return n.next=8,Fs.output.next();case 8:return n.abrupt("return",Fs.output.match());case 11:return n.next=13,Fs.output.message.expectedContent(st.tagStart(t));case 13:return n.abrupt("return",Fs.output.end());case 14:case"end":return n.stop()}}),Os)}!function(t){t.factory=function(e){return t.bind(void 0,e)}}(Rs||(Rs={}));var Ns=ye().mark(xs);function xs(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fs.output.current();case 2:t=e.sent;case 3:if(!t||!t.isWhitespace()){e.next=11;break}return e.next=6,Fs.output.validation(t);case 6:return e.next=8,Fs.output.next();case 8:t=e.sent,e.next=3;break;case 11:if(!t||!t.isWhitespace()&&!t.isWord()){e.next=19;break}return e.next=14,Fs.output.validation(t);case 14:return e.next=16,Fs.output.next();case 16:t=e.sent,e.next=11;break;case 19:return e.abrupt("return",Fs.output.match());case 20:case"end":return e.stop()}}),Ns)}!function(t){t.thatMatch=function(e){return is(t(),e)}}(xs||(xs={}));var Cs=ye().mark(Ps);function Ps(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fs.output.current();case 2:t=e.sent;case 3:if(!t||!t.isWhitespace()){e.next=11;break}return e.next=6,Fs.output.validation(t);case 6:return e.next=8,Fs.output.next();case 8:t=e.sent,e.next=3;break;case 11:if(!t||!t.isWord()){e.next=19;break}return e.next=14,Fs.output.validation(t);case 14:return e.next=16,Fs.output.next();case 16:t=e.sent,e.next=11;break;case 19:if(!t||!t.isWhitespace()){e.next=27;break}return e.next=22,Fs.output.validation(t);case 22:return e.next=24,Fs.output.next();case 24:t=e.sent,e.next=19;break;case 27:return e.abrupt("return",Fs.output.match());case 28:case"end":return e.stop()}}),Cs)}!function(t){t.thatMatch=function(e){return is(t(),e)}}(Ps||(Ps={}));var Ls=ye().mark(Ds);function Ds(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fs.output.current();case 2:return t=e.sent,e.next=5,Fs.output.validation(t);case 5:if(!t||!t.isWhitespace()){e.next=11;break}return e.next=8,Fs.output.next();case 8:return e.abrupt("return",Fs.output.match());case 11:return e.next=13,Fs.output.message.expectedContent(st.whitespace());case 13:return e.abrupt("return",Fs.output.end());case 14:case"end":return e.stop()}}),Ls)}var Us=ye().mark(Ws);function Ws(){var t;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fs.output.current();case 2:return t=e.sent,e.next=5,Fs.output.validation(t);case 5:if(!t||!t.isWord()){e.next=11;break}return e.next=8,Fs.output.next();case 8:return e.abrupt("return",Fs.output.match());case 11:return e.next=13,Fs.output.message.expectedContent(st.word());case 13:return e.abrupt("return",Fs.output.end());case 14:case"end":return e.stop()}}),Us)}function js(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fs,Ms=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._output=new ps}var e,n,r;return e=t,(n=[{key:"asCurrent",value:function(){return this._output.asCurrent(),this}},{key:"asNext",value:function(){return this._output.asNext(),this}},{key:"asEmit",value:function(t){return this._output.asEmit(t),this}},{key:"asEnd",value:function(){return this._output.asEnd(),this}},{key:"build",value:function(){return this._output.clone()}},{key:"get",value:function(){return this._output}},{key:"configure",value:function(t){t.copy(this._output)}},{key:"clear",value:function(){this._output.clear()}},{key:"copy",value:function(e){return e instanceof t?this._output.copy(e._output):this._output.copy(e),this}},{key:"clone",value:function(){var e=new t;return e.copy(this),e}},{key:"equals",value:function(e){return null!=e&&(e===this||e instanceof t&&this._output.equals(e._output))}}])&&js(e.prototype,n),r&&js(e,r),t}();function Gs(t){return(Gs="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hs(t,e){return(Hs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zs(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=qs(t);if(e){var i=qs(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Vs(this,n)}}function Vs(t,e){return!e||"object"!==Gs(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qs(t){return(qs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){t.INSTANCE=new t,t.create=function(){return new t},t.get=function(){return t.INSTANCE}}(Ms||(Ms={})),function(t){var e=ye().mark(r),n=ye().mark(i);function r(t){var n;return ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t,"t0",1);case 1:if(null!=(n=e.t0)){e.next=6;break}throw new Error("Illegal behavior, a KISS validator returned nothing at the end of it's execution.");case 6:if(!n.isEnd()){e.next=10;break}return e.abrupt("return",!1);case 10:if(!n.isMatch()){e.next=14;break}return e.abrupt("return",!0);case 14:throw new Error("Illegal behavior, a KISS validator returned a result that was neither end nor match at the end of it's execution.");case 15:case"end":return e.stop()}}),e)}function i(t,e){var r;return ye().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=t.next(e);case 1:if(r.done||!r.value.isCurrent()&&!r.value.isEmit()){n.next=7;break}return n.next=4,r.value;case 4:r=t.next(e),n.next=1;break;case 7:return n.abrupt("return",r.value);case 8:case"end":return n.stop()}}),n)}!function(t){function e(t){return Ms.get().asEmit(Ma.get().asMessage(t).get()).get()}t.current=function(){return ps.CURRENT},t.next=function(){return ps.NEXT},t.end=function(){return ps.END},t.match=function(){return ps.MATCH},t.emit=function(t){return Ms.get().asEmit(t).get()},t.validation=function(t){return t?Ms.get().asEmit(Ma.get().asValidation(t).get()).get():Ms.get().asEmit(Ma.get().asDocumentCompletion().get()).get()},t.message=e,t.builder=function(){return Ms.get()},function(t){function e(){return Ja.get()}function n(n){return t(e().setType(Za.TYPE).setCode(Za.CODE).setData(Za.Data.BLUEPRINT,n).get())}t.builder=e,t.expectedContent=function(n){return t(e().setType(Xa.TYPE).setCode(Xa.CODE).setData(Xa.Data.BLUEPRINT,n).get())},t.preferredContent=function(n){return t(e().setType($a.TYPE).setCode($a.CODE).setData($a.Data.BLUEPRINT,n).get())},t.tooManyContent=n,function(n){n.strict=function(n){return t(e().setType(Za.Strict.TYPE).setCode(Za.Strict.CODE).setData(Za.Strict.Data.BLUEPRINT,n).get())}}(n=t.tooManyContent||(t.tooManyContent={}))}(e=t.message||(t.message={}))}(t.output||(t.output={})),t.match=r,t.captureValidatedText=ns,t.requireText=as,t.requireToken=us,t.validateContentThatMatch=is,t.validateEnd=ls,t.validateEndOfAnyTag=vs,t.validateEndOfTag=bs,t.validateEpsilon=ms,t.validateManyWhitespace=_s,t.validateManyWord=ks,t.validateSequence=As,t.validateStartOfAnyTag=Is,t.validateStartOfTag=Rs,t.validateText=as,t.validateToken=us,t.validateWhitespace=Ds,t.validateWord=Ws,t.feed=i}(Fs||(Fs={}));var Ys=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hs(t,e)}(o,t);var e,n,r,i=zs(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this))._validator=null,e._factory=t,e._index=0,e._batch=0,e}return e=o,(n=[{key:"start",value:function(){var t=this._factory();this.output.start(),this._validator=t;for(var e=t.next();!e.done;)switch(e.value.type){case cs.CURRENT:case cs.NEXT:return;case cs.EMIT:e.value.event.message.isFailure()?(this.emit(e.value.event),e=t.return(Fs.output.end())):(this.emit(e.value.event),e=t.next());break;case cs.END:case cs.MATCH:return void(this._validator=null);default:throw new Error("Unable to handle kiss validator output of type "+cs.toDebugString(e.value.type)+" because no procedure was defined for that.")}}},{key:"next",value:function(t){var e=this._validator;if(this.output,e)for(var n=e.next(t);!n.done;)switch(n.value.type){case cs.CURRENT:n=e.next(t);break;case cs.NEXT:return;case cs.EMIT:n.value.event.message.isFailure()?(this.emit(n.value.event),n=e.return(Fs.output.end())):(this.emit(n.value.event),n=e.next());break;case cs.END:case cs.MATCH:return void(this._validator=null);default:throw new Error("Unable to handle kiss validator output of type "+cs.toDebugString(n.value.type)+" because no procedure was defined for that.")}}},{key:"success",value:function(){var t=this._validator,e=this.output;if(t)for(var n=t.next(void 0);!n.done;)switch(n.value.type){case cs.CURRENT:case cs.NEXT:n=t.next(void 0);break;case cs.EMIT:n.value.event.message.isFailure()?(this.emit(n.value.event),n=t.return(Fs.output.end())):(this.emit(n.value.event),n=t.next());break;case cs.END:case cs.MATCH:return void(this._validator=null);default:throw new Error("Unable to handle kiss validator output of type "+cs.toDebugString(n.value.type)+" because no procedure was defined for that.")}e.success()}},{key:"emit",value:function(t){(t.isValidation()||t.isDocumentCompletion())&&(this._batch+=1),t.setIndex(this._index),t.setBatch(this._batch),this.output.next(t),this._index+=1}},{key:"failure",value:function(t){this.output.fail(t)}}])&&Bs(e.prototype,n),r&&Bs(e,r),o}(Yt);function Ks(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Xs=function(){function t(e,n,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e.graph!==n.graph)throw new Error("Unable to instantiate a relationship between the given states because they both belongs to two different graphs.");this.from=e,this.to=n,this.validator=r,this.identifier=this.from.graph.addRelationship(this),this.from.addOutputRelationship(this)}var e,n,r;return e=t,(n=[{key:"toString",value:function(){var t=this.constructor.name;return t+=" #",t+=this.identifier,t+=" from state #",t+=this.from.identifier,t+=" to state #",t+=this.to.identifier}}])&&Ks(e.prototype,n),r&&Ks(e,r),t}();function $s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Zs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.graph=e,this._outputs=U.PackSet.any(4),this.outputs=this._outputs.view(),this.identifier=e.addState(this)}var e,n,r;return e=t,(n=[{key:"isMatch",value:function(){return void 0!==this._match}},{key:"addOutputRelationship",value:function(t){if(t.from!==this)throw new Error("Unable to add the given relationship as an outgoing relationship of this state as the given relationship originate from a different state. #addOutputRelationship is a method that must be called at theright time, please do not use it if you do not know exactly what you are doing.");this._outputs.add(t)}},{key:"output",value:function(t,e){new Xs(this,t,e)}},{key:"input",value:function(t,e){new Xs(t,this,e)}},{key:"epsilon",value:function(t){new Xs(this,t,Fs.validateEpsilon)}},{key:"toString",value:function(){var t=this.constructor.name;t+=" #",t+=this.identifier,null!=this._match&&(t+=" (MATCH:"+this._match+")"),t+=" with outgoing relationships (",t+=this._outputs.size,t+=") into [";for(var e=0;e<this._outputs.size;++e)e>0&&(t+=", "),t+=this._outputs.get(e).to.identifier;return t+="]"}},{key:"match",set:function(t){this._match!==t&&(this._match=t,void 0===this._match?this.graph.deleteMatch(this):this.graph.addMatch(this,t))},get:function(){return this._match}}])&&$s(e.prototype,n),r&&$s(e,r),t}();function Js(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Qs(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qs(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Qs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var nu=function(){function t(e){tu(this,t),this.graph=e;for(var n=new Set,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(var a=0,s=i;a<s.length;a++){var u=s[a];if(u instanceof Zs)n.add(u);else{var c,f=Js(u);try{for(f.s();!(c=f.n()).done;){var l=c.value;n.add(l)}}catch(h){f.e(h)}finally{f.f()}}}0===n.size&&n.add(e.start),this._origin=n,this._input=void 0}var e,n,r;return e=t,(n=[{key:"origin",value:ye().mark((function t(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._origin.values());case 1:case"end":return t.stop()}}),t,this)}))},{key:"input",value:function(){if(this._origin.size>1){if(this._input)return this._input;var t,e=this.graph.state(),n=Js(this._origin);try{for(n.s();!(t=n.n()).done;)t.value.epsilon(e)}catch(r){n.e(r)}finally{n.f()}return this._input=e,e}return this._origin.values().next().value}},{key:"then",value:function(e){var n=this.graph.state();return this.input().output(n,e),new t(this.graph,n)}},{key:"match",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.graph.state();e.match=t;var n,r=Js(this._origin);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.epsilon(e)}}catch(o){r.e(o)}finally{r.f()}return this.graph}},{key:"many",value:function(e){var n=this.graph.state(),r=this.input();return r.output(n,e),r.epsilon(n),n.epsilon(r),new t(this.graph,n)}},{key:"optional",value:function(e){var n=this.graph.state(),r=this.input();return r.output(n,e),r.epsilon(n),new t(this.graph,n)}},{key:"atLeast",value:function(e,n){for(var r=this.input(),i=0;i<n;++i){var o=this.graph.state();r.output(o,e),r=o}return new t(this.graph,r)}},{key:"upTo",value:function(e,n){for(var r=this.graph.state(),i=this.input(),o=0;o<n-1;++o){var a=this.graph.state();i.output(a,e),i.epsilon(r),i=a}return i.output(r,e),i.epsilon(r),new t(this.graph,r)}},{key:"range",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY,r=this;return e>0&&(r=r.atLeast(t,e)),r=n===Number.POSITIVE_INFINITY?r.many(t):r.upTo(t,n-e)}},{key:"any",value:function(){for(var e=this.graph.state(),n=this.input(),r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];for(var a=0,s=i;a<s.length;a++){var u=s[a];n.output(e,u)}return new t(this.graph,e)}}])&&eu(e.prototype,n),r&&eu(e,r),t}();function ru(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.create=function(e){return new t(e)}}(nu||(nu={}));var iu,ou=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._states=U.Pack.any(2),this.states=this._states.view(),this._relationships=U.Pack.any(0),this.relationships=this._relationships.view(),this._matchs=new U.NativeSet(new Set),this.start=new Zs(this),this.matchs=this._matchs.view()}var e,n,r;return e=t,(n=[{key:"addMatch",value:function(t,e){this._matchs.add(t),t.match=e}},{key:"deleteMatch",value:function(t){this._matchs.delete(t),t.match=void 0}},{key:"addState",value:function(t){if(t.graph!==this)throw new Error("Unable to add the given state to this graph as it was instantiated for another graph. #addState is a method that must be called at the right time, please do not use it if you do not know exactly what you are doing.");if(void 0===t.identifier){var e=this._states.size;return this._states.push(t),e}return t.identifier}},{key:"addRelationship",value:function(t){if(t.from.graph!==this)throw new Error("Unable to add the given relationship to this graph as it was instantiated for another graph. #addRelationship is a method that must be called at the right time, please do not use it if you do not know exactly what you are doing.");if(void 0===t.identifier){var e=this._relationships.size;return this._relationships.push(t),e}return t.identifier}},{key:"state",value:function(){return new Zs(this)}},{key:"builder",value:function(){return new nu(this)}}])&&ru(e.prototype,n),r&&ru(e,r),t}();function au(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=uu(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function su(t){return function(t){if(Array.isArray(t))return cu(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||uu(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uu(t,e){if(t){if("string"===typeof t)return cu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cu(t,e):void 0}}function cu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function fu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){t.MATCH=(new t).builder().match()}(ou||(ou={})),function(t){function e(e){switch(e){case t.START:return"START";case t.STATE:return"STATE";case t.EVENT:return"EVENT";case t.HEAD:return"HEAD";default:return}}t.START=0,t.STATE=1,t.EVENT=2,t.HEAD=3,t.ALL=[t.START,t.STATE,t.EVENT,t.HEAD],t.DEFAULT=t.START,t.toString=e,t.toDebugString=function(t){return"#"+t+" ("+(e(t)||"undefined")+")"}}(iu||(iu={}));var lu=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._parent=null,this._children=U.PackSet.any(4),this.children=this._children.view(),this.event=new ja,this.type=iu.DEFAULT,this.state=null}var e,n,r;return e=t,(n=[{key:"isLeaf",value:function(){return 0===this._children.size}},{key:"isNode",value:function(){return this._children.size>0}},{key:"isEvent",value:function(){return this.type===iu.EVENT}},{key:"isState",value:function(){return this.type===iu.STATE}},{key:"isStart",value:function(){return this.type===iu.START}},{key:"isHead",value:function(){return this.type===iu.HEAD}},{key:"asEvent",value:function(t){return this.type=iu.EVENT,this.event.copy(t),this.state=null,this}},{key:"asState",value:function(t){return this.type=iu.STATE,this.event.clear(),this.state=t,this}},{key:"asStart",value:function(){return this.type=iu.START,this.event.clear(),this.state=null,this}},{key:"asHead",value:function(){return this.type=iu.HEAD,this.event.clear(),this.state=null,this}},{key:"isUpward",value:function(t){for(var e=this._parent;e;){if(e===t)return!0;e=e.parent}return!1}},{key:"root",value:function(){for(var t=this;null!=t.parent;)t=t.parent;return t}},{key:"up",value:ye().mark((function t(){var e;return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this;case 1:if(null==e.parent){t.next=7;break}return e=e.parent,t.next=5,e;case 5:t.next=1;break;case 7:return t.abrupt("return",e);case 8:case"end":return t.stop()}}),t,this)}))},{key:"countMessages",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=0,n=Oa.ALL.length;e<n;++e)t[e]=0;for(var r=this;r;)r.type===iu.EVENT&&r.event.isMessage()&&(t[r.event.message.type]+=1),r=r.parent;return t}},{key:"batch",value:function(){for(var t=this;t;){if(t.type===iu.EVENT)return t.event.batch;t=t.parent}return 0}},{key:"fork",value:function(){var e=t.ALLOCATOR.allocate();return e.parent=this,e}},{key:"addChild",value:function(t){this._children.add(t),t.parent=this}},{key:"deleteChild",value:function(t){this._children.delete(t),t.parent=null}},{key:"delete",value:function(){var t=this._parent;for(this.parent=null;this._children.size>0;)this._children.first.parent=t}},{key:"clear",value:function(){for(this.parent=null;this._children.size>0;)this._children.first.parent=null}},{key:"toString",value:function(){var t=this.constructor.name;switch(this.type){case iu.START:return t+" START with "+this._children.size+" children";case iu.STATE:return t+" STATE #"+this.state.identifier+" with "+this._children.size+" children";case iu.EVENT:return t+" EVENT "+this.event.toString()+" with "+this._children.size+" children";case iu.HEAD:return t+" HEAD with "+this._children.size+" children";default:throw new Error("Unable to stringify tree node of type "+iu.toDebugString(this.type)+" as no procedure was defined for that.")}}},{key:"parent",get:function(){return this._parent},set:function(t){if(this._parent!==t){if(this._parent){var e=this._parent;this._parent=null,e.deleteChild(this)}this._parent=t,t&&t.addChild(this)}}}])&&fu(e.prototype,n),r&&fu(e,r),t}();function hu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}!function(t){function e(){return new t}t.create=e,t.ALLOCATOR=U.Allocator.fromFactory(e),t.trash=function(e){for(var n=su(e.children),r=n.pop();r;){var i,o=au(r.children);try{for(o.s();!(i=o.n()).done;){var a=i.value;n.push(a)}}catch(s){o.e(s)}finally{o.f()}t.ALLOCATOR.free(r),r=n.pop()}},t.cut=function(e){var n=e.parent;for(e.parent=null;n&&!n.isStart()&&0===n.children.size;){var r=n.parent;t.ALLOCATOR.free(n),n=r}for(var i=e;i&&i.children.size<2;){var o=1===i.children.size?i.children.first:null;t.ALLOCATOR.free(i),i=o}i&&n&&(i.parent=n)}}(lu||(lu={}));var pu=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.process=Fs.validateEpsilon(),this.head=lu.ALLOCATOR.allocate().asHead(),this.relationship=0}var e,n,r;return e=t,(n=[{key:"push",value:function(t){var e=this.head;return this.head=lu.ALLOCATOR.allocate().asHead(),e.asEvent(t),this.head.parent=e,this}},{key:"clear",value:function(){this.process=Fs.validateEpsilon(),this.relationship=0;var t=this.head;this.head=lu.ALLOCATOR.allocate().asHead(),lu.cut(t)}}])&&hu(e.prototype,n),r&&hu(e,r),t}();function yu(t){return(yu="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vu(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return du(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?du(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function du(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function bu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gu(t,e){return(gu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mu(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_u(t);if(e){var i=_u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Eu(this,n)}}function Eu(t,e){return!e||"object"!==yu(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _u(t){return(_u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){function e(){return new t}t.create=e,t.ALLOCATOR=U.Allocator.fromFactory(e)}(pu||(pu={}));var Tu,ku=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gu(t,e)}(o,t);var e,n,r,i=mu(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this))._graph=ou.MATCH,t._visited=new Map,t._pendingStack=U.Pack.any(16),t._nextPendingStack=U.Pack.any(16),t._matchs=U.Pack.any(16),t._failures=U.Pack.any(16),t._tree=new lu,t._current=void 0,t._index=0,t._batch=0,t}return e=o,(n=[{key:"validate",value:function(t){this.reset(),this._graph=t;var e=t.start,n=this._tree.fork().asState(e);this._visited.set(e.identifier,n);var r,i=vu(e.outputs);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=pu.ALLOCATOR.allocate();a.head.parent=n,a.process=o.validator(),this._pendingStack.push(a)}}catch(s){i.e(s)}finally{i.f()}}},{key:"isLeftBetterThanRight",value:function(t,e){var n=t.countMessages(),r=t.batch(),i=e.countMessages(),o=e.batch();if(r===o){for(var a=Oa.ALL.length,s=0;s<a;++s){var u=n[a-s-1],c=i[a-s-1];if(u!==c)return u<c}return!0}return r>o}},{key:"start",value:function(){for(var t=this._pendingStack,e=this._nextPendingStack;t.size>0;)this.continueProcess(this._pendingStack.pop());this._pendingStack=e,this._nextPendingStack=t,this._visited.clear(),this._matchs.size>0?this.handleGraphMatch():0===this._pendingStack.size?this.handleGraphError():this.dump()}},{key:"next",value:function(t){this.dumpFailures();var e=this._pendingStack,n=this._nextPendingStack;for(this._current=t;e.size>0;)this.continueProcess(this._pendingStack.pop());this._pendingStack=n,this._nextPendingStack=e,this._visited.clear(),this._matchs.size>0?this.handleGraphMatch():0===this._pendingStack.size?this.handleGraphError():this.dump()}},{key:"continueProcess",value:function(t){for(var e=t.process,n=this._current,r=n?e.next(n):e.next();!r.done;)switch(r.value.type){case cs.CURRENT:if(n){r=e.next(n);break}case cs.NEXT:return void this._nextPendingStack.push(t);case cs.EMIT:if(t.push(r.value.event),r.value.event.isMessage()&&r.value.event.message.isFailure())return void this._failures.push(t);r=e.next();break;case cs.MATCH:this.handleProcessMatch(t),r=e.next(void 0);break;case cs.END:throw new Error("Unable to continue a validation process because it's related KISS validator yielded an end signal. An end signal must only be returned as it will explicitely stop the occuring validation process.");default:throw new Error("Unable to handle kiss validator output of type "+cs.toDebugString(r.value.type)+" because no procedure was defined for that.")}if(r.value.isMatch())this.handleProcessMatch(t);else{if(!r.value.isEnd())throw new Error("Unable to continue a validation process because it's related KISS validator ended without returning a match nor an end signal.");this._failures.push(t)}}},{key:"success",value:function(){this.dumpFailures();var t=this._pendingStack;for(this._current=void 0;t.size>0;)this.terminateProcess(this._pendingStack.pop());this._matchs.size>0?(this.dumpFailures(),this.handleGraphMatch()):this.handleGraphError()}},{key:"dumpFailures",value:function(){for(var t=this._failures;t.size>0;)pu.ALLOCATOR.free(t.pop())}},{key:"handleGraphMatch",value:function(){for(var t=this._matchs.pop();this._matchs.size>0;){var e=this._matchs.pop();this.isLeftBetterThanRight(e.head,t.head)?(pu.ALLOCATOR.free(t),t=e):pu.ALLOCATOR.free(e)}this.dump(),this.output.success(),t.head.parent=null,pu.ALLOCATOR.free(t)}},{key:"handleGraphError",value:function(){var t=this._failures;if(t.size>0){for(var e=t.pop();t.size>0;){var n=t.pop();this.isLeftBetterThanRight(n.head,e.head)?(pu.ALLOCATOR.free(e),e=n):pu.ALLOCATOR.free(n)}this.dump(),this.output.success(),e.head.parent=null,pu.ALLOCATOR.free(e)}else this.dump(),this.output.success()}},{key:"dump",value:function(){for(var t=this._tree;1===t.children.size;){var e=t.children.first;if(e.isHead())return;e.isEvent()&&this.emit(e.event),e.delete(),lu.ALLOCATOR.free(e)}}},{key:"terminateProcess",value:function(t){for(var e=t.process,n=e.next();!n.done;)switch(n.value.type){case cs.CURRENT:n=e.next(void 0);break;case cs.NEXT:throw new Error("Unable to terminate a validation process because it's related KISS validator requested the next available event after the reception of the end of document.");case cs.EMIT:if(t.push(n.value.event),n.value.event.isMessage()&&n.value.event.message.isFailure())return void this._failures.push(t);n=e.next();break;case cs.MATCH:this.handleProcessMatch(t),n=e.next();break;case cs.END:throw new Error("Unable to terminate a validation process because it's related KISS validator yielded an end signal. An end signal must only be returned as it will explicitely stop the occuring validation process.");default:throw new Error("Unable to handle kiss validator output of type "+cs.toDebugString(n.value.type)+" because no procedure was defined for that.")}if(n.value.isMatch())this.handleProcessMatch(t);else{if(!n.value.isEnd())throw new Error("Unable to terminate a validation process because it's related KISS validator ended without returning a match nor an end signal.");this._failures.push(t)}}},{key:"failure",value:function(t){this.output.fail(t)}},{key:"handleProcessMatch",value:function(t){var e=this._graph.relationships.get(t.relationship).to;if(e.isMatch())this._matchs.push(t);else{var n=this._visited.get(e.identifier);if(n){if(!t.head.isUpward(n)){var r=n.parent,i=t.head.parent;t.head.parent=null,this.isLeftBetterThanRight(i,r)&&(n.parent=i,lu.cut(r))}pu.ALLOCATOR.free(t)}else{n=t.head.parent.fork().asState(e),this._visited.set(e.identifier,n);for(var o=1;o<e.outputs.size;++o){var a=e.outputs.get(o),s=pu.ALLOCATOR.allocate();s.head.parent=n,s.relationship=a.identifier,s.process=a.validator(),this._pendingStack.push(s)}var u=e.outputs.get(0);t.head.parent=n,t.relationship=u.identifier,t.process=u.validator(),this._pendingStack.push(t)}}}},{key:"emit",value:function(t){(t.isValidation()||t.isDocumentCompletion())&&(this._batch+=1),t.setIndex(this._index),t.setBatch(this._batch),this.output.next(t),this._index+=1}},{key:"reset",value:function(){this._matchs.clear(),this._visited.clear(),this._pendingStack.clear(),lu.trash(this._tree),this._current=void 0,this.off()}}])&&bu(e.prototype,n),r&&bu(e,r),o}(Yt);function Su(t){var e=new io,n=new ko,r=new ei;return e.subscribe(t),n.subscribe(e),r.subscribe(n),r.importations.on(pt.NEXT,t.import.bind(t)),r.importations.on(pt.FAILURE,t.fail.bind(t)),r}function Au(t){var e=new ko;return e.subscribe(t),e}function wu(t){var e=new io;return e.subscribe(t),e}!function(t){t.validate=function(t,e){return e.subscribe(t),e},t.kiss=function(){var t=1===arguments.length?arguments.length<=0?void 0:arguments[0]:arguments.length<=1?void 0:arguments[1],e=1===arguments.length||arguments.length<=0?void 0:arguments[0],n=new Ys(t);return null!=e&&n.subscribe(e),n},t.graph=function(){var t=1===arguments.length?arguments.length<=0?void 0:arguments[0]:arguments.length<=1?void 0:arguments[1],e=1===arguments.length||arguments.length<=0?void 0:arguments[0],n=new ku;return n.validate(t),null!=e&&n.subscribe(e),n}}(Tu||(Tu={}))},666:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(x){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof d?e:d,o=Object.create(i.prototype),a=new O(r||[]);return o._invoke=function(t,e,n){var r=l;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===y){if("throw"===i)throw o;return N()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=A(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var u=f(t,e,n);if("normal"===u.type){if(r=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(x){return{type:"throw",arg:x}}}t.wrap=c;var l="suspendedStart",h="suspendedYield",p="executing",y="completed",v={};function d(){}function b(){}function g(){}var m={};m[o]=function(){return this};var E=Object.getPrototypeOf,_=E&&E(E(R([])));_&&_!==n&&r.call(_,o)&&(m=_);var T=g.prototype=d.prototype=Object.create(m);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(i,o,a,s){var u=f(t[i],t,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"===typeof l&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,s)}))}s(u.arg)}var i;this._invoke=function(t,r){function o(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(o,o):o()}}function A(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=f(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function w(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function R(t){if(t){var n=t[o];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:N}}function N(){return{value:e,done:!0}}return b.prototype=T.constructor=g,g.constructor=b,b.displayName=u(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,s,"GeneratorFunction")),t.prototype=Object.create(T),t},t.awrap=function(t){return{__await:t}},k(S.prototype),S.prototype[a]=function(){return this},t.AsyncIterator=S,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new S(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(T),u(T,s,"Generator"),T[o]=function(){return this},T.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=R,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:R(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=e}catch(n){Function("r","regeneratorRuntime = r")(e)}},332:e=>{"use strict";e.exports=t}},n={};function r(t){if(n[t])return n[t].exports;var i=n[t]={exports:{}};return e[t](i,i.exports,r),i.exports}return r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(908)})()},t.exports=r(n("3Vbp"))}}]);